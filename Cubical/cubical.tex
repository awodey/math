%%
% Cubical models of type theory
% May 2014
% IHP
%%
\documentclass[11pt]{article}
\usepackage{amsmath}
\usepackage{amssymb,latexsym}
\usepackage{amsthm}
\usepackage{bm}
\input{prooftree}
\usepackage[all,cmtip]{xy}
\input{diagxy}
\CompileMatrices       
\usepackage{url}
%\usepackage{pdfpages}


% categories
\newcommand{\C}{\ensuremath{\mathbb{C}}}
\newcommand{\B}{\ensuremath{\mathbb{B}}}
\newcommand{\CC}{\ensuremath{\mathcal{C}}}
\newcommand{\BB}{\ensuremath{\mathcal{B}}}
%\newcommand{\EE}{\ensuremath{\mathcal{E}}}
\newcommand{\psh}[1]{\ensuremath{\mathsf{Set}^{#1^{\mathrm{op}}}}}
\newcommand{\Set}{\ensuremath{\mathsf{Set}}}
\newcommand{\Cat}{\ensuremath{\mathsf{Cat}}}
\newcommand{\covpsh}[1]{\ensuremath{\mathsf{Set}^{#1}}}
%\renewcommand{\to}{\ensuremath{\rightarrow}}
\newcommand{\pocorner}[1][dr]{\save*!/#1+1.2pc/#1:(1,-1)@^{|-}\restore}
\newcommand{\pbcorner}[1][dr]{\save*!/#1-1.2pc/#1:(-1,1)@^{|-}\restore}

% arrows
\newcommand{\hook}{\ensuremath{\hookrightarrow}}
\newcommand{\mono}{\ensuremath{\rightarrowtail}}
%\newcommand{\epi}{\ensuremath{\twoheadrightarrow}}


% cubical sets
\newcommand{\I}{\ensuremath{\mathrm{I}}}
\renewcommand{\H}{\ensuremath{\mathbb{H}}}
\newcommand{\HH}{\ensuremath{\mathcal{H}}}

% type theory
\newcommand{\G}{\ensuremath{\Gamma}}
\newcommand{\defeq}{=_{\mathrm{def}}}
\newcommand{\type}{\mathsf{type}}       
\newcommand{\types}[2]{#1 \vdash #2:\type}
\newcommand{\Gtypes}[1]{\types{\Gamma}{#1}}
\newcommand{\term}[2]{#1\,:\,#2}
\newcommand{\terms}[2]{#1 \vdash #2}
\newcommand{\Gterms}[1]{\terms{\Gamma}{#1}}
\newcommand{\ext}[2]{{#1\!\centerdot\! #2}}
\newcommand{\ty}{\ensuremath{\,:\,}}
\newcommand{\pair}[1]{\ensuremath{\langle #1\rangle}}
\newcommand{\exdot}{\ensuremath{\!\centerdot\!}}
\newcommand{\texdot}{\ensuremath{\centerdot}}

% Id types
\newcommand{\Id}{\mathsf{Id}}
\newcommand{\id}[1]{\Id_{#1}}
\newcommand{\refl}{\mathsf{refl}}
\newcommand{\idrec}{\mathsf{idrec}}
\newcommand{\jay}{\mathsf{j}}
\renewcommand{\i}{\mathsf{i}}

% Universe
\newcommand{\U}{\ensuremath{\mathcal{U}}}
\newcommand{\UU}{\ensuremath{\widetilde{\mathcal{U}}}}

% theorem styles
\newtheorem{theorem}{Theorem}
\newtheorem*{theorem*}{Theorem}
\newtheorem{proposition}[theorem]{Proposition} 
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary} 

\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark} 
\newtheorem*{remarks*}{Remarks}
\newtheorem{example}[theorem]{Example}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{Notes on cubical models of type theory}
\author{Steve Awodey}
\date{\today}

\maketitle
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent
Roughly following the paper of Bezem, Coquand, and Huber \cite{BCH} and reformulating things in functorial style.

\section{Some cube categories}

We consider three different cube categories, to be used as index categories for cubical sets:

\begin{enumerate}
\item $\mathbb{C}$ the (classical) cube category: the \emph{free monoidal category on an interval}.
\item $\mathbb{C}_s$ the symmetric cube category: the \emph{free symmetric monoidal category on an interval}.
\item $\mathbb{C}_c$ the cartesian cube category: the \emph{free finite product category on an interval}.
\end{enumerate}

\subsection{The classical cube category $\mathbb{C}$}

(Cf.\ Jardine \cite{Jardine2001,Jardine2002}.)
The \emph{objects} are the sets of binary $n$-tuples:
\[
I^n = \{ \langle d_1, ..., d_n\rangle\ \vert\ d_i = 0,1\}
\]
where 
\[
I = \{ 0, 1\}
\]
and we let $I^0 = \{*\}$.

The \emph{arrows} $$f : I^n \to I^m$$ are those functions generated by compositions of the following primitive ones:
\begin{itemize}
\item \emph{face maps} $\alpha^{d}_{i} : I^n \to I^{n+1}$, taking $\langle d_1, ..., d_n\rangle$ to $\langle d_1, ..., d_{(i)}, ..., d_n\rangle$, with a new digit $d = 0,1$ inserted as the $i^{\mathrm{th}}$ coordinate. There are $2(n+1)$ such maps.

\item \emph{degeneracies} $\beta_{i} : I^n \to I^{n-1}$, taking $\langle d_1, ..., d_n\rangle$ to $\langle d_1, ..., \hat{d_{i}}, ..., d_n\rangle$, omitting the $i^{\mathrm{th}}$ coordinate.  There are $n$ such maps.
\end{itemize}

Note that the order of the $d_i$'s does not change.  

\subsubsection*{Remarks}
\begin{enumerate}
\item It can be shown that every map factors as:
\[
\xymatrix{
 I^n \ar[rr]^{f} \ar@{->>}[rd]_{\beta} && I^m\\
& I^k \ar@{>->}[ru]_{\alpha}  &
}
\]
where $\alpha : I^k \rightarrowtail I^m$ is a composite of faces, and $\beta : I^n \epi I^k$ is a composite of degeneracies.
Using this, it can be shown that $\mathbb{C}$ is the free monoidal category on an \emph{interval}: an object $I$ equipped with maps:
\[
\xymatrix{
 1 {\ar@<-.5ex>[r]_{\bot} \ar@<.5ex>[r]^{\top}} & I \ar[r]^{!} & 1
}
\]
satisfying $!\circ\top = \mathrm{id_1} =\ !\circ\bot$, where $1$ is the monoidal unit.

\item The presheaf category $\mathsf{cSet} = \psh{\C}$ of \emph{cubical sets} has the same homotopy theory as the classical simplicial sets $\mathsf{sSet} = \psh{\Delta}$, in the sense that the two are Quillen equivalent.

\item The objects $I^n$ are \emph{not} the $n$-fold cartesian products of the interval $I$, either in the site $\C$ or as presheaves.  Rather, there is a monoidal product $\otimes$ on $\mathsf{cSet}$ extending that on $\C$, such that $I^m\otimes I^n \cong I^{m+n}$.  Similarly, the geometric realization functor to topological spaces 
$$R: \mathsf{cSet} \to \mathsf{Top}$$
does not in general preserve cartesian products, but instead takes tensor products in $\mathsf{cSet}$ to cartesian ones in $\mathsf{Top}$, $$R(X\otimes Y) \cong R(X)\times R(Y).$$  
\end{enumerate}

\subsection{The symmetric cube category $\mathbb{C}_s$}

(Cf.\ Grandis \cite{Grandis??}.) As before, the \emph{objects} are the sets of binary $n$-tuples:
\[
1 = I^0,\ I,\ ..., I^n
\]
%
The \emph{arrows} $$f : I^n \to I^m$$ are still functions generated by compositions of primitive ones, including the faces and degeneracies as before, but now also including the primitive:
\begin{itemize}
\item \emph{permutations} $\sigma_i : I^n \to I^{n}$, swapping $d_i$ and $d_{i+1}$.
\end{itemize}
%
For each $I^n$ there are $n-1$ such maps. Of course, for any permutation $\sigma\in S_n$ one can define a corresponding $\sigma : I^n \to I^{n}$ taking $\langle d_1, ..., d_n\rangle$ to $\langle d_{\sigma{(1)}}, ..., d_{\sigma{(n)}}\rangle$ as a suitable composite of~$\sigma_i$'s.  

\subsubsection*{Remarks}
\begin{enumerate}
\item It can be shown that now every map factors as:
\[
\xymatrix{
 I^n \ar[r]^{f} \ar@{->>}[d]_{\beta} & I^m\\
I^k \ar[r]^{\sim}_{\sigma} & I^k \ar@{>->}[u]_{\alpha}
}
\]
where $\alpha : I^k \rightarrowtail I^m$ is a (composite) face, $\sigma : I^k \tilde{\to} I^k$ is a (composite) permutation, and $\beta : I^n \epi I^k$ is a (composite) degeneracy.  Using this, it can be shown that $\mathbb{C}_s$ is the free \emph{symmetric} monoidal category on an interval.

\item The presheaf category $\mathsf{csSet} = \psh{\C_s}$ of \emph{symmetric cubical sets} again has the same homotopy theory as simplicial sets.

\item The objects $I^n$ are again  $n$-fold \emph{tensor} products of the interval $I$, but not  \emph{cartesian} products, either in the site $\C_s$ or in  $\mathsf{csSet}$.   And again, the geometric realization functor from $\mathsf{csSet}$ to topological spaces does not preserve cartesian products, but instead takes tensor products to cartesian ones. Relatedly, there is a functor $\mathsf{Hom}(X, - )$, right adjoint to the tensor $X\otimes (-)$, which is not an exponential.
\end{enumerate}

\subsubsection*{Covariant presentation}

(Cf.\ Bezem, Coquand, and Huber \cite{BCH}, Pitts \cite{Pitts}.) There is a dual presentation of the symmetric site $\C_s$.  Let the category $\mathcal{C}$ have as \emph{objects} the finite sets $$[n]= \{1, ..., n\}$$ and write 
\[
[n]^+\ =\  [n] \cup \{\top, \bot\}\ =\ \{\top, 1, ..., n, \bot\}.
\]
The \emph{arrows}
\[
f : [n] \to [m]
\]
in $\mathcal{C}$ are all functions  $f : [n] \to [m]^+$ satifying the following \emph{partial injectivity condition}:
\[
f(i)= f(j)\ \implies \big(i = j\ \text{\emph{or}}\ f(i) = \top = f(j)\ \text{\emph{or}}\  f(i) = \bot = f(j) \big)
\]
In other words, $f$ is injective on the preimage of  $[m] \subseteq [m]^+$,
\[
\xymatrix{
\cdot \ar@{_{(}->}[d] \ar@{>->}[rr] \pbcorner && [m] \ar@{_{(}->}[d] \\
[n] \ar[rr]_{f} && [m]^+
}
\]
Identity and composition are just as in the Kleisli-category of the monad $X\mapsto X^+$.  Specifically, $\mathrm{id}: [n] \to [n]$ is the inclusion $[n] \hook [n]^+$, and $g\circ f : [n] \to [m] \to [k]$ is $\overline{g}\circ f$, where $$\overline{g}:[m]^+\to[k]^+$$ is the unique $(\top, \bot)$-preserving extension of $g$, as indicated in the following.
\[
\xymatrix{
[n] \ar[rd]^{f} & [m] \ar@{_{(}->}[d] \ar[rd]^{g} & [k] \ar@{_{(}->}[d] \\
		& [m]^+\ar[r]_{\overline{g}} & [k]^+
}
\]

One can show easily that this category $\mathcal{C}$ (called the category of ``names and substitutions" in \cite{BCH}) is dual to the category of symmetric cubes, $$\mathcal{C} \cong \C^{\mathrm{op}}_s$$ and so 
we have an alternate presentation of the symmetric cubical sets as \emph{covariant} functors,
\[
\mathsf{scSet} = \psh{\C_s} \cong \covpsh{\mathcal{C}}.
\]


\subsection{The cartesian cube category $\mathbb{C}_c$}

As a modification of the foregoing, we consider a notion of \emph{cartesian cubical sets}.  
The \emph{objects} of  $\C_c$ are again the sets of binary $n$-tuples:
\[
1 = I^0,\ I,\ ..., I^n
\]
%
The \emph{arrows} of $\C_c$, $$f : I^n \to I^m$$ are still functions generated by compositions of primitive ones, including the faces,  degeneracies, and permutations, but now also including the primitive
\begin{itemize}
\item \emph{diagonal maps} $\delta_i : I^n \to I^{n+1}$, which double the $i^{th}$ coordinate: $$\langle d_1, ..., d_n\rangle\ \mapsto\ \langle d_1, ..., d_i, d_i,..., d_n\rangle.$$
\end{itemize}
%

\begin{proposition}
$\C_c$ is the free category with finite products and an interval,
\[
\xymatrix{
 1 {\ar@<-.5ex>[r]_{\bot} \ar@<.5ex>[r]^{\top}} & I \ar[r]^{!} & 1.
}
\]
\end{proposition}

\begin{proof}
The free category with finite products and an interval is the classifying category for the  algebraic theory consisting of the two constants $\{\top, \bot\}$, which can be described as follows (see \cite{AB}):
\begin{description}
\item objects: finite lists $[x_1, ..., x_n]$ of distinct variables,
\item arrows: $f : [x_1, ..., x_n] \to [x_1, ..., x_m]$ are (equivalence classes of) $m$-tuples $$f = \langle f_1, ..., f_m\rangle$$ of terms in context,
$$x_1, ..., x_n \vdash f_i\,.$$
\end{description}
But in this simple theory, the only such terms are the variables $x_1, ..., x_n$ themselves and the constants $\{\top, \bot\}$, and the equivalence relation is trivial, since there are no equations.  Thus an arrow is just an $m$-tuple of arbitrary elements taken from the set $\{x_1, ..., x_n, \top, \bot\}$.  The identity arrow is the list of variables 
$\langle x_1, ..., x_n \rangle$, and composition is by the usual substitution of terms for variables.  But this is evidently just another description of the category $\C_c$.

In more detail, each of the primitive kinds of maps $\alpha^d_i, \beta_i, \sigma_i, \delta_i$ can clearly be presented in this form, e.g.\ $\alpha^d_i = \langle x_1, ..., d'_{(i)}, ..., x_n\rangle$, where $d' = \top,\bot$, respectively, when $d = 1,0$.  Conversely, an $m$-tuple $(e_1,..., e_m)$ of elements from the set $\{x_1, ..., x_n, \top, \bot\}$ determines a map $\epsilon : I^n \to I^m$ in $\C_c$ as follows: beginning with a binary $n$-tuple $(d_1, ... d_n)$, first apply degeneracies $\beta_i$ corresponding to each $x_i$ not occurring in $(e_1,..., e_m)$; next apply a permutation $\sigma$ that reorders the  terms $d_j$ in accordance with the order of the non-constant terms $e_j$ appearing in $(e_1,..., e_m)$; apply suitable $\delta$'s to duplicate coordinates appearing more than once; and finally use $\alpha$'s to insert the required constants.
\end{proof}

\begin{corollary}
The cartesian cube category $\C_c$ is equivalent to a \emph{non}-full subcategory of $\mathsf{Cat}$ (respectively $\mathsf{Pos}$) on the objects $I^n = I \times ...\times I$, where $I = (0\leq 1)$ is the 2-element poset.
\end{corollary}

\begin{proof}
Each of the maps $\alpha^d_i, \beta_i, \sigma_i, \delta_i$ is monotone, and these are all distinct as monotone maps.
To see that this is not full, observe that every monotone $f : I^n \to I^m$ is an $m$-tuple of monotone $f_i : I^n \to I$, each of which coming from $\C_c$ is either a projection or a constant.  But the map $f : I^2 \to I$ with $f(1,1) = 1$, and $f(d,d') = 0$ otherwise, is neither.
\end{proof}
%
Note that the non-monotone ``negation" map $n : I \to I$, with $n(0) = 1$ and $n(1) = 0$, is also not in $\C_c$.


\subsubsection*{Covariant presentation}

As a classifying category for an algebraic theory, the category $\C_c$ of cartesian cubes also has a covariant presentation by Lawvere duality, namely as the opposite of the full subcategory of finitely-generated, free algebras $\mathsf{Alg}_{\mathrm{fg}}$.  In this case, the algebras are simply \emph{bipointed sets} $(A, a_0, a_1)$, and the free ones are the \emph{strictly} bipointed sets $a_0\neq a_1$.  Thus $\mathsf{Alg}_{\mathrm{fg}}$ consists of the finite, strictly bipointed sets and all bipointed maps between them.  Specifically, let the objects of $\mathbb{B}$ be the sets $[n] = \{1, ..., n\}$, and the arrows,
\[
f : [m] \to [n]\,,
\]
be arbitrary, $\{\top, \bot\}$-preserving maps $[m]^+ \to [n]^+$, where as before $[n]^+ = [n]\cup\{\top, \bot\}$.  Then clearly $\B = \mathsf{Alg}_{\mathrm{fg}}$, and we know by Lawvere duality that $$\C_c \cong \B^{\mathrm{op}},$$ as can be read off from the foregoing descrition of the arrows in $\C_c$ as ``$m$-tuples of arbitrary elements taken from the set $\{x_1, ..., x_n, \top, \bot\}$".

As a full subcategory of free algebras, the category $\B$ can also be described as the Kleisli category of the monad $[n] \mapsto [n]^+$.   Thus we arrive at the covariant description $\CC$ of the symmetric cubes, but without the partial injectivitity condition, which is violated by (the duals of) the diagonal maps.

\section{Hypercubical sets}

\begin{definition}
We may refer to the objects of the cartesian cube category $\C_c $ as \emph{hypercubes} and write $\H = \C_c$ for the \emph{category of hypercubes}.  The objects may be taken to be finite sets of the form $$[n] = \{x_1, ..., x_n\},$$ regarded as coordinate axes, and the arrows,
\[
f : [n] \to [m]\,,
\]
are then taken to be $m$-tuples of elements drawn from the set $$[n]^+ = \{0, x_1, ..., x_n, 1\},$$ regarded as formal terms representing composites of faces, degeneracies, permutations, and diagonals (alternately, the arrows are arbitrary bipointed maps $[m]^+\to [n]^+$).

The category $\HH$ of \emph{hypercubical sets} is  the category of presheaves on $\H$,
\[
\HH\ =\ \psh{\H}.
\]
It is generated by the representable presheaves $y([n])$, which will be written
$$\I^n\ =\ y([n])$$ 
and called the \emph{standard $n$-cubes}.  In particular, the standard $1$-cube is $\I = y([1])$, and the standard $0$-cube is $\I^0 = y([0])=1$.  For any hypercubical set $X: \H^\mathrm{op} \to \Set$, we shall write $X_n = X([n])$ and call this the \emph{set of $n$-cubes in $X$}.  For these, we have the usual Yoneda correspondence:
\[
(c \in X_n ) \ \cong\ (c : \I^n \to X).
\]
In particular $\I^n_m = \H([m],[n])$ is the set of $m$-cubes in the standard $n$-cube.
\end{definition}

\begin{proposition}
We now have $\I^n \times \I^m \cong \I^{n+m}$, in virtue of the preservation of products by the Yoneda embedding.
\end{proposition}


\begin{proposition}
The category $\HH$ of hypercubical sets is the classifying topos for bipointed objects.
\end{proposition}

\begin{proposition}
The geometric realization functor to topological spaces 
$$R: \HH \to \mathsf{Top}$$
preserves cartesian products, $R(X\times Y) \cong R(X)\times R(Y)$.
\end{proposition}

\begin{proposition}
Since $\H \hook  \Cat$ is a subcategory, the \emph{nerve} functor $$N : \Cat \to \HH$$ can be defined as usual by:
\[
N(\C)_n = \Cat(I^n, \C).
\]
However, we do not expect the nerve to be full and faithful.
\end{proposition}

\begin{proposition}
For any hypercubical set $X$, the exponential $X^\I$ can be calculated as:
\[
X^\I(n) \cong X(n+1).
\]
\end{proposition}

\begin{proof}
\[
\begin{split}
X^\I(n) \cong \hom(y[n], X^\I) \cong \hom(\I^n, X^\I)\ \cong\ \hom(\I^n\times \I, X)\\
\cong\ \hom(\I^{n+1}, X)\cong\ \hom(y[n+1], X)\ \cong\ X(n+1).
\end{split}
\]
\end{proof}

\begin{proposition}
\quad $\I^\I\ \cong\ \I+1$.
\end{proposition}


\begin{proposition}
The functor $X \mapsto X^\I$ has a \emph{right} adjoint.
\end{proposition}


\subsubsection*{Questions}
\begin{enumerate}
\item According to Grothedieck \cite{PS}, the category $\H$ is a test category, and so the category $\HH = \psh{\H}$ has the same homotopy theory as simplicial sets.  Prove this.

\item Want to know what a ``hypercubical $\omega$-groupoid" (i.e.\ a fibrant object) should be.  Are the usual box-filling conditions sufficient to define this? Is there another characterization involving the new diagonal maps?

\item The hypercubical sets $\HH$ is perhaps a good setting in which to compare the globular, simplicial, and type-theoretic notions of $\omega$-groupoid.

\item What is a hypercubical $(\infty, 1)$-category (in analogy to the simplicial notion of quasicategory)?  Does the type theory give rise to one?

\end{enumerate}


%\subsubsection*{Remarks}
%\begin{enumerate}
%\item It can be shown that now every map factors as:
%\[
%\xymatrix{
% I^n \ar[r]^{f} \ar[d]_{\beta} & I^m\\
%I^k \ar[r]_{\sigma} & I^k \ar[u]_{\alpha}
%}
%\]
%where $\alpha : I^k \to I^m$ is a (composite) face, $\sigma : I^k \to I^k$ is a (composite) permutation, and $\beta : I^n \to I^k$ is a (composite) degeneracy.  Using this, it can be shown that $\mathbb{C}_s$ is the free \emph{symmetric} monoidal category on an interval.
%
%\item The presheaf category $\mathsf{csSet} = \psh{\C_s}$ of \emph{symmetric cubical sets} again has the same homotopy theory as simplicial sets.
%
%\item The objects $I^n$ are again the $n$-fold \emph{tensor} products of the interval $I$, but not the \emph{cartesian} products, and again the geometric realization functor to topological spaces does not preserve cartesian products, but instead takes tensor products to cartesian ones. Relatedly, there is a functor $\mathsf{Hom}(X, - )$, right adjoint to the tensor $X\otimes (-)$, which is not an exponential.
%\end{enumerate}
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{thebibliography}{300}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bibitem{AW}
S.~Awodey and M.A.~Warren. Homotopy theoretic models of identity types. \emph{Math. Proc. Camb. Phil. Soc.}, 146, 45--55, 2009.

\bibitem{GvdB}
B.~van den Berg and R.~Garner. Topological and Simplicial Models of Identity Types. \emph{ACM Transactions on Computational Logic}, 13:1, 2012.

\bibitem{CwF} 
P.~Dybjer. ``Internal Type Theory." \emph{LNCS} 1158, 120--134, 1996.

\bibitem{GK}  
N.~Gambino and J.~Kock, ``Polynomial functors and polynomial monads"
\emph{Math. Proc. Cambridge Phil. Soc.} 154, 153--192, 2013.

\bibitem{Hofmann} 

\bibitem{HoTTbook} 
\emph{Homotopy Type Theory: Univalent Foundations of Mathematics}, The Univalent Foundations Program, Institute for Advanced Study, 2013. {\tt http://homotopytypetheory.org/book}

\bibitem{KLV}  
C.~Kapulkin, P.~LeFanu Lumsdaine and V.~Voevodsky, The Simplicial Model of Univalent Foundations. \emph{In preparation}, 2013.

%
\end{thebibliography}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
