
%%
% Model structure on the cartesian cubes
% Begun March 2018
%
% New start as qmspaper in 5.2022
%
%\documentclass[10pt]{amsart}
\documentclass[12pt]{article}

%\usepackage{ebgaramond}
%\usepackage{euscript}

\usepackage{amsmath}
\usepackage{amssymb,latexsym}
\usepackage{amsthm}
\usepackage{bm}
\usepackage{bbm,stmaryrd}% for bb2
\usepackage[all,cmtip]{xy}
\input{diagxy}
\CompileMatrices       
\usepackage{url}
%\usepackage{fullpage}
\usepackage[colorlinks=true,linkcolor=blue,anchorcolor=blue,citecolor=blue,
     		filecolor=blue,urlcolor=blue]{hyperref}

%editorial
\newcommand{\ednote}[1]{[\textit{\color{red}{#1}}]} % editorial note
\newcommand{\opcit}{\emph{op.cit.}}
\newcommand{\ie}{\emph{i.e.}}
\newcommand{\eg}{\emph{e.g.}}
\newcommand{\ibid}{\emph{ibid.}}
\newcommand{\vis}{\emph{vis.}}
\newcommand{\cf}{\emph{cf.}}


% categories
\newcommand{\A}{\ensuremath{\mathbb{A}}}
\newcommand{\bbtwo}{\ensuremath{\mathbbm{2}}}
\newcommand{\C}{\ensuremath{\boxempty}}
\newcommand{\N}{\ensuremath{\mathbb{N}}}
\newcommand{\D}{\ensuremath{\mathbb{D}}}
\newcommand{\B}{\ensuremath{\mathbb{B}}}
\newcommand{\bbC}{\ensuremath{\mathbb{C}}}
\newcommand{\T}{\ensuremath{\mathbb{T}}}
\newcommand{\CC}{\ensuremath{\mathcal{C}}}
\newcommand{\WW}{\ensuremath{\mathcal{W}}}
\newcommand{\FF}{\ensuremath{\mathcal{F}}}
\newcommand{\BB}{\ensuremath{\mathcal{B}}}
\newcommand{\EE}{\ensuremath{\mathcal{E}}}
\newcommand{\psh}[1]{\ensuremath{\mathsf{Set}^{#1^{\mathrm{op}}}}}
\newcommand{\Set}{\ensuremath{\mathsf{Set}}}
\newcommand{\Cat}{\ensuremath{\mathsf{Cat}}}
\newcommand{\covpsh}[1]{\ensuremath{\mathsf{Set}^{#1}}}
\newcommand{\cSet}{\ensuremath{\mathsf{cSet}}}
%\newcommand{\pbcornertransp}[1][dr]{\save*!/#1+1000pc/#1:(5000,5000)@^{|-}\restore}
\newcommand{\y}{\ensuremath{\mathsf{y}}} % Yoneda embedding
\newcommand{\yon}{\ensuremath{\mathsf{y}}} % Yoneda embedding
\newcommand{\plusalg}[1]{\ensuremath{^+\!\mathsf{Alg}{(#1)}}}
\newcommand{\plusalgx}{\ensuremath{^+\!\mathsf{Alg}}}
\newcommand{\op}[1]{\ensuremath{{#1}^{\mathrm{op}}}}
\newcommand{\eval}{\ensuremath{\mathsf{eval}}}% evaluation
\newcommand{\proj}{\ensuremath{\mathsf{p}}}% projection
%\newcommand{\proj1}{\ensuremath{\mathsf{p}_1}}% 1st projection
%\newcommand{\proj2}{\ensuremath{\mathsf{p}_2}}% 2nd projection

% arrows
\newcommand{\hook}{\ensuremath{\hookrightarrow}}
\newcommand{\mono}{\ensuremath{\rightarrowtail}}
\newcommand{\ra}{\ensuremath{\rightarrow}}
\newcommand{\cof}{\ensuremath{\rightarrowtail}}
\newcommand{\fib}{\ensuremath{\twoheadrightarrow}}
\renewcommand{\to}{\ensuremath{\rightarrow}}
\newcommand{\too}{\ensuremath{\longrightarrow}}
\newcommand{\onto}{\ensuremath{\twoheadrightarrow}}
\newcommand{\pbh}[2]{#1\!\Rightarrow\!#2}
\newcommand{\gph}[1]{\ensuremath{\langle #1 \rangle}}

% functors
\newcommand{\Hom}{\ensuremath{\mathrm{Hom}}}
\renewcommand{\hom}{\ensuremath{\mathrm{Hom}}}
\newcommand{\Sub}[1]{\ensuremath{\mathsf{Sub}{#1}}}


% cubical sets
\newcommand{\boxcat}{\ensuremath{\boxempty}}
\newcommand{\I}{\ensuremath{\mathrm{I}}}
\newcommand{\II}{\ensuremath{\mathbb{I}}}
\renewcommand{\H}{\ensuremath{\Box}}
\newcommand{\HH}{\ensuremath{\cSet}}
\newcommand{\del}{\ensuremath{\partial}}

% type theory
\newcommand{\G}{\ensuremath{\Gamma}}
\newcommand{\defeq}{=_{\mathrm{def}}}
\newcommand{\type}{\mathsf{type}}       
\newcommand{\types}[2]{#1 \vdash #2:\type}
\newcommand{\Gtypes}[1]{\types{\Gamma}{#1}}
\newcommand{\term}[2]{#1\,:\,#2}
\newcommand{\terms}[2]{#1 \vdash #2}
\newcommand{\Gterms}[1]{\terms{\Gamma}{#1}}
\newcommand{\ext}[2]{{#1\!\centerdot\! #2}}
\newcommand{\ty}{\ensuremath{\,:\,}}
\newcommand{\pair}[1]{\ensuremath{\langle #1\rangle}}
\newcommand{\exdot}{\ensuremath{\!\centerdot\!}}
\newcommand{\texdot}{\ensuremath{\centerdot}}

% Id types
\newcommand{\Id}{\mathsf{Id}}
\newcommand{\id}[1]{\Id_{#1}}
\newcommand{\refl}{\mathsf{refl}}
\newcommand{\idrec}{\mathsf{idrec}}
\newcommand{\jay}{\mathsf{j}}
\renewcommand{\i}{\mathsf{i}}

% Universe
\newcommand{\U}{\ensuremath{\mathcal{U}}}
\newcommand{\UU}{\ensuremath{\,\dot{\mathcal{U}}}}

\newcommand{\V}{\ensuremath{\mathcal{V}}}
\newcommand{\VV}{\ensuremath{\dot{\mathcal{V}}}}

\newcommand{\SSet}{\ensuremath{\,\dot{\Set}}}

\newcommand{\Fib}{\ensuremath{\mathsf{Fib}}}
\newcommand{\FFib}{\ensuremath{\dot{\mathsf{Fib}}}}
\newcommand{\TFib}{\ensuremath{\mathsf{TFib}}}
\newcommand{\TTFib}{\ensuremath{\dot{\mathsf{TFib}}}}

\newcommand{\elem}[1]{\textstyle\int\!{#1}}



% theorem styles
\newtheorem{theorem}{Theorem}
\newtheorem*{theorem*}{Theorem}
\newtheorem{proposition}[theorem]{Proposition} 
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary} 

\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark} 
\newtheorem*{remarks*}{Remarks}
\newtheorem{example}[theorem]{Example}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}

% commutative diagrams
\usepackage{tikz}
\usepackage{pdfpages}
\usepackage{tikz-cd}
\newcommand{\pbmark}{\ar[dr, phantom, "\lrcorner" very near start, shift right=.5ex]}	% pullback mark
\newcommand{\pbbmark}{\ar[drr, phantom, "\lrcorner" very near start, shift right=.5ex]}	% pullback mark

% xypic
\newcommand{\pocorner}[1][dr]{\save*!/#1+1.2pc/#1:(1,-1)@^{|-}\restore}
\newcommand{\pbcorner}[1][dr]{\save*!/#1-1.2pc/#1:(-1,1)@^{|-}\restore}

% tikz
%\newcommand{\pbcorner}{\arrow[dr,phantom,"\lrcorner" very near start]} % changed to pbmark
\newcommand{\ppbcorner}{\arrow[drr,phantom,"\lrcorner" very near start]}
%\newcommand{\pocorner}{\arrow[dr,phantom,"\ulcorner" very near end]} % changed to pomark
\newcommand{\ppocorner}{\arrow[dr,phantom,"\ulcorner" very near end]}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{Cartesian cubical model categories}
\author{Steve Awodey}
\maketitle

\begin{abstract}
Add an abstract.
\end{abstract}

\setcounter{tocdepth}{1}
\tableofcontents

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Introduction}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

novelties: univalence, universes, classifying types, uniformity, constructive, ...

%Lawvere, Grothendieck, Kan, Serre, 
%
%VV, Coquand, A2016, Sattler, O-P, HoTT2019, 
%
%Filling and composition, varieties of cubes, options for cofibrations, endpoints vs. generic point, related work.
%
% cite LOPS universe
% cite Gambino-Sattler
%
%AWFS and structured fibrations, classifying types, universe, tiny interval.
%
%Constructive except for SOA, fibrant replacement w/o quotients, pathspace factorization vs. Id types.
%
%Sec. 1-2 of cubical.tex.
%
% pathspace is dimension shift, so fibrant if the base is fibrant.
% higher cells are paths between lower cells - agrees with HoTT reading of Id-types
% also gives a good notion of higher groupoid
% 
% most previous work intended for models of HoTT
% my statement from HoTT 2019 talk that a model of HoTT is a QMC (of a certain kind)
% reverse the construction of a QMC from a model of HoTT ("completeness")
% Coquand et al. developed cubical models (and cubical TTs)
% Sattler first showed the connection between fibrant U and a QMS
% Harper et al. related ideas, from a very different perspective
% cubical models: BCH, CCHM, unpublished note on Cartesian,
% Grothendieck, Lawvere, Joyal, my CMU lectures, 
% Paris discussions, Pitts, my paper on cubical AWFS, 
% Stockholm lectures, Newton, Oslo, IHES,  
% G&S, G&H, 
% ACCRS, AAFS, AFH,

%%
%relation to other work 
%in homotopy: Kan, Serre, Grothendieck, Jardine, ...
%in type theory: related to ABC the way that GS and Sat are related to CCHM and OP.
%
%constructivity could be shown by a formalization in type theory,
%such a formalization is done for a closely related case in ABC, 
%with the difference that that work is not aimed at building a QMC, but rather a model of HoTT.
%Also, the structure of definitions, theorems, etc. is not parallel as would be a formalization, 
%so it cannot be said to establish correctness or constructivity of the present work. 
%



%Contributions: 
%- full diagrammatic proofs of the entire qms, not using TT.
%- diagrammatic treatment of unbiased fibrations
%- filling rather than composition
%- elementary diagrammatic proof of Frobenius
%- elementary diagrammatic proofs of equivalence extension property, FEP (w/o connections)
%- entirely constructive
%- axiomatic cofibrations
%- 
%
%
%Part One section 1-4 is essentially routine, concluding in a conditional result that assumes a technical lemma (probably
%
%Delete
%
%well known to experts) that we have
%
%Dubbed
%
%the fibration extension property. 
%Part 2, sections 5-8, is essentially a 60pp. proof of this lemma. It’s entirely likely that one could give a more direct proof (especially using more powerful methods), dispatching the entire second part of the paper, and reducing the proof of the model structure to the routine definitions and constructions in part 1 (together with whatever is needed for the fibration extension property). 
%
%Even in that event, it is the author’s belief that the results of
%
%Part 2
%
%remain worthwhile: the purpose of
%
%These
%
%lectures is not (merely) to construct a Quillen model structure, but to investigate the relationship between such a structure and the (homotopical) semantics of type theory. Part
%
%2 is
%
%essentially
%
%Delete
%
%of an implicit construction of a model of (homotopy) type theory: frobenius, eep, etc. Even given a qms by magic at the
%
%End
%
%of
%
%Part 1
%
%, this is work that would still need to be done if one wanted to build such a model in it (although some steps would undoubtedly be easier - see eg the remarks about deriving the fep from the eep at …).  
%
%Even
%
%then, the current construction
%
%Would still be of
%
%still of interest
%
%For
%
%showing, as it does, which type theoretic structures and facts depend upon, and imply, which aspects of the
%
%model structure
%
%Indeed, we learn that one can get quite far in such a model construction without assuming a type-theoretic universe, without assuming univalence, without assuming that
%
%the universe
%
%is fibrant,
%
%etc.
%
%Conversely, our results suggest (but do not formally imply) that the existence of a univalent universe in a
%
%homotopical semantics 
%
%consisting of fibrant objects
%
%In a Quillen model structure
%
%is not just necessary but sufficient for the model structure: in a certain sense made precise by the present investigation, a model of HoTT
%
%Delete
%
%is logically and mathematically equivalent to a qmc structure of a certain kind. 
%
%Namely, one that presents an oo-topos.
%
%
%
%- application to other varieties of cSet 
%- constructive vs classical

%- $\U$ only needed for FEP? If so, swap $\U$ with EEP.
%
%- relate EEP, FEP, and alignment to Shulman's 2', 3', 4'.
%
%- reversing the work on modelling HoTT in a QMC, using ideas learned from it.
%
%- not necessary to actually build the model - but we could.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Cartesian cubical sets}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

There are now many treatments of cubical sets in the literature, including \cite{Grandis, Grandis, Jardine, Jardine, Bezem, OrtonPitts, Coquand, Cisinski}.  Our construction is intended to work in \emph{all} of these, insofar as the axioms in Definition \ref{axioms} below are satisfied.   
For the sake of concreteness, however, we shall consider what may be called the \emph{cartesian} cube category $\C$, defined as the free finite product category on an interval $\delta_0, \delta_1 : 1\rightrightarrows \I$.
%As a Lawvere algebraic theory with two constant symbols $\T = \{0, 1\}$, the category $\square$ is dual to the full subcategory of finitely-generated, free $\T$-algebras $\mathsf{Alg}(\T)_{\mathrm{fg}}$.  In this case, the $\T$-algebras are simply \emph{bipointed sets} $(A, a_0, a_1)$, and the free ones are the \emph{strictly} bipointed sets $a_0\neq a_1$.  Thus $\mathsf{Alg}(\T)_{\mathrm{fg}}$ consists of the finite, strictly bipointed sets and all bipointed maps between them.  We will use the following presentation.

\begin{definition}
The objects of the cartesian cube category $\C$, called $n$-cubes, are finite sets of the form $$[n] = \{0, x_1, ..., x_n, 1\}\,,$$  where $x_1, ..., x_n,$ are formal \emph{generators}.
The arrows,
\[
f : [n] \ra [m]\,,
\]
may be taken to be $m$-tuples of elements drawn from the set $\{0, x_1, ..., x_n, 1\},$ regarded as formal terms representing composites of faces, degeneracies, permutations, and diagonals.  Equivalently, the arrows $[n] \ra [m]$ are arbitrary bipointed maps $[m]\ra [n]$.
\end{definition}
See \cite{parker:thesis} for further details.

\begin{definition}\label{def:cSet}
The category \cSet\ of \emph{cubical sets} is the category of presheaves on the cartesian cube category $\C$,
\[
\mathsf{cSet}\ =\ \psh{\C}.
\]
It is of course generated by the representable presheaves $\y{[n]}$, to be written $$\I^n = \y{[n]}$$ and called the \emph{geometric $n$-cubes}.   
\end{definition}

Note that the representables $\I^n$ are closed under finite products, $\I^n \times \I^m = \I^{n+m}$. We of course write $\I$ for $\I^1$ and $1$ for $\I^0$.  We will need the following basic fact about the cubes $\I^n$ in $\cSet$.

\begin{proposition}\label{prop:Itiny}
For each $n$, the $n$-cube $\I^n$ is \emph{tiny}, in the sense that the exponential (or ``internal $\hom$'') functor $(-)^{\I^n} : \cSet\too\cSet$ has a right adjoint.
\end{proposition}
\noindent (See \cite{Lawvere} for more on such ``amazing right adjoints''.)

\begin{proof}
It clearly suffices to prove the claim for $n=1$.   For any cubical set $X$, the exponential $X^\I$ is a ``shift by one dimension'', 
\[
\begin{split}
X^\I(n) \cong \hom(\I^n, X^\I)\ \cong\  \hom(\I^{n+1}, X)\cong\ X(n+1).
\end{split}
\]
Thus $X^\I$ is given by precomposition with the ``successor'' functor $\C\to\C$ with $[n] \mapsto [n+1]$. Precomposition always has a right adjoint, which in this case we write as $$X^\I\dashv X_\I $$ and call the $\I$-\emph{root}.  We can calculate the values of the $\I$-root to be,
\begin{align*}
X_\I(n) &\cong \hom(\I^n, X_\I) \\
&\cong \hom((\I^n)^\I, X) \\
&\cong \hom((\I^\I)^n, X) \\
&\cong \hom((\I+1)^n, X) \\
&\cong\textstyle \hom\big(\sum_{k=0}^{n} \binom{n}{k}\I^{k}, X\big) \\
&\cong \textstyle \prod_{k=0}^{n} X(k)^{\binom{n}{k}} ,
\end{align*}
using the fact that $\I^\I \cong (\I+1)$, much as in \cite{Fiore}.
\end{proof}

The exponential object  $X^\I$ will be called the \emph{pathobject} of $X$, and plays a special role. As we have just seen, it classifies ``paths'' in $X$, i.e. maps $p:\I \to X$, corresponding to $1$-cubes $p\in X_1$ between the endpoints ($0$-cubes) $p_0, p_1\in X_0$. More generally, higher cubes $c\in X_{n+1}$ correspond to maps $c : \I^{n+1}\cong \I^n\times \I \to X$, which can be regarded as paths between the $n$-cubes $c_0, c_1 : \I^n \to X$, respectively $c_0, c_1 \in X_n$.  

We conclude this section with two facts that will be useful later on concerning the base change functors, 
\[
f_!\dashv f^* \dashv f_* : \cSet/_X \too \cSet/_Y,
\]
associated to a map $f : X\to Y$  in $\cSet$.

\begin{lemma}\label{lemma:tinyslicedI}
The pulled-back interval $\I^*\I = \I\times\I\to \I$ in $\cSet/_\I$ is also tiny.
\end{lemma}
\begin{proof}
Since the interval $\I = \y[1]$ is representable, the slice category $\cSet/_\I$ is also a category of presheaves, namely over the sliced cube category $\C/_{[1]}$\,,
\[
\cSet/_\I \ =\ {\psh{\C}}\!/_{\y[1]} \ \cong\ \psh{ (\C/_{[1]}) }\, =\ \widehat{\C/_{[1]}} \,.
\]
However, since $\C$ does not have all finite limits, the sliced index category does not have all finite products, and so we cannot simply repeat the proof from Proposition \ref{prop:Itiny}.  But as in that proof, we do have a ``successor'' functor 
\[
s_{[1]} : \C/_{[1]} \to \C/_{[1]}\,,
\]
resulting from the ``predecessor'' natural transformation $s \Rightarrow 1_\C$ given by the  projection $\I\times X \to X$. Evaluating $s$ at each object $f : [n] \to [1]$ in  $\C/_{[1]}$, we obtain a commutative diagram:
\begin{equation}\label{diag:snatural}
\begin{tikzcd}
s[n]  \ar[d,swap, "{sf}"] \ar[r, "{\cong}" ] & {[1]}\!\times\! {[n]}  \ar[r, "p_n"] & {[n]} \ar[d, "f"] \\  
s[1]  \ar[r, swap, "{\cong}" ] & {[1]}\!\times\! {[1]}  \ar[r, swap, "p_1"] & {[1]}
 \end{tikzcd}
 \end{equation}
We can then set $s_{[1]}(f) = p_1\circ sf = f\circ p_n$. As in the foregoing proof, we can then calculate the values of the adjoints on presheaves, associated to $s_{[1]}$,
 \[
 {s_{[1]}}_! \dashv {s_{[1]}}^* : \widehat{\C/_{[1]}} \too \widehat{\C/_{[1]}} \]
  to be, successively,
 \begin{align*}
 {s_{[1]}}_! (X) &= \I^*\I \times X\,, \\
  {s_{[1]}}^* (X) &= X^{\I^*\I} \,.
 \end{align*}
The first equation follows from the observation that the diagram \eqref{diag:snatural} is a pullback, and so the object $s_{[1]}(f)  : s[n]\to [1]$ of $\widehat{\C/_{[1]}}$ given by the evident composite is just $\I^*\I \times f $, and the diagram itself represents the counit map $(\I^*\I \times f) \to f$ over $\I$.
 The second line then follows by adjointness, as does the fact that we have a further right adjoint, namely, the ${\I^*\I}$-\emph{root}:
 \begin{equation*}
 {s_{[1]}}_* (X) =: X_{\I^*\I} \,.
 \end{equation*}
\end{proof}

\begin{lemma}\label{lemma:pathspacepushforward}
The pushforward functor along any map $f : X\to Y$ preserves pathspaces; for any object $A \to X$ over $X$, the pathobject of the pushforward $f_*A$ is (canonically isomorphic to) the pushforward of the pathobject,
\[
(f_*A)^\I \cong f_*(A^\I)\,
\]
over $Y$.
\end{lemma}
\begin{proof}
This true for any constant family $X^*C = X\times C \to X$ with $C$ in place of $\I$, as the reader can easily verify, using the Beck-Chevalley condition.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection*{Cubical sets as a classifying topos}\label{subsec:classtopos}
%
%(This subsection collects some basic facts about cubical sets that are not needed in the remainder of the lectures.)  
%
%The objects of the Cartesian cube category $\Box$ may be taken concretely to be finite sets of the form $$[n] = \{\bot, x_1, ..., x_n, \top\},$$ and the arrows $f : [n] \to [m]$ to be all bipointed maps $[m]\to [n]$ (note the direction).  These maps are evidently just $m$-tuples of elements from the set $[n]$, which are easily shown to be composites of faces, degeneracies, permutations, and diagonals. 
%
%The category of \emph{(Cartesian) cubical sets} is the presheaf topos
%\[
%\cSet =  \psh{\Box}.
%\]
%It is of course generated by the representable presheaves $\I^n := \yon[n],$ called the \emph{$n$-cubes}.  The $0$-cube is $\I^0 = \yon[0] =1$; the $1$-cube is $\I = \yon[1]$; and $\I^n \times \I^m \cong \I^{n+m}$ in virtue of preservation of products by the Yoneda embedding $\yon : \op{\Box} \hook\cSet$.  For a cubical set $X: \op{\Box} \to \Set$ we write $X_n = X[n]$ and call this the \emph{set of $n$-cubes in $X$}, for which we have the usual Yoneda correspondence,
%\[
%\{c \in X_n \} \ \cong\ \{c : \I^n \to X\}.
%\]
%In particular, $\I^n_m = \cSet([m],[n])$ is the set of $m$-cubes in the $n$-cube.\footnote{Note that the cardinality of $\I^n_m$ is therefore just $(m+2)^n$, in comparison to the \emph{Dedekind} cubes, for which \eg\ $\cSet([1],[n])$ the $n^{th}$ \emph{Dedekind number}, the number of elements in the free distributive lattice on $n$ generators, which in general is  a number so large that it is unknown for values of $n>7$.} 
%
%\begin{proposition}
%The category $\cSet$ of Cartesian cubical sets is the classifying topos for \emph{strictly bipointed objects}: objects $A$ with points $a_0, a_1 : 1\to A$ the equalizer of which is $0\to 1$.
%\end{proposition}
%
%\begin{proof}
%Consider the covariant presentation $\cSet = \Set^\B$ where $\B$ is the category of finite, strictly bipointed sets and bipointed maps.  We can extend $\B\hook\B_=$ by freely adjoining coequalizers, making $\B_=$ the free finite \emph{colimit} category on a co-bipointed object. An concrete presentation of $\B_=$ is the finite bipointed sets, including those with $\bot=\top$.  Let us write $(n)$ for the bipointed set $\{x_1, ..., x_n, \bot=\top\}$, with $n$ (non-constant) elements and a further element $\bot=\top$.  There is an evident coequalizer $[1]\rightrightarrows [n]\to(n)$, which just identifies the distinguished points, and every coqualizer has either the form $[m]\rightrightarrows [n]\to [k]$ or $[m]\rightrightarrows [n]\to(k)$, for a suitable choice of $k$.  Note that there are no maps of the form $(m)\to [n]$, and that every map $[m]\to (n)$ factors uniquely as $[m]\to (m)\to (n)$ with  $[m]\to(m)$ the canonical coequalizer of $\bot$ and $\top$.  The category $\B_=$ can therefore be decomposed into two ``levels'', the upper one of which is essentially $\B$, the lower one consisting of just the objects $(n)$ and thus essentially the finite \emph{pointed} sets, and for each $n$, there is the canonical coequalizer $[n]\to(n)$ going from the upper level to the lower one.
%\[
%\xymatrix{
%\dots \ar[r] & [m] \ar@{->>}[d] \ar[r] & [n] \ar@{->>}[d] \ar[r] & \dots \\
%\dots \ar[r] & (m) \ar[r] & (n) \ar[r] & \dots
%}
%\]
%Write $u : \B\to\B_=$ for the upper inclusion, which is the classifying functor of generic co-bipointed object in $\B_=$ (which is strict).  
%
%Now consider the induced geometric morphism:
%\[
%\xymatrix{
%\Set^\B \ar@<-2ex>[rr]_{u_!} \ar@<2ex>[rr]^{u_*} && \ar[ll]|-{\,u^*} \Set^{\B_=}  & u_! \dashv u^* \dashv u_*
%}
%\]
%Since $u^*$ is the restriction along $u$, the right adjoint $u_*$ must be ``prolongation by $1$'',
%\begin{align*}
%u_*(P)[n] &= P[n],\\
%u_*(P)(n) &= \{*\},
%\end{align*}
%with the obvious maps,
%\[
%\xymatrix{
%\dots \ar[r] & P[m] \ar@{->>}[d] \ar[r] & P[n] \ar@{->>}[d] \ar[r] & \dots \\
%\dots \ar[r] & \{*\} \ar[r] & \{*\} \ar[r] & \dots
%}
%\]
%as is easily seen by considering maps in $\Set^{\B_=}$ of the form
%\[
%\xymatrix{
% Q[n] \ar[d]_{\cdot} \ar[r] & P[n] \ar@{->>}[d]^{\cdot} \\
% Q(n) \ar[r]^{} & \{*\} .
%}
%\]
%Since $u_* : \Set^{\B} \to \Set^{\B_=}$ is evidently full and faithful, it is the inclusion part of a sheaf subtopos $\mathsf{sh}(\B^\mathsf{op}_=, j) \hook \Set^{\B_=}$ for a suitable Grothendieck topology $j$ on $\B^\mathsf{op}_=$.  We claim that $j$ is the closed complement topology of the subobject $[\bot=\top] \rightarrowtail 1$ represented by the coequalizer $[0]\to (0)$.  Indeed, in $\Set^{\B_=}$ we have the representable functors:
%\begin{align*}
%\I &= y[1],\\
%1 &= y[0],\\
%[\bot=\top] &= y(0)
%\end{align*}
%fitting into an equalizer $[\bot=\top] \to 1 \rightrightarrows \I$, which is the image under Yoneda of the canonical coequalizer $[1] \rightrightarrows [0]\to (0)$ in $\B_=$.  The closed complement topology for $[\bot=\top] \mono 1$ is generated by the single cover $0\to [\bot=\top]$, which can be described logically as 
%forcing the sequent $(\bot=\top \vdash \bot)$ to hold.  Recall from \cite{JohnstoneTT}, Proposition 3.53, the following simple characterization of the sheaves for a closed topology generated by an object $U\mono 1$: an object $X$ is a sheaf iff $X\times U \cong U$. In the present case, it therefore suffices to show that for any $P:\B_= \to \Set$ we have:
%\[
%P\times [\bot=\top] \cong [\bot=\top] \quad\text{iff}\quad P(n) = 1\ \text{for all $n$}.
%\]
%For any object $b\in \B_=$, consider the map
%\[
%\hom(yb, P\times [0=1] ) \cong \hom(yb, P) \times \hom(yb, [\bot=\top]) \to \hom(yb, [\bot=\top]) .
%\]
%If $b = [k]$, then $\hom(yb, [\bot=\top]) \cong \hom_{\B_=}((0), [k]) \cong 0$, and so we always have an iso
%\[
%\begin{split}
%\hom(yb, P\times [\bot=\top] ) \cong \hom(yb, P) \times \hom(yb, [\bot=\top])\\
% \cong \hom(yb, P) \times 0 \cong 0.
% \end{split}
%\]
%If $b = (k)$, then $\hom(y(k), [\bot=\top]) \cong \hom_{\B_=}((0), (k)) \cong 1$, and we have an iso
%\[
%\begin{split}
%\hom(y(k), P\times [\bot=\top] ) \cong \hom(y(k), P) \times \hom(y(k), [\bot=\top]) \\
%\cong \hom(y(k), P) \times 1 \cong \hom(y(k), P) \cong P(k).
%\end{split}
%\]
%Thus we will have an iso $P\times [\bot=\top] \cong [\bot=\top] $ iff $P(k) \cong 1$.
%
%Thus the presheaf topos $\Set^\B$ is the closed complement of the open subtopos $$\Set^{\B_=}/_{[\bot=\top]}\ \hook\ \Set^{\B_=}$$ given by forcing the proposition $\bot \neq \top$.  Since $\Set^{\B_=}$ is clearly the classifying topos for \emph{arbitrary} bipointed objects $\bot, \top : 1\to B$, the subtopos $\Set^\B$ indeed classifies \emph{strictly} bipointed objects, as claimed.
%\end{proof}
%
%
%\begin{corollary}
%The geometric realization functor to topological spaces 
%$$R: \cSet \to \mathsf{Top}$$
%preserves cartesian products, $R(X\times Y) \cong R(X)\times R(Y)$.\footnote{This fact and the next one are to be contrasted with the case of monoidal cubical sets, \eg\ as studied by \cite{Jardine,Dougherty}}
%\end{corollary}
%
%\begin{proof}
%This can of course be shown directly, but it follows immediately by composing the inverse image of the classifying geometric morphism $\mathsf{sSets} \to \cSet$ of the $1$-simplex $\Delta^1$ with the standard geometric realization $\mathsf{sSets} \to \mathsf{Top}$, each of which preserves finite products.
%\end{proof}
%
%\begin{definition}
%Let $\Box \to\  \Cat$ be the unique product-preserving functor taking the interval $[1]$ to the one arrow  category $\bbtwo = (0\leq1)$.  This functor then takes $[n]$ to $\bbtwo^n$, the $n$-fold product in $\Cat$, and maps $[m] \to [n]$  to the corresponding monotone functions of the posets $\bbtwo^n$.  The  \emph{cubical nerve} functor $$N : \Cat \to \cSet$$ is then defined by:
%\[
%N(\bbC)_n = \Cat(\bbtwo^n, \bbC).
%\]
%Thus $N(\bbC)_0$  is the set of objects of \bbC; $N(\bbC)_1$ is the set of arrows; $N(\bbC)_2$ consists of all commutative squares; $N(\bbC)_3$ all commutative cubes, etc. 
%\end{definition}
%
%\begin{proposition}
%The nerve functor $N : \Cat \to \cSet$ is full and faithful.
%\end{proposition}
%\begin{proof}
%Given categories $\bbC$ and $\D$ and functors $F, G : \bbC\to\D$, suppose $F(f) \neq G(f)$ for some $f : A\to B$ in $\bbC$.  Take $f^{\sharp} : \bbtwo \to \bbC$ with image~$f$.  Then $N(F)_1(f^\sharp) = F(f) \neq G(f) = N(G)_1(f^\sharp)$, and so $N(F) \neq N(G) : N(\bbC)\to N(\D)$.  So $N$ is faithful.
%
%For fullness, let $\varphi : N(\bbC) \to N(\D)$ be a natural transformation, and define a proposed functor $F : \bbC\to \D$ by  
%\begin{align*}
%F_0 = \varphi_0 &: \bbC_0 = N(\bbC)_0 \to N(\D)_0 = \D_0\\
%F_1 = \varphi_1 &: \bbC_1 = N(\bbC)_1 \to N(\D)_1 = \D_1.
% \end{align*}
%We just need to show that $F$ preserves identity arrows and composition.
%Consider the following diagram.
%\[
%\xymatrix{
%\Cat(\bbtwo^1, \bbC) = N(\bbC)_1 \ar[r]^{F_1} & N(\D)_1 = \Cat(\bbtwo^1, \D) \\
%\Cat(\bbtwo^0, \bbC) = N(\bbC)_0 \ar[u]^{!^*} \ar[r]_{F_0} & N(\D)_0 = \Cat(\bbtwo^0, \D) \ar[u]_{!^*}.
%}
%\]
%Here $!^* : \Cat(\bbtwo^0, \bbC) \to \Cat(\bbtwo, \bbC) $ is precomposition with $! : \bbtwo = \bbtwo^1 \rightarrow \bbtwo^0 = \mathbbm{1}$, so the diagram commutes.  But since $! : \bbtwo \rightarrow \mathbbm{1}$ is a functor, $$\bbC_0 = \Cat(\mathbbm{1}, \bbC)  \stackrel{!^*}{\to}  \Cat(\bbtwo, \bbC) = \bbC_1$$ takes objects in $\bbC$ to their identity arrows.  Thus $F$ preserves identity arrows.  Similarly, for composition, consider 
%\[
%\xymatrix{
%\Cat(\bbtwo^2, \bbC) = N(\bbC)_2 \ar[d]_{d^*} \ar[r]^{\varphi_2} & N(\D)_2 = \Cat(\bbtwo^2, \D) \ar[d]^{d^*} \\
%\Cat(\bbtwo, \bbC) = N(\bbC)_1  \ar[r]_{F_1} & N(\D)_1 = \Cat(\bbtwo, \D).
%}
%\]
%where $\varphi_2 : N(\bbC)_2 \to N(\D)_2$ is the action of $\varphi$ on commutative squares of arrows, and $d^* : \Cat(\bbtwo^2, \bbC) \to \Cat(\bbtwo, \bbC)$ is precomposition with the diagonal map $d : \bbtwo \rightarrow \bbtwo^2 = \bbtwo\times\bbtwo$, so the diagram commutes.  For any composable pair of arrows $A \stackrel{f}{\to} B \stackrel{g}{\to} C$ in $\bbC$ there is a commutative square 
%\[
%\xymatrix{
%A \ar[r]^{f} \ar[d]_{f} & B \ar[d]^{g} \\
%B  \ar[r]_{g} & C,
%}
%\]
%and the effect of $d^* : \Cat(\bbtwo^2, \bbC) \to \Cat(\bbtwo, \bbC)$ on this square is exactly $g\circ f: A\to C$, and similarly for $d^* : \Cat(\bbtwo^2, \D) \to \Cat(\bbtwo, \D)$.  Thus the commutativity of the above diagram implies that $F$ preserves composition.
%Since clearly $N(F) = \varphi$, we indeed have that $N$ is also full.
%\end{proof}
%
%\begin{proposition}\label{prop:pathobject}
%For any cubical set $X$, the exponential $X^\I$ is calculated as the ``shift by one dimension'', 
%\[
%X^\I(n) \cong X(n+1)\,.
%\]
%\end{proposition}
%
%\begin{proof}
%\[
%\begin{split}
%X^\I(n) \cong \hom(y[n], X^\I) \cong \hom(\I^n, X^\I)\ \cong\ \hom(\I^n\times \I, X)\\
%\cong\ \hom(\I^{n+1}, X)\cong\ \hom(y[n+1], X)\ \cong\ X(n+1).
%\end{split}
%\]
%\end{proof}
%
%\begin{corollary}\label{cor:rightadjpath}
%The functor $X \mapsto X^\I$ has a \emph{right} adjoint.
%\end{corollary}
%\begin{proof}
%The functor $X \mapsto X^\I$ is given by precomposition with the ``successor'' functor $S : \H\to\H$ with $S[n] = [n+1]$.  Thus $X^\I([n]) = X(S[n]) = (S^*(X))([n])$.  Precomposition always has a right adjoint $S^* \dashv S_*$, which can be calculated as:
%\[
%S_*(X)(n) \cong \hom(y[n], S_*X) \cong \hom(S^*(y[n]), X)\ \cong \hom(\H(S(-), [n]), X).
%\]
%\end{proof}
%
%We need the following fact in order to calculate the right adjoint further.
%
%\begin{lemma}\label{lemma:binomial}
%In $\HH$, we have $\I^\I\ \cong\ \I+1$.
%\end{lemma}
%\begin{proof}
%For any $[n] \in \H$ we have:
%\[
%(\I^\I)(n) \cong \I(n+1) \cong \Hom(\I^{(n+1)},\I)\cong \H([n+1],[1])\cong \B([1], [n+1])\cong n+3.
%\]
%On the other hand,
%\[
%(\I+1)(n) \cong \I(n) + 1(n) \cong \Hom(\I^n, \I) + 1 \cong \B([1],[n]) +1 \cong (n+2) +1.
%\]
%The isomorphism is natural in $n$.
%\end{proof}
%%
%We mention that a similar fact holds for the generic object in the object classifier topos, and in the Schanuel topos, and is used in the theory of ``abstract higher-order syntax'' \cite{Pitts,Fiore}.
%
%
%\begin{definition}
%Let us write
%\[
%X_\I = S_*(X)
%\]
%for the right adjoint of the path object functor $X^\I = S^*X$.
%\end{definition}
%
%\begin{corollary}
%We have the following calculation for the right adjoint $X_\I$:
%\begin{align*}
%X_\I(n) &\cong \hom(\I^n, X_\I) \\
%&\cong \hom((\I^n)^\I, X) \\
%&\cong \hom((\I^\I)^n, X) \\
%&\cong \hom((\I+1)^n, X) \\
%&\cong \hom(\I^n + C^n_{n-1}\I^{n-1} + \dots + C^n_{1}\I+1, X) \\
%&\cong X(n) \times X(n-1)^{C^n_{n-1}} \times \dots \times X(1)^{C^n_{1}}\times X(0),
%\end{align*}
%where $C^n_{k} = \binom{n}{k}$ is the usual binomial coefficient.
%\end{corollary}
%
%\begin{corollary}
%There is a natural transformation $X_\I \to X$, given by the first projection from $X_\I(n)\cong X(n) \times X(n-1)^{C^n_{n-1}} \times \dots \times X(1)^{C^n_{1}}\times X(0)$.
%\end{corollary}
%
%Finally, we observe that that the path object functor $X^\I$ itself, as a left adjoint, preserves all \emph{co}limits.  This does not hold in general in type theory, but will be a special property of the cubical model.  (Cf. Lawvere \cite{ATOM} on the notion of ``tiny'' objects and the ``amazing right adjoint''.)  
%
%\paragraph{Example.} (P.~Aczel)
%The cubical set $P$ of polynomials (over the integers, say), is defined by:
%\[
%P_n = \{ p(x_1, ...,  x_n)\ |\  \text{polynomials in at most}\  x_1, ..., x_n \}
%\]
%with the evident maps $P_m \to P_n$ for each function $[m] \to [n]$.
%
%This is a ring object in the category of cubical sets, and the interval $\I\ = y[1]$ embeds into $P$.
%The same is true for any algebraic theory $\T$ with two constants, such as boolean algebras: there is a cubical $\T$-algebra $A$ and a monic $\I \mono A$.
%
%Let $\C[\I] = \H$ be the cube category, classifying intervals, and $\C[\T]$ the classifying category for $\T$-algebras.  There is an interval $J$ in $\C_\T$  consisting of the generic $\T$-algebra and its two constants.  This $J$ has a classifying functor $J : \C_\I \to \C_\T$, inducing functors on presheaves
%\[
%J_! \dashv J^* \dashv J_* : \psh{\C_\I} \to \psh{\C_\T}
%\]
%as usual, where $J_! \circ \y_{\C_\I} =\ \y_{\C_\T} \circ J$,  with $\y$ the respective Yoneda embeddings.
%
%We can calculate:
%\begin{equation}
%\begin{split}
%J^* J_! ( \I )( [n] ) &= J^* J_! ( Y[1] )( [n] )\\
% &= J^* Y( J[1] )( [n] ) = Y( J[1] )( J[n] ) \\
% &= \C_\T( J[n] , J[1] ) = \T\mathrm{-Alg}( J[1] , J[n] ) \\
% &= \T\mathrm{-Alg}( F(1) , F(n) ) = | F(n) |,
%\end{split}
%\end{equation}
%where $F(n)$ is the free $\T$-algebra on $n$ generators.  So in the case of polynomials we indeed have 
%$$P = J^* J_! ( \I ).$$
%The unit of the adjunction $\I \to J^* J_! ( \I )$ is faithful, since $J$ itself is faithful and therefore the left adjoint $J_!$ is faithful.
%$P$ is a ring in $\psh{\C_\I}$ since $J_!(\I)$ is a ring in $\psh{\C_\T}$ and $J^*$ is left exact.
%
%A closely related example is the cubical set of ``boolean polynomials",
%\[
%B_n = \{ \varphi(p_1, ...,  p_n)\ |\ \text{propositional formulas in at most $p_1, ...,  p_n$} \}
%\]
%which is the free boolean algeba $2^{2^n}$.  

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The cofibration weak factorization system}\label{sec:cofibrations}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{definition}[Cofibration]\label{def:cofibration}
The \emph{cofibrations}, written $$c : A \mono B\,,$$ are any class $\mathcal{C}$ of monomorphisms in $\mathsf{cSet}$
satisfying the following axioms:
\begin{enumerate}
\item[(C0)] The map $0\to C$ is always a cofibration.
\item[(C1)] All isomorphisms are cofibrations.
\item[(C2)] The composite of two cofibrations is a cofibration.
\item[(C3)] Any pullback of a cofibration is a cofibration.
\end{enumerate}
We also require the cofibrations to be classified by a subobject $\Phi \hook \Omega$ of the standard subobject classifier $\top: 1 \to \Omega$ of $\mathsf{cSet}$:
\begin{enumerate}
\item[(C4)] There is a terminal object $t:1\mono \Phi$ in the category of cofibrations and cartesian squares.
\end{enumerate}
Two further axioms for cofibrations will be added in Section \ref{sec:biasedfibration}, one in Section \ref{subsec:unbiasedfibration}, and a final one in Section \ref{sec:realignment} (see Appendix \ref{appendix:Cofibrations} for a summary).  Note that we also permit the case $\Phi = \Omega$, so that all monos are cofibrations, in which case no axioms are required.
\end{definition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{The cofibrant partial map classifier.}
Write 
\begin{equation}\label{eq:partialmapclassifier}
X^+ := \sum_{\varphi: \Phi}X^{[\varphi]}\ =\ \Phi_!\,t_*(X)\,,
\end{equation}
for the polynomial endofunctor $\cSet\too \cSet$ determined by the cofibration classifier $t : 1 \mono \Phi$ (see  \cite{GK}).  The reader familiar with type theory will recognize the  similarity to the ``partiality'' or ``lifting''  monad.  

Observe that since $t$ is monic there is a pullback square,
\[
\xymatrix{
X \ar[d]\pbcorner \ar[r] & X^+ \ar[d]^{t_*X}\\
1 \ar[r]_{t} & \Phi.
}
\]
Let $\eta : X\mono X^+$ be the indicated top horizontal map; we call this map the \emph{cofibrant partial map classifier} of $X$.
 
\begin{proposition}\label{prop:cofparclass}
The map $\eta : X\mono X^+$ classifies partial maps into $X$ with cofibrant domain, in the following sense.
\begin{enumerate}
\item The map $\eta : X\mono X^+$ is a cofibration.
\item For any object Z and any partial map $(s,g): Z\leftarrowtail S\ra X$, with $s : S\mono Z$ a cofibration, there is a unique $f:Z\ra X^+$ making a pullback square as follows.
\[
\xymatrix{
S \ar@{>->}[d]_{s} \pbcorner \ar[r]^g & X \ar@{>->}[d]^{\eta}\\
Z \ar[r]_f & X^+
}
\]
\end{enumerate}
\end{proposition}

\begin{proof}
The map $\eta : X\mono X^+$ is a cofibration since it is a pullback of $t : 1\ra \Phi$. Observe that $(\eta, 1_X) : X^+\leftarrowtail X\ra X$ is therefore a partial map into $X$ with cofibrant domain. The second statement is the universal property of $X^+$ as a polynomial (see \cite{AN}, prop.~7). 
\end{proof}

%\paragraph{The +-monad.}

\begin{proposition}\label{prop:plusmonad}
The pointed endofunctor determined by $\eta_X : X\mono X^+$ has a natural multiplication $\mu_X : X^{++} \ra X^+$ making it a monad.
\end{proposition}

\begin{proof}
Since the cofibrations are closed under composition, the monad structure on $X^+$ follows as in \cite{AN}, proposition XY.  Explicitly, $\mu_X$ is determined by proposition \ref{prop:cofparclass} as the unique map making the following a pullback diagram.
\[
\xymatrix{
X \ar@{>->}[d]_{\eta_X} \ar[r]^= & X \ar@{>->}[dd]^{\eta}\\
X^+ \ar@{>->}[d]_{\eta_{X^+}} & \\
X^{++} \ar@{.>}[r]_\mu & X^+
}
\]
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Relative partial map classifier.}

For any object $X\in\cSet$ the usual pullback functor $$X^* : \cSet \ra \cSet/_X\,,$$ taking any $A$ to the second projection $A\times X\ra X$, not only preserves the subobject classifier $\Omega$, but also the cofibration classifier $\Phi \hook \Omega$, where a map in $\cSet/_X$ is defined to be a cofibration if it is one in \cSet. Thus in $\cSet/_X$ the \emph{(relative) cofibration classifier} is the map
\[
t \times X : 1\times X \ra \Phi\times X	\quad\text{over $X$}
\]
which we may also write $t_X : 1_X \ra \Phi_X$.  Like $t : 1\ra \Phi$, this map determines a polynomial endofunctor  $$+_X : \cSet/_X \ra \cSet/_X\,,$$ which commutes (up to natural isomorphism) with $+ : \cSet \ra \cSet$ and $X^* : \cSet \ra \cSet/_X$ in the evident way:
\begin{equation}\label{diag:+fibered}
\xymatrix{
\cSet/_X \ar[r]^{+_X}& \cSet/_X \\
\cSet \ar[u]^{X^*} \ar[r]_+ & \ar[u]_{X^*}\cSet 
}
\end{equation}
The endofunctor $+_X$ is also pointed $\eta_Y : Y \ra Y^+$ and has a natural monad multiplication $\mu_Y : Y^{++} \ra Y^+$, for any $Y\ra X$, for the same reason that $+$ has this structure.  Summarizing, we may say that \emph{the polynomial monad $+ : \cSet \ra \cSet$ is indexed (or fibered) over \cSet}.

\begin{definition}\label{def:+alg}
A \emph{$+$-algebra} in \cSet\ is a cubical set $A$ together with a retraction $\alpha : A^+\ra A$ of $\eta_A : A \ra A^+$, i.e.\ an algebra for the pointed endofunctor $(+ : \cSet\ra \cSet,\ \eta : 1 \ra +)$.  Algebras for the monad $(+, \eta, \mu)$ will be referred to specifically as \emph{$(+, \eta, \mu)$-algebras}, or \emph{$+$-monad algebras}. 

A \emph{relative $+$-algebra} in \cSet\ is a map $A \ra X$ together with an algebra structure over the codomain $X$ for the pointed endofunctor $+_X : \cSet/_X \ra \cSet/_X$.
\end{definition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{The cofibration weak factorization system.}

\begin{proposition}
There is an (algebraic) weak factoriation system on \cSet\ with the cofibrations as the left class and as the right class, the maps underlying the relative $+$-algebras. Thus a right map is one $f :A\ra X$ for which there is a retract $\alpha : A'\ra A$ over $X$ of the canonical map $\eta_f : A\ra A'$,
\[
\xymatrix{
A\ar[rd]_{f} \ar[r]^{\eta_f} \ar@/^5ex/ [rr]^= & A' \ar[r]^{\alpha} \ar[d]^-{f^+} & \ar[ld]^{f} A \\
& X. &
}
\]
\end{proposition}
\begin{proof}
The factorization of a map $f : Y\ra X$ is given by applying the relative $+$-functor over the codomain,
\[
\xymatrix{
Y\ar[rd]_{f} \ar@{>->}[r]^{\eta_f} & Y' \ar[d]^-{f^{+_X}} \\
& X. 
}
\]
We know by proposition \ref{prop:cofparclass} that the unit $\eta_f$ is always a cofibration, and since $f^{+_{X}}$ is the free algebra for the $+_X$-monad, it is in particular a $+_X$-algebra.

For the lifting condition, consider a cofibration $c : B\mono C$, a right map $A\ra X$, with $+_X$-algebra structure map $\alpha: A^{+_{X}} \ra A$ over $X$, and a commutative square as indicated in the following.
\[
\xymatrix{
B \ar@{>->}[dd]_{c} \ar[rr]^{g}  && A \ar[dd] \ar[rd]_{\eta} & \\
 &&& A^{+_{X}} \ar@/_4ex/ [lu]_\alpha  \ar[ld] \\
C \ar[rr]_{f} && X &
}
\]
Thus over $X$, we have the situation
\[
\xymatrix{
B\ar@{>->}[d]_{c} \ar[r]^{g} & A \ar[d]^-{\eta} \\
C \ar@{.>}[ru]_{d} & A^+ \ar@/_4ex/ [u]_\alpha
}
\]
and we seek a diagonal filler $d$ as indicated.
Since $(c,g) : B \leftarrowtail C \ra A$ is a cofibrant partial map into $A$, there is a map $\varphi : C \ra A^+$ (over X) making a (pullback) square,
\[
\xymatrix{
B\ar@{>->}[d]_{c} \ar[r]^{g} & A \ar[d]^-{\eta} \\
C \ar@{.>}[r]_{\varphi} & A^+ \ar@/_4ex/ [u]_\alpha
}
\]
We thus have $d := \alpha\circ \varphi : C \ra A$ as the required diagonal filler.

The closure of the cofibrations under retracts follows from their classification by a universal object $t : 1 \ra \Phi$, and the closure of the right maps under retracts follows from their being the algebras for a pointed endofunctor underlying a monad (cf.~\cite{RV}).  Algebraicity of this weak factorization system is immediate, since $+$ is a monad.
\end{proof}

Summarizing, we have an algebraic weak factorization system $(\mathcal{C}, \mathcal{C}^\pitchfork)$ on the category \cSet\ of cubical sets, where:
\begin{align*}
\mathcal{C}\ &=\ \text{the cofibrations}\\
\mathcal{C}^\pitchfork\ &=\  \text{the maps underlying relative $+$-algebras}
\end{align*}
We shall call this the \emph{cofibration weak factorization system}. The right maps will be denoted
\[
\mathsf{TFib} = \mathcal{C}^\pitchfork
\]
and called \emph{trivial fibrations}.

The cofibration algebraic weak factorization system is a refinement of the one defined in \cite{BurkeGarner} and mentioned in \cite{GambinoSattler}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Uniform filling structure.}

It is convenient to relate relative $+$-algebra structure with the more familiar diagonal filling condition of cofibrantly generated weak factorization systems, and specifically the special form occuring in \cite{CCHM} under the name \emph{uniform filling structure} (this notion is closely related to that of an \emph{algebraic weak factorization system}, \cf\ \cite{Garner,Riehl}).

Consider a generating sub\emph{set} of cofibrations consisting of those with representable codomain $c : C \mono \I^n$, and call these the \emph{basic cofibrations}.
\begin{equation}\label{eq:basiccof}
\mathsf{BCof} = \{c : C\mono \I^n\,|\ c\in \mathcal{C}, n\geq 0 \}.
\end{equation}

\begin{proposition}\label{prop:uniformstructequiv} For any object $X$ in \cSet\ the following are equivalent:
\begin{enumerate}
\item $X$ admits a \emph{$+$-algebra structure:} a retraction $\alpha :X^+ \ra X$ of the unit $\eta : X\ra X^+$.
\item $X\to 1$ is a \emph{trivial fibration:} it has the right lifting property with respect to all cofibrations,
\[
\mathcal{C}\, \pitchfork\,X.
\]
\item\label{smalluniformfilling} $X$ admits a \emph{uniform filling structure:} 
for each basic cofibration $c : C \mono \I^{n}$ and map $x : C\ra X$ there is given an extension $j(c,x)$,
\begin{equation}\label{diagram:uniformbasic}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[r]^{x} & X, \\
\I^{n}\ar@{.>}[ru]_{j(c,x)} &
}
\end{equation}
and the choice is \emph{uniform in $\I^n$} in the following sense.  

Given any cubical map $u : \I^m \ra \I^n$, the pullback $u^*c : u^*C\mono \I^m$, which is again a basic cofibration, fits into a commutative diagram of the form
\begin{equation}\label{diagram:uniformbasic2}
\xymatrix{
u^*C \ar@{>->}[d]_{u^*c} \ar[rr]^{c^*u} \pbcorner &&  C \ar@{>->}[d]_{c} \ar[r]^{x} & X. \\
\I^{m} \ar[rr]_{u} && \I^{n} \ar@{.>}[ru]_{j(c,x)} &
}
\end{equation}
For the pair $(u^*c,\, x\circ c^*u)$ in \eqref{diagram:uniformbasic2}, the chosen extension $j(u^*c,x\circ c^*u): \I^m \ra X$, is required to be equal to  $j(c,x)\circ u$,
\begin{equation}\label{eq:uniformfillers}
j(u^*c,x\circ c^*u) = j(c,x) \circ u.
\end{equation}
\end{enumerate}
\end{proposition}

\begin{proof}
Let $(X, \alpha)$ be a \emph{$+$-algebra} and suppose given the span $(c,x)$ as below, with $c$ a cofibration. 
\begin{equation*}%\label{diagram:proofdirectedfillers}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[r]^{x} & X \\
Z &
}
\end{equation*}
Let $\chi(c,x): Z\ra X^+$ be the classifying map of the evident partial map $(c,x) : Z\rightharpoonup X$, so that we have a pullback square as follows.
\begin{equation}\label{diagram:defphi}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[rr]^{x} \pbcorner && X \ar[d]^{\eta} \\
Z \ar[rr]_-{\chi(c,x)} && X^+
}
\end{equation}
Then set
\begin{equation}\label{def:phi}
j = \alpha\circ\chi(c,x) : Z\ra X
\end{equation}
to get a filler,
\begin{equation}\label{diagram:defphi}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[rr]^{x} && X \ar[d]^{\eta} \\
Z\ar@{.>}[rru]_{j} \ar[rr]_{\chi(c,x)} && X^+  \ar@/_4ex/ [u]_\alpha
}
\end{equation}
since $$j\circ c = \alpha\circ\chi(c,x)\circ c = \alpha\circ\eta \circ x = x.$$ Thus (1) implies (2).  To see that it also implies (3), observe that in the case where $Z=I^n$ and we specify, in \eqref{def:phi}, that
\begin{equation}\label{def:j}
j(c,x) = \alpha\circ\chi(c,x) : \I^n\ra X,
\end{equation}
then the assignment is natural in $\I^n$. Indeed,  given any $u : \I^m \ra \I^n$, we have
\begin{equation}\label{eq:proof,uniformfillers}
j(c',xu') = \alpha\circ\chi(c',xu') = \alpha\circ\chi(c,x)\circ u = j(c,x) u,
\end{equation}
by the uniqueness of the classifying maps.

It is clear that (2) implies (1), since if $\mathcal{C} \pitchfork X$ then we can take as an algebra structure $\alpha : X^+ \ra X$ any filler for the span
\[
\xymatrix{
X \ar@{>->}[d]_{\eta} \ar[r]^{=} & X .\\
X^+ \ar@{.>}[ru]_\alpha&
}
\]

To see that (3) implies (1), suppose that $X$ has a uniform filling structure $j$ and we want to define an algebra structure $\alpha : X^+ \ra X$. By Yoneda, for every $y : \I^n \ra X^+$ we need a map $\alpha(y) : \I^n \ra X$, naturally in $\I^n$, in the sense that for any $u : \I^m \ra \I^n$, we have
\begin{equation}\label{eq:proof,plusstructure}
\alpha(yu) = \alpha(y)u.
\end{equation}
Moreover, to ensure that $\alpha\eta = 1_X$, for any $x : \I^n \ra X$ we must have $\alpha(\eta\circ x) = x$. So take $y : \I^n \ra X^+$  and let $$\alpha(y) = j(y^*\eta, y'),$$
as indicated on the right below.
\begin{equation}\label{diagram:definingalpha}
\xymatrix{
u^*C \ar@{>->}[d]_{u^*y^*\eta} \ar[r]^{u'} \pbcorner &  C \ar@{>->}[d]_{y^*\eta} \ar[rr]^{y'}\pbcorner && X \ar[d]^\eta . \\
\I^{m} \ar[r]_{u} & \I^{n} \ar@{.>}[rru]_{j(y^*\eta,y')} \ar[rr]_{y} && X^+
}
\end{equation}
Then for any $u : \I^m \ra \I^n$, we indeed have 
$$\alpha(yu) =  j\big( (yu)^*\eta, y'u' \big) = j(y^*\eta, y')\circ u = \alpha(y)u,$$
 by the uniformity of $j$. Finally, if $y=\eta\circ x$ for some $x : \I^n\ra X$ then 
 $$\alpha(\eta x) =  j\big( (\eta x)^*\eta, (\eta x)'\big) = j(1_X, x) = x,$$
 because the defining diagram for $\alpha(\eta x)$, i.e.\ the one on the right in \eqref{diagram:definingalpha}, then factors as
 \begin{equation}\label{diagram:definingalphatwo}
\xymatrix{
\I^n \ar@{>->}[d]_{=} \ar[r]^{x} \pbcorner &  X \ar@{>->}[d]_{=} \ar[r]^{=}\pbcorner & X \ar[d]^\eta , \\
\I^{n} \ar[r]_{x} & X  \ar[r]_{\eta} & X^+
}
\end{equation}
and the only possible extension $j(1_X, x)$ for the span $(1_{\I^n}, x)$ is  $x$ itself.
 \end{proof}
 
 \begin{remark}\label{remark:largeuniformfilling}
 Observe that the uniformilty condition (\ref{smalluniformfilling}) can be extended to the \emph{class of all} cofibrations, in the form:
 
 \begin{enumerate}
 \item[4.]\label{largeuniformfilling} $X$ admits a \emph{(large) uniform filling structure:} 
for each cofibration $c : C \mono Z$ and map $x : C\ra X$ there is given an extension $j(c,x)$,
\begin{equation}\label{diagram:largeuniformbasic}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[r]^{x} & X, \\
Z\ar@{.>}[ru]_{j(c,x)} &
}
\end{equation}
and the choice is \emph{uniform in $Z$} in the following sense:
Given any map $u :Y \ra Z$, the pullback $u^*c : u^*C\mono Y$, which is again a cofibration, fits into a commutative diagram of the form
\begin{equation}\label{diagram:largeuniformbasic2}
\xymatrix{
u^*C \ar@{>->}[d]_{u^*c} \ar[rr]^{c^*u} \pbcorner &&  C \ar@{>->}[d]_{c} \ar[r]^{x} & X. \\
Y \ar[rr]_{u} && z \ar@{.>}[ru]_{j(c,x)} &
}
\end{equation}
For the pair $(u^*c,\, x\circ c^*u)$ in \eqref{diagram:largeuniformbasic2}, the chosen extension $j(u^*c,x\circ c^*u): \I^m \ra X$, is required to be equal to  $j(c,x)\circ u$,
\begin{equation}\label{eq:largeuniformfillers}
j(u^*c,x\circ c^*u) = j(c,x) \circ u.
\end{equation}
\end{enumerate}
Indeed, the proof that (1) implies (2) and (3) works just as well to infer (4), which in turn implies (2) and (3) as special cases.
\end{remark}

The relative version of the foregoing is entirely analogous, since the $+$-functor is fibered over $\cSet$ in the sense of diagram \eqref{diag:+fibered}.  We can therefore omit the entirely analogous proof of the following.
 
 \begin{proposition}\label{prop:uniformstructequivrelative} For any map $f : Y\ra X$ in \cSet\ the following are equivalent:
\begin{enumerate}
\item $f:Y\ra X$ admits a \emph{relative $+$-algebra structure over $X$}, i.e.\ there is a retraction  $\alpha :Y' \ra Y$ over X of the unit $\eta : Y\ra Y'$, where $f^+ : Y' \ra X$ is the result of the relative $+$-functor applied to $f$, as in definition \ref{def:+alg}.
\item $f:Y\ra  X$ is a \emph{trivial fibration},
\[
\mathcal{C}\, \pitchfork\,f.
\]
\item $f:Y\ra  X$ admits a (small) \emph{uniform filling structure}: 
for each basic cofibration $c : C \mono \I^{n}$ and maps $x : C\ra X$ and $y : \I^n\ra Y$ making the square below commute, there is given a diagonal filler $j(c,x,y)$,
\begin{equation}\label{diagram:coffillers}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[rr]^{x} && X \ar[d]^{f} \\
\I^{n}\ar@{.>}[rru]_{j(c,x,y)} \ar[rr]_{y} && Y,
}
\end{equation}
and the choice is \emph{uniform in $\I^n$} in the following sense: given any cubical map $u : \I^m \ra \I^n$, the pullback $u^*c : u^*C\mono \I^m$ is again a basic cofibration and fits into a commutative diagram of the form
\begin{equation}\label{diagram:coffillers2}
\xymatrix{
u^*C \ar@{>->}[d]_{u^*c} \ar[rr]^{c^*u} \pbcorner &&  C \ar@{>->}[d]_{c} \ar[rr]^{x} && X\ar[d]^{f} \\
\I^{m} \ar[rr]_{u} && \I^{n} \ar@{.>}[rru]_{j(c,x,y)} \ar[rr]_{y} && Y.
}
\end{equation}
For the evident triple $(u^*c,\, x\circ c^*u, y\circ u)$ in \eqref{diagram:coffillers2} the chosen diagonal filler $$j(u^*c,x\circ c^*u,y\circ u): \I^m \ra X$$ is equal to  $j(c,x,y)\circ u$,
\begin{equation}\label{eq:uniformfillers}
j(u^*c, x\circ c^*u,y\circ u) = j(c,x,y)\circ u.
\end{equation}
\end{enumerate}
\end{proposition}

We next collect some basic facts about trivial fibrations: they have sections, they are closed under composition and retracts, and they are closed under pullback and pushforward along all maps.

\begin{corollary}\label{cor:plusalgsection} 
\begin{enumerate}
\item 
Every trivial fibration $A\ra X$ has a section $s : X\ra A$.
\item If $a:A\ra X$ is a trivial fibration and $b:B\ra A$ is a trivial fibration, then  $a\circ b:B\ra X$ is a trivial fibration.
\item If $a:A\ra X$ is a trivial fibration and $a':A'\ra X'$ is a retract of $a$ in the arrow category, then $a'$ is a trivial fibration.
\item For any map $f:X\ra Y$ and any trivial fibration $B\ra Y$,  the pullback $f^*B \ra X$ is a trivial fibration.  
%\begin{equation}\label{diagram:pluspushforward1}
%\xymatrix{
%f^*A \ar[d]  \ar[rr] \pbcorner & & A \ar[d]  \\
%Y \ar[rr]_f && X
%}
%\end{equation}
\item For any map $f:X\ra Y$ and any trivial fibration $A\ra X$,  the pushforward $f_*A \ra Y$ is a trivial fibration.  
%More generally, if $B\ra Y$ is any map and $g:A\ra B$ is a $+$-algebra over $B$, then the pushforward $f_*g: f_*A \ra f_*B$ is a $+$-algebra   over $f_*B$. 
%\begin{equation}\label{diagram:pluspushforward2}
%\xymatrix{
%A \ar[d] \ar[r]^{g} & B \ar[ld] & f_*A \ar[d] \ar[r]^{f_*g} & f_*B  \ar[ld] \\
%Y \ar[rr]_f && X &
%}
%\end{equation}
\end{enumerate}
\end{corollary}
\begin{proof}
(1) holds because all objects are cofibrant by (C0). (5) is a consequence of (C3), stability of cofibrations under pullback, by a standard argument using the adjunction $f^* \dashv f_*$.  The rest hold for the right maps in any weak factorization system.
\end{proof}

\begin{remark}\label{trivfibpushforward}
The structured notion of trivial fibration, \emph{vis}.\ relative +-algebra, can also be shown algebraically (i.e.\ not using Proposition \ref{prop:uniformstructequivrelative}) to be preserved by pullback, pushforward, composition, and to be closed under retracts. We do just the case of pushforward as an example.   
Thus consider the following situation with $A\to X$ a +-algebra with structure $\alpha$, as indicated.
\begin{equation}\label{diagram:pushforwardplusalgebras}
\xymatrix{
A \ar[rd]_{\eta_A} \ar[dd]  && f_*A \ar[rd]_{\eta_{f_*A}} \ar[dd] & \\
& A^+ \ar[ld] \ar@/_3ex/ [ul]_\alpha && (f_*A)^+ \ar[ld]  \ar@{.>}@/_3ex/ [ul]_\beta \\
X \ar[rr]_{f} && Y &,
}
\end{equation}
A +-algebra structure for $f_*A \to Y$ would be a retract $\beta : (f_*A)^+ \to f_*A$ of $\eta_{f_*A} : f_*A \to (f_*A)^+$ over $Y$, which corresponds under $f^*\dashv f_*$ to a map $\tilde\beta : f^*((f_*A)^+) \to A$ over $X$ with $$\tilde\beta \circ f^*\eta_{f_*A} = \epsilon_A$$
as indicated below.
\begin{equation}\label{diagram:pushforwardplusalgebras2}
\xymatrix{
f^*f_*A \ar[rrdd]_{\epsilon_A} \ar[rr]_{f^*\eta_{f_*A}} 
	&&  f^*((f_*A)^+)  \ar@{.>}[dd]_{\tilde\beta} \\
&&\\
&& A \ar[r]_{\eta_A} & \ar@/_3ex/ [l]_\alpha A^+ .
}
\end{equation}
But since pullback $f^*$ commutes with $+$, there is a canonical iso $c : f^*((f_*A)^+)  \cong (f^*f_*A)^+$ with $ c\circ f^*\eta_{f_*A} = \eta_{f^*f_*A} $. So we can set $\tilde\beta := \alpha\circ(\epsilon_A)^+\circ c$.
\begin{equation}\label{diagram:pushforwardplusalgebras3}
\xymatrix{
f^*f_*A \ar[rrdd]_{\epsilon_A} \ar[rr]_{f^*\eta_{f_*A}}  \ar@/^4ex/ [rrr]^{\eta_{f^*f_*A}} 
	&&  f^*((f_*A)^+)  \ar@{.>}[dd]_{\tilde\beta} \ar[r]^{\sim}_{c}  & (f^*f_*A)^+  \ar[dd]^{(\epsilon_A)^+} \\
&&&\\
&& A \ar[r]_{\eta_{A}} & \ar@/_3ex/ [l]_\alpha A^+ 
}
\end{equation}
\end{remark}

%It suffices to find a filler for the following diagram.
%\begin{equation}\label{diagram:plussection}
%\xymatrix{
%0 \ar@{>->}[d] \ar[r] & A \ar[d] \\
%X\ar@{.>}[ru]_s \ar[r]_{=} & X
%}
%\end{equation}
%But $0 \ra X$ is always a cofibration by assumption.
%\end{proof}
%
%\begin{corollary}\label{cor:plusalgcompose} 
%If $f:Y\ra X$ is a $+$-algebra over $X$ and $g:Z\ra Y$ is a $+$-algebra over $Y$, then there is a canonical way of making  $f\circ g:Z\ra X$ into a $+$-algebra over $X$.
%\end{corollary}
%\begin{proof}
%One of several equivalent constructions is as follows. The square below has a caninical diagonal filler $j$ as indicated, because $\eta$ is a cofibration and $f$ a $+$-algebra.
%\begin{equation}\label{diagram:pluscompose}
%\xymatrix{
%Z \ar@{>->}[d]_{\eta} \ar[rr]^{g} && Y \ar[d]^{f} \\
%(\Sigma_YZ)^+\ar@{.>}[rru]_{j} \ar[rr] && X,
%}
%\end{equation}
%Now use the fact that $g$ is a $+$-algebra to get a canonical retraction of $\eta$ over~$Y$.
%\end{proof}

%\begin{corollary}\label{cor:plusalgretract} 
%If $f:Y\ra X$ is a $+$-algebra over $X$ and $f':Y'\ra X'$ is a retract of $f$ in the arrow category, then $f'$ is a $+$-algebra over $X'$.
%\begin{equation}\label{diagram:plusretract}
%\xymatrix{
%Z \ar@{>->}[d]_{\eta} \ar[rr]^{g} && Y \ar[d]^{f} \\
%(\Sigma_YZ)^+\ar@{.>}[rru]_{j} \ar[rr] && X,
%}
%\end{equation}
%\end{corollary}
%\begin{proof}
%The right class of a weak factorization system is always closed under retracts.
%\end{proof}
%
%\begin{corollary}\label{cor:plusalgpullback} 
%For any map $f:Y\ra X$ and any $+$-algebra $A\ra B$ over $X$,  the pullback $f^*A \ra Y$ is a $+$-algebra over~$Y$.  
%\begin{equation}\label{diagram:pluspushforward1}
%\xymatrix{
%f^*A \ar[d]  \ar[rr] \pbcorner & & A \ar[d]  \\
%Y \ar[rr]_f && X
%}
%\end{equation}
%\end{corollary}
%\begin{proof}
%The right class of a weak factorization system is always stable under pullback, but one can also see directly that a pullback of a $+$-algebra is again a $+$-algebra, using the fact that the $+$-endofunctor commutes with pullbacks.
%\end{proof}
%
%
%The proof of the following is a straighforward application of the general fact that a left adjoint preserves the left class of a weak factorization system if and only if its right adjoint preserves the right class.  We give a more detailed argument for this special case since we will need an analogous version later. 
%
%\begin{corollary}\label{cor:plusalgpushforward} 
%For any map $f:Y\ra X$ and any $+$-algebra $A\ra Y$ over $Y$,  the pushforward $f_*A \ra X$ is a $+$-algebra over~$X$.  
%\begin{equation}\label{diagram:pluspushforward1}
%\xymatrix{
%A \ar[d]  & & f_*A \ar[d]  \\
%Y \ar[rr]_f && X
%}
%\end{equation}
%More generally, if $B\ra Y$ is any map and $g:A\ra B$ is a $+$-algebra over $B$, then the pushforward $f_*g: f_*A \ra f_*B$ is a $+$-algebra   over $f_*B$. 
%\begin{equation}\label{diagram:pluspushforward2}
%\xymatrix{
%A \ar[d] \ar[r]^{g} & B \ar[ld] & f_*A \ar[d] \ar[r]^{f_*g} & f_*B  \ar[ld] \\
%Y \ar[rr]_f && X &
%}
%\end{equation}
%\begin{proof}
%Note that the first statement follows from the second one by taking $B=Y$ and $B\ra Y$ the identity map.
%
%To prove the second statement, by Proposition \ref{prop:uniformstructequivrelative} it suffices to show that $f_*g: f_*A \ra f_*B$ has the right lifting property, in the slice category over $X$, against all cofibrations.  So consider a lifting problem over $X$, with a cofibration on the left:
%\begin{equation}\label{diagram:pluspushforward3}
%\xymatrix{
%C \ar@{>->}[d]_c  \ar[r]  & f_*A \ar[d]^{f_*g}  \\
%Z \ar[r] & f_*B
%}
%\end{equation}
%Transposing across the adjunction $f^*\dashv f_*$ results in a lifting problem over $Y$ of the form
%\begin{equation*}%\label{diagram:pluspushforward1}
%\xymatrix{
%f^*C \ar@{>->}[d]_{f^*c}  \ar[r]  & A \ar[d]^{g}  \\
%f^*Z \ar[r] \ar@{..>}_j[ru] & B
%}
%\end{equation*}
%in which $f^*c$ is a cofibration, because these are preserved by pullbacks.  Thus there is a filler $j$ as indicated, since by assumption $g:A\ra B$ is a $+$-algebra over $B$ and therefore a trivial fibration.  Transposing the filler $j$ then provides a filler for the original problem \eqref{diagram:pluspushforward3}.
%\end{proof}
%\end{corollary}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The fibration weak factorization system}\label{FWFS}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

We now specify a second weak factorization system, with a restricted class of ``trivial'' cofibrations on the left, and an expanded class of right maps, the \emph{fibrations}.  As explained in the introduction, we first recall from \cite{GS} what we shall call the ``biased'' notion of fibration, before giving the ``unbiased'' one  used in our more general setting.   The biased version makes use of \emph{connections}, $$\vee,\wedge : \I\times\I \too \I,$$ on the cubes, which are also used in \cite{Sattler} to give a model structure.  We do not assume connections here.  In \cite{AGH} it is shown that the fibrations of \cite{GS, Sattler} agree with those specified in the ``logical style'' of \cite{CCHM,OP}.  

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Partial box filling (biased version)}\label{sec:biasedfibration}

The \emph{generating biased trivial cofibrations} are all maps of the form
\begin{equation}\label{eq:genclassTCof}
c \otimes \delta_\epsilon : D \mono Z\times \I\,,
\end{equation}
where:
\begin{enumerate}
\item  $c : C \mono Z$ is an arbitrary cofibration,

\item $\delta_\epsilon : 1 \ra \I$ is one of the two \emph{endpoint inclusions}, for $\epsilon = 0,1$.

\item $c\otimes\delta_\epsilon$ is the \emph{pushout-product} indicated in the following diagram.
\begin{equation}\label{diagram:pushoutproduct}
\xymatrix{
C\times 1 \ar[d]_{C\times 1} \ar[r]^{C\times \delta_\epsilon} & C\times \I \ar[d] \ar@/^4ex/ [rdd]^{c\times \I}\\
Z\times 1 \ar@/_4ex/ [rrd]_{Z\times \delta_\epsilon} \ar[r] &  Z +_C (C\times\I) \ar@{..>}[rd]_{c\, \otimes\, \delta_\epsilon} \\
&& Z\times\I
}
\end{equation}

\item $D = Z +_C (C\times\I)$ is the indicated domain of the map $c \otimes \delta_\epsilon$.
\end{enumerate}

In order to ensure that such maps are indeed cofibrations, we assume two further axioms in addition to (C1)--(C4) from Definition \ref{def:cofibration}:
\begin{enumerate}\label{cofibration_axioms}
\item[(C5)] The endpoint inclusions $\delta_\epsilon : 1 \ra \I$ are cofibrations, for $\epsilon = 0,1$.
\item[(C6)] The cofibrations are closed under pushout-products ${-}\otimes{-}$ in the arrow category.  
\end{enumerate}

Note that if we assume that $\delta_0$ and $\delta_1$ are disjoint (as they are in most categories of cubical sets), then by (C5) (and (C3), stability under pullback) we have that $0 \ra 1$ is a cofibration, so that, again by (C3), $0\ra A$ is a cofibration, for all objects $A$, so that (C0) is no longer required.  In place of (C6), we could require the cofibrations to be closed under the join operation $A\vee B$ in the lattice of subobjects of any object (as is done in \cite{CCHM,OP}).
\medskip

\paragraph{Fibrations (biased version).}
Now let 
\[
\mathcal{C}\otimes \delta_\epsilon\ =\ \{ c \otimes \delta_\epsilon : D \mono Z \times \I\ |\ c \in\mathcal{C},\ \epsilon = 0,1 \}
\]
be the class of all generating biased trivial cofibrations.
The \emph{biased fibrations} are defined to be the right class of these maps,
\[
(\mathcal{C}\otimes \delta_\epsilon)^\pitchfork\ =\ \mathcal{F}\,.
\]
Thus a map $f : Y\ra X$ is a biased fibration just if for every commutative square of the form
\begin{equation}\label{diagram:biasedfillers}
\xymatrix{
Z +_C (C\times\I) \ar@{>->}[d]_{c\, \otimes\, \delta_\epsilon} \ar[r] & Y \ar[d]^f \\
Z\times \I \ar@{.>}[ru]_{j} \ar[r] & X
}
\end{equation}
with a generating biased trivial cofibration on the left, there is a diagonal filler $j$ as indicated. %This condition can be seen as a generalized homotopy lifting property.

To relate this notion of fibration to the cofibration weak factorization system, fix any map $u : A \ra B$, and recall (\eg\ from \cite{JT,R}) that the pushout-product with $u$ is a functor on the arrow category 
\[
(-)\!\otimes u : \cSet^\mathbbm{2} \ra\cSet^\mathbbm{2}\,.
\]
This functor has a right adjoint, the \emph{pullback-hom}, which for a map $f : X\ra Y$ we shall write as
\[
(u \Rightarrow\! f) : Y^B \too (X^B \times_{X^A} Y^A) \,.
\]
The pullback-hom is determined as indicated in the following diagram.
\begin{equation}\label{diagram:pullbackhom}
\xymatrix{
Y^B \ar@/_4ex/[rdd]_{f^B} \ar@{.>}[rd]^{u\, \Rightarrow f} \ar@/^4ex/ [rrd]^{Y^u} && \\
& X^B \times_{X^A} Y^A \ar[d] \ar[r] & Y^A \ar[d]^{f^A} \\
& X^B \ar[r]_{X^u} &  X^A 
}
\end{equation}

The $\otimes\dashv\ \Rightarrow$ adjunction on the arrow category has the following useful relation to weak factorization systems (cf.~\cite{GS,Riehl,JT}), where, as usual, for any maps $a : A \ra B$ and $f : X\ra Y$ we write 
\[
a\, \pitchfork\, f 
\]
to mean that for every solid square of the form
\begin{equation}\label{eq:defpitchfork}
\xymatrix{
A\ar[d]_{a} \ar[r] & X \ar[d]^f \\
B \ar@{.>}[ru]_j \ar[r] & Y
}
\end{equation}
there exists a diagonal filler $j$ as indicated. 
%Moreover, let
%\[
%\{a\, \pitchfork\, f\}\ := \{ j : B \to X\ |\ f\circ j = y,\ j\circ a = x \} 
%\]
%be the set of all such fillers.

%%% Leibniz Lemma
\begin{lemma}\label{lemma:Leibniz}
For any maps $a : A_0 \to A_1, b : B_0 \to B_1, c : C_0 \to C_1$ in $\cSet$,
\[
(a\otimes b)\, \pitchfork\, c\quad\text{iff}\quad a\, \pitchfork\, (b\Rightarrow\! c)\,.
\]
%Moreover, there is an isomorphism,
%\[
%\{(a\otimes b)\, \pitchfork\, c\}\  \cong\ \{a\, \pitchfork\, (b\Rightarrow\! c)\}\,,
%\]
%which is natural in all three arguments, in the expected sense.
\end{lemma}
%%%

The following is now a direct corollary.

\begin{proposition}\label{prop:algequivfill}
An object $X$ is fibrant if and only if both of the endpoint  projections $X^\I \ra X$ from the pathspace are trivial fibrations. More generally, a map $f : Y\ra X$ is a fibration iff both of the maps $$(\delta_\epsilon \Rightarrow f) : Y^I \ra X^I\times_X Y$$ are trivial fibrations (for $\epsilon = 0,1$).
\end{proposition}
%\begin{proof}
%The first statement follows from the second, since the pathspace projections $X^\I \ra X$  are just the maps 
%$$(\delta_\epsilon \Rightarrow\, !_X) : X^I \ra (1^I\times_1 X) \cong X\,,$$
%for $!_X : X \ra 1$.
%
%By definition, $f : X\ra Y$ is a fibration iff every square of the form
%\begin{equation}
%\xymatrix{
%Z +_C (C\times\I) \ar@{>->}[d]_{c\, \otimes\, \delta_\epsilon} \ar[r] & Y \ar[d]^f \\
%Z\times \I \ar@{.>}[ru]_{j} \ar[r] & X\,,
%}
%\end{equation}
%with a generating trivial cofibration $c\, \otimes \delta_\epsilon$ on the left, has is a diagonal filler $j$ as indicated. Briefly,
%\[
%(c\otimes\delta_\epsilon)\, \pitchfork\, f \qquad\text{(for $c\in \mathcal{C}$, $\epsilon = 0,1$)}.
%\]
%By the $\otimes\dashv\ \Rightarrow$ adjunction, this is equivalent to the condition  
%\[
%c\, \pitchfork\, (\delta_\epsilon\!\Rightarrow\! f) \qquad\text{(for $c\in \mathcal{C}$, $\epsilon = 0,1$)}.
%\]
%That is, for every square 
%\begin{equation*}
%\xymatrix{
%C \ar@{>->}[d]_{c} \ar[r] & Y^I \ar[d]^{\delta_\epsilon \Rightarrow\,f} \\
%Z \ar@{.>}[ru]^{k} \ar[r] & X^I\times_X Y\,,
%}
%\end{equation*}
%with an arbitrary cofibration $c : C \mono Z$ on the left, there is a diagonal filler $k$ as indicated, for  $\epsilon = 0,1$. 
%But this is just to say that the maps $\delta_\epsilon\Rightarrow{f}$ are in the right class of the cofibrations, which is equivalent to their being $+$-algebras, as claimed.
%\end{proof}

\paragraph{Fibration structure (biased version).}
The $\otimes\dashv\ \Rightarrow$ adjunction determines the fibrations in terms of the trivial fibrations, which in turn can be determined by \emph{uniform} lifting against a \emph{small category} consisting of basic cofibrations and pullback squares between them, by proposition \ref{prop:uniformstructequivrelative}.  The fibrations are similarly determined by \emph{uniform} lifting against the \emph{small category} of basic, biased trivial cofibrations, consisting of all those $c \otimes \delta_\epsilon$ in $\mathcal{C}\otimes \delta_\epsilon$ where $c : C \mono \I^n$ is a \emph{basic} cofibration, \ie\ one with representable codomain.  
Thus the set of \emph{basic biased trivial cofibrations} is
\begin{equation}\label{eq:basicTCof}
\mathsf{BCof}\otimes \delta_\epsilon = \{c \otimes \delta_\epsilon : B \mono \I^{n+1}\ |\ c : C\mono \I^n,\,\epsilon = 0,1,\ n\geq 0 \},
\end{equation}
where the pushout-product $c\otimes\delta_\epsilon$ now takes the simpler form
\begin{equation}\label{diagram:basicpushoutproduct}
\xymatrix{
C \ar@{>->}[d] \ar[r] & C\times \I \ar[d] \ar@/^4ex/ [rdd]\\
\I^{n} \ar@/_4ex/ [rrd] \ar[r] &  \I^n +_C (C\times\I) \ar@{>->}[rd]_{c\, \otimes\, \delta_\epsilon} \\
&& \I^{n}\times\I
}
\end{equation}
for a basic cofibration $c : C\mono \I^n$, an endpoint $\delta_\epsilon:1 \ra \I$, and with domain $B = \big(\I^n +_C (C\times\I)\big)$.   These subobjects $B \mono \I^{n+1}$ can be seen geometrically as generalized open box inclusions.

For any map $f:Y\ra X$  a \emph{uniform, biased fibration structure} on $f$ is a choice of diagonal fillers $j_\epsilon(c,x,y)$,
\begin{equation}\label{diagram:directedfillers}
\xymatrix{
\I^n +_C (C\times\I) \ar[d]_{c\,\otimes\,\delta_\epsilon} \ar[rr]^-{x} && X \ar[d]^f \\
\I^{n}\times \I \ar@{.>}[rru]_{j_\epsilon(c,x,y)} \ar[rr]_y && Y,
}
\end{equation}
for each basic biased trivial cofibration $c \otimes \delta_\epsilon : B = (\I^n +_C (C\times\I)) \mono \I^{n+1}$ and maps $x : B\ra X$ and $y : \I^{n+1}\ra Y$, which is \emph{uniform in $\I^{n}$} in the following sense: Given any cubical map $u : \I^m \ra \I^n$, the pullback $u^*c : u^*C\mono \I^m$ of $c : C\mono \I^n$ along $u$ determines another basic biased trivial cofibration $$u^*c \otimes \delta_\epsilon : B' = (\I^m +_{u^*C} (u^*C\times\I)) \mono \I^{m+1},$$ which fits into a commutative diagram of the form
\begin{equation}\label{diagram:directedfillers2}
\xymatrix{
\I^m +_{u^*C} (u^*C\times\I) \ar[d]_{u^*c\,\otimes\,\delta_\epsilon} \ar[rr]^-{(u\times\I)'} && \I^n +_C (C\times\I) \ar[d]_{c\,\otimes\,\delta_\epsilon} \ar[r]^-{x} & X \ar[d]^f \\
\I^{m}\times \I  \ar[rr]_{u\times \I} && \I^{n}\times \I \ar@{.>}[ru]_{j_\epsilon(c,x,y)} \ar[r]_{y} & Y,
}
\end{equation}
by applying the functor $(-)\otimes\,\delta_\epsilon$ to the pullback square relating $u^*c$ to $c$.  For the outer rectangle in \eqref{diagram:directedfillers2} there is then a chosen diagonal filler $$j_\epsilon(u^*c,x\circ(u\times\I)', y\circ(u\times\I)): \I^m\times\I\ra X\,,$$ and for this map we require that
\begin{equation}\label{eq:uniformfillers}
j_\epsilon(u^*c,x\circ (u\times\I)', y\circ(u\times\I)) = j_\epsilon(c,x,y)\circ(u\times \I).
\end{equation}
This can be seen to be a reformulation of the logical specification given in \cite{CCHM} (see \cite{AGH}).

\begin{definition}\label{def:uniform} A \emph{uniform, biased fibration structure} on a map $f: Y\ra X$ is a choice of fillers $j_\epsilon(c,x,y)$ as in \eqref{diagram:directedfillers} satisfying \eqref{eq:uniformfillers} for all maps $u : \I^m\ra\I^n$.
\end{definition}

%Essentially the same argument as that given for Proposition \ref{prop:algequivfill} also yields the following sharper formulation in terms of fibration structure.
%\begin{corollary}\label{cor:fibstrequivplustr}
%Fibration structure on a map $f : Y\ra X$ is equivalent to a pair of $+$-algebra structures on the maps $$(\delta_\epsilon\Rightarrow{f}) : Y^I \ra X^I\times_X Y$$ for $\epsilon = 0,1$.
%\end{corollary}

Finally, we have the analogue of proposition \ref{prop:uniformstructequiv} for fibrant objects. The analogous statement of proposition \ref{prop:uniformstructequivrelative} for fibrations is omitted, as is the entirely analogous proof.

\begin{corollary}\label{cor:uniformfibstructequiv}  For any object $X$ in \cSet\ the following are equivalent:
\begin{enumerate}
\item $X$ is \emph{biased fibrant}, in the sense that every map $D\to X$ from the domain of a generating biased trivial cofibration $D \mono Z \times \I$ extends to a total map $Z \times \I \ra X$,
$$\mathcal{C}\otimes \delta_\epsilon\ \pitchfork\ X\,.$$

\item The canonical maps $(\delta_\epsilon\Rightarrow{X}) : X^I \ra X$ are trivial fibrations.

\item $X\ra 1$ admits a \emph{uniform biased fibration structure}.  Explicitly, for each basic biased trivial cofibration $c \otimes \delta_\epsilon : B \mono \I^{n+1}$ and map $x : B\ra X$, there is given an extension $j_\epsilon(c,x)$,
\begin{equation}\label{diagram:directedfillers2.5}
\xymatrix{
B \ar@{>->}[d]_{c \otimes \delta_\epsilon} \ar[r]^{x} & X, \\
\I^{n+1}\ar@{.>}[ru]_{j_\epsilon(c,x)} &
}
\end{equation}
and, moreover,  the choice is \emph{uniform in $\I^n$} in the following sense: Given any cubical map $u : \I^m \ra \I^n$, the pullback  $u^*c \otimes \delta_\epsilon : B'\mono \I^{m}\times\I$ fits into a commutative diagram of the form
\begin{equation}\label{diagram:directedfillers3}
\xymatrix{
B' \ar@{>->}[d]_{u^*c \otimes \delta_\epsilon} \ar[rr]^{(u\times\I)'} \pbcorner &&  B \ar@{>->}[d]_{c \otimes \delta_\epsilon } \ar[r]^{x} & X. \\
\I^{m}\times\I \ar[rr]_{u\times\I } && \I^{n}\times\I \ar@{.>}[ru]_{j(c,x)} &
}
\end{equation}
For the pair $(u^*c \otimes \delta_\epsilon,\, x\circ (u\times\I)')$ in \eqref{diagram:directedfillers3} the chosen extension $$j(u^*c \otimes \delta_\epsilon,x\circ (u\times\I)'): \I^m\times\I \ra X$$ is equal to  $j(c,x)\circ (u\times\I)$,
\begin{equation}\label{eq:uniformfillers2}
j(u^*c \otimes \delta_\epsilon,x\circ(u\times\I)') = j(c,x) (u\times\I).
\end{equation}
\end{enumerate}
\end{corollary}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Partial box filling (unbiased version)}\label{subsec:unbiasedfibration}


Rather than building a weak factorization system based on the foregoing notion of biased fibration (as is done in \cite{GS}), we shall first eliminate the ``bias'' with respect to the endpoints $\delta_\epsilon : 1 \ra \I$, for $\epsilon = 0,1$.  This will have the effect of adding more trivial cofibrations, and thus more weak equivalences, to our model structure. Consider first the simple path-lifting condition for a map $f : Y \to X$, which is a special case of \eqref{diagram:biasedfillers} with $c =\, ! : 0\mono 1$, so that $!\otimes\delta_\epsilon = \delta_\epsilon$.
\begin{equation*}
\xymatrix{
1 \ar@{>->}[d]_{\delta_\epsilon} \ar[r] & Y \ar[d]^f \\
\I \ar@{.>}[ru]_{j_\epsilon} \ar[r] & X
}
\end{equation*}
%(Note that $0\mono 1$ is a cofibration by axioms C4 and C5).

In topological spaces, for instance, rather than requiring lifts $j_\epsilon$ for each of the endpoints $\epsilon = 0,1$  of the real interval $\I = [0,1]$, one could equivalently require there to be a lift $j_i$ \emph{for each point} $i: 1\ra\I$. Such ``unbiased path-lifting'' can be formulated in \cSet\ by introducing a ``generic point'' $\delta : 1\ra \I$ by passing to $\cSet/_\I$ via the pullback functor $\I^* : \cSet\to \cSet/_\I$, and then requiring path-lifting for $\I^*f$ with respect to $\delta : \I \to \I\times \I$, regarded as a map $\delta : 1\to\I^*{\I}$ in $\cSet/_\I$. We shall therefore define $f$ to be an unbiased fibration just if $\I^*f$ is a $\delta$-biased fibration for the generic point $\delta$.  The following specification implements that  idea, while also adding cofibrant partiality, as in the biased case.  

We first replace axiom (C5) with the following stronger assumption.
%
\begin{enumerate}
\item[(C7)] The diagonal map $\delta : \I\ra\I\times\I$ of the interval $\I$  is a cofibration.  
\end{enumerate}

The unbiased notion of a fibration for $\cSet$ is now as follows.

\begin{definition}[unbiased fibration]\label{def:unbiasedfibration}
Let $\delta : \I\ra\I\times\I$ be the diagonal map.
\begin{enumerate}
\item\label{item:fibrant} An object $X$ is  \emph{unbiased fibrant} if the map 
\[
(\delta\Rightarrow\! X) = \langle\mathsf{eval}, p_2\rangle : X^\I \times \I \ra X\times \I
\]
is a trivial fibration. 
\item\label{item:fibration} A map $f : Y\ra X$ is an \emph{unbiased fibration} if the map 
\[
(\delta\Rightarrow\! f) = \langle f^\I\times \I, \langle \mathsf{eval},p_2 \rangle\rangle: Y^\I\times \I \ra (X^\I \times \I)\times_{(X\times \I)} (Y\times\I)
\]
is a trivial fibration.
\end{enumerate}
\end{definition}

%\begin{definition}[Fibration]\label{def:unbiasedfibration}
%Let $\delta : \I\ra\I\times\I$ be the diagonal map.
%\begin{enumerate}
%\item\label{item:fibrant} An object $X$ is \emph{fibrant} if the map 
%\[
%(\delta\Rightarrow\! X) = \langle\mathsf{eval}, p_2\rangle : X^\I \times \I \ra X\times \I
%\]
%is a trivial fibration. 
%\item\label{item:fibration} A map $f : Y\ra X$ is an \emph{fibration} if the map 
%\[
%(\delta\Rightarrow\! f) = \langle f^\I\times \I, \langle \mathsf{eval},p_2 \rangle\rangle: Y^\I\times \I \ra (X^\I \times \I)\times_{(X\times \I)} (Y\times\I)
%\]
%is a trivial fibration.
%\end{enumerate}
%\end{definition}
%
Let us (temporarily) write $\II = \I^*\I$ for the pulled-back interval in the slice category $\cSet/_\I$, so that the generic point is written $\delta : 1 \to \II$.
Condition \eqref{item:fibrant} above (which of course is a special case of \eqref{item:fibration}) then says that evaluation at the generic point $\delta : 1\ra \II$, the map $(\I^*X)^\delta: (\I^*X)^\II \ra \I^*X$, constructed in the slice category $\cSet/_\I$, is a trivial fibration.  
Condition \eqref{item:fibration} says that the pullback-hom of the generic point $\delta : 1\ra \II$ with $\I^*f$, constructed in the slice category $\cSet/_\I$, is a trivial fibration.  Thus a map $f: Y\to X$ is an \emph{unbiased} fibration just if its base change $\I^*f$  is a $\delta$-\emph{biased} fibration in the slice category $\cSet/_\I$.  The latter condition can also be reformulated as follows.

\begin{proposition}
A map $f : Y\ra X$ is an unbiased fibration if and only if the canonical map $u$ to the pullback, in the following diagram in $\cSet$, is a trivial fibration.
\begin{equation}\label{diagram:unbiasedfibrationeval}
\xymatrix{
Y^\I\times \I \ar@/^3ex/ [rrrd]^{\mathsf{eval}} \ar@/_3ex/ [rdd]_{f^\I\times \I} \ar@{..>}[rd]_{u}  && \\
& Y_\mathsf{eval} \pbcorner  \ar[d] \ar[rr] && Y \ar[d]^f \\
& X^\I \times \I \ar[rr]_{\mathsf{eval}} && X.
}
\end{equation}
\end{proposition}
\begin{proof}
We interpolate another pullback into the rectangle in \eqref{diagram:unbiasedfibrationeval} to obtain
\begin{equation}\label{diagram:unbiasedfibrationeval2}
\xymatrix{
 Y_\mathsf{eval} \pbcorner  \ar[d] \ar[r] & Y\times \I \ar[d] \pbcorner \ar[r] & Y \ar[d]^f \\
 X^\I \times \I \ar[r] & X\times \I \ar[r] & X
}
\end{equation}
with the evident maps. The left hand square is therefore a pullback, so we indeed have that 
\[
Y_\mathsf{eval}\ \cong\ (X^\I \times \I)\times_{(X\times \I)} (Y\times\I) \cong\ (X^\I \times \I)\times_{X} Y
\]
and $u = (\delta\Rightarrow\! f)$.
\end{proof}

As a special case, we have:
\begin{corollary}\label{cor:unbiasedfibrant}
An object $X$ is unbiased fibrant if and only if the canonical map $u$ to the pullback, in the following diagram in $\cSet$, is a trivial fibration.
\begin{equation}\label{diagram:unbiasedfibrationeval}
\xymatrix{
X^\I\times \I \ar@/^3ex/ [rrrd]^{\mathsf{eval}} \ar@/_3ex/ [rdd]_{p_2} \ar@{..>}[rd]_{u}  && \\
& \I\times X \pbcorner  \ar[d] \ar[rr] && X \ar[d] \\
& \I \ar[rr] && 1.
}
\end{equation}
\end{corollary}

Now we can run the proof of Proposition \ref{prop:algequivfill} backwards in order to determine a class of generating trivial cofibrations for the unbiased case. Consider pairs of maps $c : C\mono Z$ and $i:Z\ra\I$, where the former is a cofibration and the latter is regarded as an ``$\I$-indexing'', so that
\[
\xymatrix{
C \ar[rd] \ar@{>->}[r]^{c} & Z  \ar[d]^i \\
& \I
}
\]
is regarded as an ``$\I$-indexed family of cofibrations $c_i : C_i \mono Z_i$''.  We shall use the notation
\begin{equation}\label{eq:graphdef}
\gph{i} := \langle 1_Z, i\rangle : Z\too Z\times\I\,,
\end{equation}
for the graph of the indexing map $i : Z\ra \I$. Then write
\[
c \otimes_i\!\delta := [\gph{i}, c\times\I] : Z+_C(C\times\I) \too Z\times \I\,,
\]
which is easily seen to be well-defined on the indicated pushout below.
\begin{equation}\label{diagram:unbiasedpushoutproduct}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[r]^{\gph{ic}} & C\times \I \ar[d] \ar@/^4ex/ [rdd]^{c\times\I}\\
Z \ar@/_4ex/ [rrd]_{\gph{i}} \ar[r] &  Z +_C (C\times\I) \ar@{.>}[rd]_{c\, \otimes_i \delta} \\
&& Z\times\I\,.
}
\end{equation}

\begin{remark}\label{rem:poprodoverI}
The specification \eqref{diagram:unbiasedpushoutproduct} differs from the similar \eqref{diagram:pushoutproduct} by using the graph $\gph{i} : Z\mono Z\times\I$ for the inclusion of $Z$ into the cylinder over $Z$, rather than one of the two ``ends'',
\begin{equation}\label{eq:grtaphoverI}
\gph{1_Z , \delta_\epsilon !}  : Z\cong Z\times 1 \stackrel{Z\times \delta_\epsilon}{\longrightarrow} Z\times\I
\end{equation}
arising from the endpoint inclusions $\delta_\epsilon : 1\ra\I$, for $\epsilon = 0,1$.   Note that as an arrow over $\I$,  the graph $\gph{i} : Z\to Z\times\I$ also takes the form \eqref{eq:grtaphoverI}, namely
\[
\gph{i} = \gph{1_Z , \delta !} : Z\to Z\times \I\,.
\]
If we also regard $c : C\to Z$ as an arrow over $\I$ via $i : Z\to\I$, and use the generic point $\delta : 1 \to \II$ over $\I$ in place of $\delta_\epsilon : 1 \to \I$, then  \eqref{diagram:unbiasedpushoutproduct}  agrees with  \eqref{diagram:pushoutproduct}, up to those changes.  Thus the indicated map ${c\, \otimes_i \delta}$ in  \eqref{diagram:unbiasedpushoutproduct} \emph{is the pushout-product constructed over $\I$} of the generic point $\delta$ with the map $c$ regarded as an $\I$-indexed family of cofibrations via the indexing $i : Z \to \I$.
\end{remark}

Observe that for any map $f : X\to Y$, the graph $\gph{f} = \langle 1_X, f \rangle : X \to X\times Y$ is a cofibration, as a pullback of the diagonal of $Y$ along $f\times Y$.  The subobject $$c \otimes_i\!\delta \mono Z\times \I$$ constructed in \eqref{diagram:unbiasedpushoutproduct} is then the join, in the lattice $\Sub(Z\times \I)$, of the (cofibrant) subobjects $\gph{i} \mono Z\times \I$ and $C\times \I \mono Z\times \I$, where the latter is the ``cylinder over $C\mono Z$''.

\begin{definition}\label{def:genunbiasedtrivcof}
The maps of the form $c\otimes_i\delta : Z +_C (C\times\I) \mono Z\times\I$  now form the class of \emph{generating unbiased trivial cofibrations},
\begin{equation}\label{eq:generatingtrivialcofibrations}
\mathcal{C}\otimes\delta\ =\ \{ c \otimes_i \delta : D \mono Z \times \I\ |\ c : C\mono Z, i:Z\ra\I \}\,.
\end{equation}
\end{definition}

The unbiased fibrations are exactly the right class of these maps,
\[
(\mathcal{C}\otimes\delta)^{\pitchfork} = \mathcal{F}.
\]
\begin{proposition}\label{prop:fibiffrlp}
A map $f: Y\ra X$ is an unbiased fibration iff for every pair of maps $c : C\mono Z$ and $i:Z\ra\I$, where the former is a cofibration, every commutative square of the following form has a diagonal filler, as indicated in the following.
\begin{equation}\label{diagram:unbiasedfibration}
\xymatrix{
Z +_C (C\times\I) \ar@{>->}[d]_{c\, \otimes_i\, \delta} \ar[r] & Y \ar[d]^f \\
Z\times \I \ar@{.>}[ru]_{j} \ar[r] & X.
}
\end{equation}
\end{proposition}

\begin{proof}
Suppose that for all $c : C\mono Z$ and $i:Z\ra\I$, we have $(c\otimes_i\delta) \pitchfork f$ in $\cSet$. Pulling $f$ back over $\I$, this is equivalent to the condition $c\otimes\delta \pitchfork \I^*f$ in $\cSet/_\I$, for all cofibrations $c : C\mono Z$ over $\I$, which is equivalent to $c\pitchfork(\delta\Rightarrow \I^*f)$ in $\cSet/_\I$ for all cofibrations $c : C\mono Z$.  But this in turn means that $\delta\Rightarrow\I^*f$ is a trivial fibration, which by definition means that $f$ is an unbiased fibration.
\end{proof}

\begin{remark}\label{rem:specialtrivcofs}
Note that the endpoints $\delta_\epsilon : 1 \ra \I$, in particular, are of the form $c \otimes_i\!\delta$ by taking $Z = 1$ and $i = \delta_\epsilon$ and $c =\ ! : 0 \ra 1$, so that the case of biased filling is subsumed.  Moreover, for any $i : Z\to \I$ the graph $\gph{i} \mono Z\times \I$ is itself of the form $0 \otimes_i\!\delta$ for the cofibration $0 \cof Z$, so the graph of any ``$\I$-indexing'' map $i : Z\to\I$ is also a trivial cofibration.
\end{remark}

The following sanity check will be needed later.
\begin{proposition}\label{prop:sanitycheck}
Let $f:F\fib X$ be an unbiased fibration in $\cSet$. Then for the endpoints $\delta_0, \delta_1 : 1 \to \I$, the associated pullback-homs,
\begin{equation}\label{eq:unbiasedimpliesbiased}
\delta_\epsilon \Rightarrow f : F^\I \to X^\I \times_X F \qquad(\epsilon = 0,1)
\end{equation}
are also trivial fibrations. Thus unbiased fibrations are also $\delta_\epsilon$-biased fibrations, for $\epsilon=0,1$.
%
\end{proposition}

\begin{proof}
This follows from Remark \ref{rem:specialtrivcofs} and the ${\otimes} \dashv {\Rightarrow}$ adjunction, but we give a different proof.
Consider the case $X=1$, the general one $f:F\to X$ being analogous. Thus let $F$ be an unbiased fibrant object in $\cSet$. So by definition $(\I^*F)^\delta : (\I^*F)^\II \too \I^*F$  in $\cSet/_\I$ is a trivial fibration. %We wish to show that the maps \eqref{eq:unbiasedimpliesbiased} are also trivial fibrations.  
Pulling back $\delta : 1\to \II$ in $\cSet/_\I$ along the base change $\delta_\epsilon : 1\to \I$ takes it to $\delta_\epsilon : 1\to \I$ in $\cSet$, by the universal property of the generic point $\delta : 1\to \II$; that is $\delta_\epsilon^*(\delta) = \delta_\epsilon : 1 \to \I$.  So $(\I^*F)^\delta : (\I^*F)^\II \too \I^*F$ is taken by $\delta_\epsilon^*$ to
\[
\delta_\epsilon^* \big( {(\I^*F)^\delta} \big) =
(\delta_\epsilon^*\I^*F)^{\delta_\epsilon^*\delta} =  F^{\delta_\epsilon} : F^\I \too F\,,
\]
as shown in the following.
\begin{equation}\label{diagram:unbiasedfibration}
\xymatrix{
F^\I \ar[d]_{F^{\delta_\epsilon}} \ar[rr] \pbcorner && (\I^* F)^{\II} \ar[d]^{(\I^*F)^{\delta}} &  \\
 F \ar[d] \ar[rr] \pbcorner && \I^*F \ar[d]  \ar[r] \pbcorner & F \ar[d]  \\
 1 \ar[rr]_{\delta_\epsilon} &&  \I \ar[r] & 1
}
\end{equation}
And pullback preserves trivial fibrations. 
\end{proof}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Unbiased fibration structure.}\label{sec:unbiasedfibration}

As in the biased case, the fibrations can be determined by \emph{uniform} right-lifting against a  \emph{small category} of unbiased trivial cofibrations, now consisting of all those $c \otimes_i \delta$ in $\mathcal{C}\otimes \delta$ for which $c : C \mono \I^n$ is basic, \ie\ has representable codomain.  Call these maps the \emph{basic unbiased trivial cofibrations}, and let 
\begin{equation}\label{eq:basicunbiasedTCof}
\mathsf{BCof}\otimes \delta = \{c \otimes_i \delta : B \mono \I^{n+1}\ |\ c : C\mono \I^n,\, i : \I^n \ra \I,\,n\geq 0\}\,,
\end{equation}
where the pushout-product $c\otimes_i \delta$ now has the form
\begin{equation}\label{diagram:unbiasedbasicpushoutproduct}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[r]^{\gph{ic}} & C\times \I \ar[d] \ar@/^4ex/ [rdd]^{c\times\I}\\
\I^n \ar@/_4ex/ [rrd]_{\gph{i}} \ar[r] &  \I^n +_C (C\times\I) \ar@{.>}[rd]_{c\, \otimes_i \delta} \\
&& \I^n\times\I
}
\end{equation}
for a basic cofibration $c : C\mono \I^n$ and an indexing map $i : \I^n \ra \I$, and with domain $B = \big(\I^n +_C (C\times\I)\big)$.   These subobjects $B \mono \I^{n+1}$ can again be seen geometrically as ``generalized open box inclusions", but now the floor and lid of the open box are generalized to the graph of an arbitrary map $i:\I^n\ra \I$.

For any map $f:Y\ra X$  a uniform, unbiased fibration structure on $f$ is then a choice of diagonal fillers $j(c,i,x,y)$,
\begin{equation}\label{diagram:basicunbiasedfillers}
\xymatrix{
B \ar@{>->}[d]_{c\,\otimes_i\delta} \ar[rr]^x && X \ar[d]^f \\
\I^{n}\times \I \ar@{.>}[rru]_{j(c,i,x,y)} \ar[rr]_y && Y,
}
\end{equation}
for each basic trivial cofibration $c \otimes_i \delta : B \mono \I^{n+1}$, which is \emph{uniform in $\I^n$} in the following sense: Given any cubical map $u : \I^m \ra \I^n$, the pullback $u^*c : u^*C\mono \I^m$ and the reindexing $iu : \I^m \ra \I^n\ra\I$ determine another basic trivial cofibration $u^*c \otimes_{iu} \delta : B' = (\I^m +_{u^*C} (u^*C\times\I)) \mono \I^{m+1}$, which fits into a commutative diagram of the form
\begin{equation}\label{diagram:basicunbiasedfillersuniformity}
\xymatrix{
B' \ar[d]_{u^*c\,\otimes_{iu}\delta} \ar[rr]^{(u\times \I)'} \pbcorner  && B \ar[d]_{c\,\otimes_i\delta} \ar[rr]^x && X \ar[d]^f \\
\I^{m}\times \I  \ar[rr]_{u\times \I} && \I^{n}\times \I \ar@{.>}[rru]_{j(c,i,x,y)} \ar[rr]_y && Y.
}
\end{equation}
%by applying the functor $(-)\otimes_z\delta$ to the pullback square relating $u^*c$ to $c$.  
For the outer rectangle in \eqref{diagram:basicunbiasedfillersuniformity} there is a chosen diagonal filler 
$$j(u^*c,iu,x(u\times \I)', y(u\times \I)): \I^m\times\I\ra X,$$ and for this map we require that
\begin{equation}\label{eq:uniformunbiasedfillers}
j(u^*c,iu,x(u\times \I)', y(u\times \I)) = j(c,i,x,y)\circ (u\times \I).
\end{equation}
%This is a reformulation of the logical specification given in \cite{CCHM} (see the appendix).

\begin{definition}\label{def:unbiasedfibstructure} A \emph{uniform, unbiased fibration structure} on a map $$f: Y\ra X$$ is a choice of fillers $j(c,i,x,y)$ as in \eqref{diagram:basicunbiasedfillers} satisfying \eqref{eq:uniformunbiasedfillers} for all $u : \I^m\ra\I^n$.
\end{definition}

In these terms, we have the following analogue of corollary \ref{cor:uniformfibstructequiv}.

\begin{proposition}\label{prop:equivfibstruc} For any object $X$ in \cSet\ the following are equivalent:
\begin{enumerate}
\item $X$ is an unbiased fibrant object in the sense of Definition \ref{def:unbiasedfibration}: the canonical map $\delta\Rightarrow X : X^\I\times \I \ra X\times \I$ is a trivial fibration. 

\item $X$ has the right lifting property with respect to all generating unbiased trivial cofibrations,
\[
(\mathcal{C}\otimes\delta)\, \pitchfork\,X.
\]

\item $X$ has a uniform, unbiased fibration structure in the sense of Definition \ref{def:unbiasedfibstructure}.
\end{enumerate}
\end{proposition}

\begin{proof}
The equivalence between (1) and (2) is proposition \ref{prop:fibiffrlp}.  
So assume (1).
%, \ie\  that the map
%\[
%\delta\Rightarrow X : X^\I\times \I \ra X\times \I
%\]
%is a trivial fibration.  
Then in $\cSet/_\I$, the evaluation at $\delta : 1\to\II$,
\[
(\I^*X)^\delta : (\I^*X)^\II \too X
\]
is a trivial fibration.  By Proposition \ref{prop:uniformstructequivrelative} it therefore 
has a uniform filling structure with respect to all basic cofibrations $c :C\mono \I^n$ over $\I$.  Transposing by the $\otimes\dashv\,\Rightarrow$ adjunction and unwinding then gives exactly a uniform fibration structure on $X$.
\end{proof}

A statement analogous to the foregoing also holds for maps $f:Y\ra X$ in place of objects $X$.  Indeed, as before, we have the following sharper formulation.

\begin{corollary}
Fibration structures on a map $f : Y\ra X$ correspond uniquely to relative $+$-algebra structures on the map $(\delta\Rightarrow{f})$ (cf.\ definition \ref{def:unbiasedfibration}),
\[
(\delta\Rightarrow{f}) : Y^I\times \I \too (X^I \times \I)\times_{(X\times \I)} (Y\times\I)\,.
\]
\end{corollary}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Factorization}\label{subsec:FWFS}

\begin{definition}\label{def:FibWFSclasses}
Summarizing the foregoing definitions, we have the following classes of maps:


%\begin{itemize}
%\item  The set of \emph{basic trivial cofibrations} was determined to be
%\begin{equation}\label{eq:basicunbiasedTCof}
%\mathcal{B}\otimes\delta = \{c \otimes_z \delta : B \mono \I^{n+1}\ |\ n\geq 0\,, c : C\mono \I^n,\, z : \I^n \ra \I\}\,,
%\end{equation}
%where the pushout-product $c\otimes_z \delta$ has the form
%\begin{equation}\label{diagram:unbiasedbasicpushoutproduct2}
%\xymatrix{
%C \ar@{>->}[d]_{c} \ar[r]^{\mathsf{Gph}(zc)} & C\times \I \ar[d] \ar@/^4ex/ [rdd]^{c\times\I}\\
%\I^n \ar@/_4ex/ [rrd]_{\mathsf{Gph}(z)} \ar[r] &  \I^n +_C (C\times\I) \ar@{.>}[rd]_{c\, \otimes_z \delta} \\
%&& \I^n\times\I\,.
%}
%\end{equation}
%for any basic cofibration $c : C\mono \I^n$ and indexing map $z : \I^n \ra \I$, with domain $B = \big(\I^n +_C (C\times\I)\big)$.
%
%\item The class $\mathcal{F}$ of \emph{fibrations}, written $f : Y\onto X$, may be characterized as the right class of these,
%\[
%(\mathcal{B}\otimes\delta)^\pitchfork\, =\,\mathcal{F}.
%\]
%

\begin{itemize}
\item  The \emph{generating unbiased trivial cofibrations} were determined in \eqref{eq:generatingtrivialcofibrations} as
\begin{equation}\label{eq:genunbiasedTCof}
\mathcal{C}\otimes\delta = \{c \otimes_i \delta : D \mono Z\times\I\ |\  c : C\mono Z,\, i : Z \ra \I\}\,,
\end{equation}
where $D = \big(Z +_C (C\times\I)\big)$ and the pushout-product $c\otimes_i \delta$ has the form
\begin{equation}\label{diagram:unbiasedbasicpushoutproduct2}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[r]^{\gph{ic}} & C\times \I \ar[d] \ar@/^4ex/ [rdd]^{c\times\I}\\
Z \ar@/_4ex/ [rrd]_{\gph{ic}} \ar[r] &  Z +_C (C\times\I) \ar@{.>}[rd]_{c\, \otimes_i \delta} \\
&& Z\times\I
}
\end{equation}
for any cofibration $c : C\mono Z$ and indexing map $i: Z \ra \I$.

\item The class $\mathcal{F}$ of \emph{unbiased fibrations}, which can be characterized as the right-lifting class of the generating unbiased trivial cofibrations,
\[
(\mathcal{C}\otimes\delta)^\pitchfork\, =\,\mathcal{F}.
\]

\item The class of \emph{unbiased trivial cofibrations} is then defined to be left-lifting class of the fibrations,
\[
\mathsf{TCof}\, =\, ^{\pitchfork}\mathcal{F}.
\]
\end{itemize}
\end{definition}

It follows that the classes $\mathsf{TCof}$ and $\mathcal{F}$ are closed under retracts and are mutually weakly orthogonal, $\mathsf{TCof}\ {\pitchfork}\ \mathcal{F}$.
Thus in order to have a weak factorization system $(\mathsf{TCof}, \mathcal{F})$ it just remains to show the following.

\begin{lemma}\label{lemma:factorization}
Every map $f: X\ra Y$ in \cSet\ can be factored as $f  = p\circ i$,
\begin{equation}%\label{diagram:factorize}
\xymatrix{
X \ar[rd]_{f} \ar@{>->}[r]^i & X'\ar@{->>}[d]^p\\
& Y
}
\end{equation}
with $i: X\mono X'$ an unbiased trivial cofibration and $p: X'\onto Y$ an unbiased fibration.
\end{lemma}
%
\begin{proof}
We can use a standard argument (the ``algebraic small objects argument'', cf.~\cite{Garner}), which can be further simplified using the fact that the codomains of the basic trivial cofibrations $c\, \otimes_i \,\delta : B \mono \I^{n+1}$ are not just representable, but \emph{tiny} in the sense of Proposition \ref{prop:Itiny}, and the domains are not merely ``small'', but \emph{finitely presented}.  The reader is referred to \cite{A:cubical} for details in a similar case.
\end{proof}
%
%Thus let $X$ be any object, and we wish to find a fibrant object $X'$ and a trivial cofibration $h : X\mono X'$.
%For each basic trivial cofibration $\beta : B\mono \I^{k}$, we need to solve all extension problems of the form
%\begin{equation}\label{diagram:extensionforX}
%\xymatrix{
%B \ar@{>->}[d]_{\beta} \ar[r]^x & X.\\
%\ \I^{k} \ar@{..>}[ru]&
%}
%\end{equation}
%We first combine these into a single problem by taking a coproduct over all maps $x : B\ra X$,
%\begin{equation*}%\label{diagram:factorize}
%\xymatrix{
%{{\coprod_{x}} B} {\ar@{>->}[dd]_-{\coprod_{x}\beta}} {\ar[rr]^{[x]}} && X.\\
%&&\\
%{{\coprod_{x}} \I^{k}} {\ar@{..>}[rruu]} &&
%}
%\end{equation*}
%%Observe  that if $\beta = c \otimes_z \delta : \big(\I^n +_C (C\times\I)\big) \mono \I^{n+1} $ is a basic trivial cofibration with cofibration $c : C\mono \I^n$ and indexing map $z : \I^n \ra \I$, then for any object $Z$, the map $Z\times \beta = (Z\times c) \otimes_{zp_2} \delta : \big((Z\times\I^n) +_{(Z\times C)} (Z\times C\times\I)\big) \mono Z\times\I^{n+1} $  is a generating trivial cofibration with cofibration $Z\times c : Z\times C\mono Z\times\I^n$ and indexing map $zp_2 : Z\times \I^n \ra \I^n \ra \I$.  
%%
%We then take the coproduct over all basic trivial cofibrations $\beta : B\mono \I^k$,
%\begin{equation*}%\label{diagram:factorize}
%\xymatrix{
%{\coprod_{\beta}\coprod_{x} B} \ar@{>->}[dd]_-{\coprod_{\beta}\coprod_{x}\beta} {\ar[rr]^-{[[x]_\beta]}} && X.\\
%&&\\
%{\coprod_{\beta}\coprod_{x} \I^{k}} {\ar@{..>}[rruu]} &&
%}
%\end{equation*}
%%\begin{equation*}%\label{diagram:factorize}
%%\xymatrix{
%%{\displaystyle\coprod_{\beta: B\mono\I^k}} {X^B \times B} \ar@{>->}[dd]_{{\displaystyle\coprod_{\beta: B\mono\I^k}}X^B \times\beta} \ar[rr]^-{[\mathsf{eval}_\beta]} && X,\\
%%&&\\
%%{\displaystyle\coprod_{\beta: B\mono\I^k}}X^B \times \I^{k} \ar@{..>}[rruu]&&
%%}
%%\end{equation*}
%Note that a coproduct of trivial cofibrations is clearly a trivial cofibration. 
%
%Taking a pushout, the indicated map $h_1$ is then also a trivial cofibration, because it is a pushout of one
%\begin{equation*}%\label{diagram:factorize}
%\xymatrix{
%{\coprod_{\beta}\coprod_{x} B} \ar@{>->}[dd]_-{\coprod_{\beta}\coprod_{x}\beta} {\ar[rr]^-{[[x]_\beta]}} && X \ar@{>->}[dd]_{h_1}\\
%&&\\
%{\coprod_{\beta}\coprod_{x} \I^{k}} \ar[rr] && {\pocorner} X_1\,.
%}
%\end{equation*}
%Now iterate the construction to get a sequence of trivial cofibrations, of which we take $X'$ to be the colimit and $h :X\ra X'$ the canonical map,
%\begin{equation}\label{def:fibrepl}
%\xymatrix{
%h:X \ar@{>->}[r]_-{h_1} & X_1 \ar@{>->}[r]_-{h_2} & X_2 \ar@{>->}[r]_-{h_3} \ar@{>->}[r] & \dots\ \ar@{>->}[r] & {\varinjlim X_n} = X'.
%}
%\end{equation}
%
%To show that $X'$ is fibrant, consider an extension problem of the form \eqref{diagram:extensionforX} with $X'$ in place of $X$,
%\begin{equation*}%\label{diagram:extensionforX}
%\xymatrix{
%B \ar@{>->}[d]_{\beta} \ar[r]^-x & {\varinjlim X_n}\\
%\ \I^{k} \ar@{..>}[ru]&
%}
%\end{equation*}
%The subobject $B\mono \I^k$ has as domain an object $B$ that is a \emph{finite} colimit of maps $\I^m \ra \I^n$ of representables (as can be seen by considering sieves in the category of cubes), and is therefore finitely presented, in the sense that mapping out of it preserves filtered colimits.  Thus the map $x: B \ra {\varinjlim X_n}$ must factor through some $x_k: B \ra X_k$, giving rise to the problem
%\begin{equation*}%\label{diagram:extensionforX}
%\xymatrix{
%B \ar@{>->}[d]_{\beta} \ar[r]^-{x_k}  & X_k \ar[d] \\
%\ \I^{k} \ar@{..>}[r] &  {\varinjlim X_n}.
%}
%\end{equation*}
%But this has a solution in the next step, by the construction of $X_{k+1}$,
%\begin{equation*}%\label{diagram:extensionforX}
%\xymatrix{
%B \ar@{>->}[d]_{\beta} \ar[r]^-{x_k} & X_k \ar[d]^{h_{k+1}} \\
%\ \I^{k} \ar[r]  \ar@{..>}[rd]_j &  X_{k+1}\ar[d]\\
%& {\varinjlim X_n}.
%}
%\end{equation*}
%
%Finally, we need to show the uniformity condition on the resulting fillers $j = j(\beta,x)$.  For this to work, we must modify the colimit construction \eqref{def:fibrepl} by interleaving certain coequalizers, in order to identify fillers added at different stages.  For details, see \cite{Garner, Awodey}.
%\end{proof}

\begin{remark}\label{remak:constructive}
The proof in \ibid\ actually produces a stronger result than we need, namely an \emph{algebraic} weak factorization system.  This follows from the small generating \emph{category} $\mathcal{C}\otimes\delta$  of basic unbiased trivial cofibrations (and pullback squares of the form on the left in \eqref{diagram:basicunbiasedfillersuniformity}).  The relationship between this stronger condition and the \emph{classifying types} used in Section \ref{sec:U} is studied in \cite{Swan}, which also gives an even more ``constructive'' proof of the factorization Lemma \ref{lemma:factorization}, not requiring quotients, exactness, or impredicativity \cite{Swan:Wtypes}.  With this modification, the present approach can also be used in a \emph{quasi}topos, as occurs in \eg\ realizability and sheaves.
\end{remark}


\begin{proposition}\label{prop:fibrationwfs}
There is a weak factorization system on the category \cSet\ in which the right maps are the unbiased fibrations and the left maps are the unbiased trivial cofibrations, both as specified in definition \ref{def:FibWFSclasses}.  This will be called the \emph{(unbiased) fibration weak factorization system}.
\end{proposition}

Hereafter, unless otherwise stated, all fibrations in $\cSet$ are assumed to be  unbiased.

%The following observation will be of use later on; a proof can be found in \cite{Garner, Awodey}.
%
%\begin{corollary}
%The \emph{fibrant replacement} of a map $f:X\to Y$ 
%\begin{equation}%\label{diagram:factorize}
%\xymatrix{
%X \ar[rd]_{f} \ar@{>->}[r]^{i_f} & X'\ar@{->>}[d]^{f'}\\
%& Y \,,
%}
%\end{equation}
%can be given as an $\omega$-colimit in the slice category over $Y$, $$f' = \varinjlim_n f_n$$
%so that it is functorial, and the canonical trivial cofibrations $i_f : X\mono X'$ over $Y$ are natural, in $f : X \to Y$.  
%\end{corollary}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The weak equivalences}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In this section all fibrations are assumed to be  unbiased.

\begin{definition}[Weak equivalence]
A map $f: X\ra Y$ in \cSet\ is a \emph{weak equivalence} if it can be factored as $f  = g\circ h$,
\begin{equation*}%\label{diagram:factorize}
\xymatrix{
X \ar[rd]_{f} \ar[r]^h & W\ar[d]^g\\
& Y
}
\end{equation*}
with $h: X\ra W$ a trivial cofibration and $g: W\ra Y$ a trivial fibration. Let 
\[
\mathcal{W} = \{f: X\ra Y |\ f = g\circ h\ \text{for $g\in\mathsf{TFib}$ and $h\in\mathsf{TCof}$} \}
\]
 be the class of weak equivalences.
\end{definition}

Observe that every trivial fibration $f\in\mathcal{C}^\pitchfork$ is indeed a fibration, because the generating trivial cofibrations are cofibrations; moreover, every trivial fibration is also a weak equivalence, since the identity maps are trivial cofibrations.  Thus we have
\[
\mathsf{TFib} \subseteq (\mathcal{F} \cap \mathcal{W}).
\]
Thus, because the trivial fibrations are fibrations, every trivial cofibration $g\in{^{\pitchfork}\mathcal{F}}$ is a cofibration; moreover, every trivial cofibration is also a weak equivalence, since the identity maps are also trivial fibrations.  Thus we also have
\[
\mathsf{TCof} \subseteq (\mathcal{C} \cap \mathcal{W}).
\]

\begin{lemma}
$(\mathcal{C} \cap \mathcal{W})  \subseteq \mathsf{TCof}.$
\end{lemma}
\begin{proof}
Let $c : A\mono B$ be a cofibration with a factorization $$c = tf\circ tc : A \ra W\ra B$$ where $tc\in\mathsf{TCof}$ and $tf\in\mathsf{TFib}$.  Let $f:Y\onto X$ be a fibration and consider a commutative diagram,
\begin{equation*}%\label{diagram:extensionforX}
\xymatrix{
A \ar@{>->}[d]_{c} \ar[r]^-{a}  & Y \ar@{>>}[d]^{f} \\
B \ar[r]_{b} &  X.
}
\end{equation*}
Inserting the factorization of $c$, we have $j : W\ra Y$ as indicated, with $j\circ tc = a$ and $f\circ j = b\circ tf$, since $tc \pitchfork f$.
\begin{equation*}%\label{diagram:extensionforX}
\xymatrix{
A \ar@{>->}[dd]_{c} \ar[rd]_{tc} \ar[rr]^-{a}  && Y \ar@{>>}[dd]^{f} \\
& W \ar[ld]_{tf} \ar@{.>}[ru]_{j} & \\
B \ar[rr]_{b} &&  X.
}
\end{equation*}
Moreover, since $c\pitchfork tf$ there is an $i : B \ra W$ as indicated, with $i\circ c = tc$ and $tf\circ i = 1_B$.
\begin{equation*}%\label{diagram:extensionforX}
\xymatrix{
A \ar@{>->}[dd]_{c} \ar[rd]_{tc} \ar[rr]^-{a}  && Y \ar@{>>}[dd]^{f} \\
& W \ar[ld]_{tf} \ar@{.>}[ru]_{j} & \\
B \ar[rr]_{b} \ar@{.>}@/_2ex/[ru]_--{i} &&  X.
}
\end{equation*}
Let $k = j\circ i$. Then $k \circ c = j\circ i \circ c = j \circ tc = a$, and $f \circ k = f\circ j\circ i = b\circ tf\circ i = b$.
\end{proof}

The proof of the following is dual:
\begin{lemma}
$(\mathcal{F} \cap \mathcal{W})  \subseteq \mathsf{TFib}.$
\end{lemma}

\begin{proposition}\label{prop:FWC}
The three classes of maps $\mathcal{C}, \mathcal{W}, \mathcal{F}$ in \cSet\ constitute a \emph{premodel structure} in the sense of \cite{Barton}.   In particular,  we have 
\begin{align*}
\mathcal{F}\cap\mathcal{W} &= \mathsf{TFib}, \\
\mathcal{C}\cap\mathcal{W} &= \mathsf{TCof},
\end{align*}
and therefore two interlocking weak factorization systems:
\[
(\mathcal{C},\, \mathcal{W}\cap\mathcal{F})\ \ ,\ \ (\mathcal{C}\cap\mathcal{W},\, \mathcal{F}).
\]
\end{proposition}

\begin{corollary}
The following are equivalent for a map $f: X\ra Y$.
\begin{enumerate}
\item $f:X\to Y$ is a weak equivalence
\item the first factor $\eta  : X \to X'$ of the cofibration factorization of $f$ is a trivial cofibration.
\item the second factor $p : Y' \to Y$ of the fibration factorization of $f$ is a trivial fibration.
\end{enumerate}
\end{corollary}
%\begin{proof}
%\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Weak homotopy equivalence.}

To show that the weak equivalences of $\mathcal{W}$ satisfy the 3-for-2 condition, we shall follow the approach of \cite{Joyal}, verifying that many of the same arguments go through in the current setting.

\begin{definition}\label{homotopy}
By a \emph{homotopy} between parallel maps $f, g: X\rightrightarrows Y$, written $\vartheta : f \sim g$,  we  mean a map from the \emph{cylinder of $X$} built using the interval~$\I$,
\[
\vartheta : \I\times{X} \too Y,
\]
and such that $\vartheta \circ \iota_0 = f$ and $\vartheta \circ \iota_1 = g$, 
\begin{equation*}%\label{diagram:extensionforX}
\xymatrix{
X \ar[r]^-{\iota_0} \ar[rd]_f & \I\times\!{X} \ar[d]^-{\vartheta} & X, \ar[l]_-{\iota_1} \ar[ld]^g \\
& Y &
}
\end{equation*}
where we write the canonical inclusions into the ends of the cylinder as
\[
\xymatrix{
\iota_\epsilon : X \cong 1\times X \ar[rr]^-{\delta_\epsilon\times X} && \I\times X\,,} \qquad \epsilon = 0,1 .
\]
\end{definition}

\begin{proposition}
If $K$ is fibrant, then the relation of homotopy $f \sim g$ between maps $f,g: X\rightrightarrows K$ is an equivalence relation.  Moreover, it is compatible with pre- and post-composition. 
\end{proposition}
\begin{proof}
For $f, g: X\rightrightarrows Y$, a homotopy $f\stackrel{\vartheta}{\sim} g : X\times\I \ra Y$ is equivalent, under exponential transposition, to a path in the function space $\vartheta : \I\ra Y^X$ with endpoints $\vartheta_0 = \vartheta\circ\delta_0 = f: 1\ra Y^X$ and $\vartheta_1 = g$.  Note that $Y^X$ is fibrant if $Y$ is fibrant, since the generating trivial cofibrations are closed under taking the product with a fixed object.  So we can use box-filling in $Y^X$.    

The reflexivity of homotopy $f\sim f$ is witnessed by $\rho:\I \ra 1 \stackrel{f}{\ra} Y^X$.  

For symmetry $f\sim g\Rightarrow g\sim f$ take $\vartheta : \I\ra Y^X$ with $\vartheta_0 = f$ and $\vartheta_1 = g$ and we want to build $\vartheta' : \I\ra Y^X$ with $\vartheta'_0 = g$ and $\vartheta'_1 = f$. Take an open 2-box in $Y^X$ of the form
\begin{equation*}%\label{diagram:extensionforX}
\xymatrix{
g  & f  \\
f \ar[u]^{\vartheta} \ar[r]_\rho & f \ar[u]_\rho
}
\end{equation*}
This box is a map $b : \I+_1 \I +_1 \I \ra Y^X$ with the indicated components, and it has a filler $c : \I\times \I \ra Y^X$, i.e.\ an extension along the canonical map $\I+_1 \I +_1 \I \mono \I\times\I$, which is a trivial cofibration.  Let $t : \I\ra \I\times\I$ be the evident missing top face of the 2-cube.  We can set $\vartheta' = c\circ t : \I \ra Y^X$ to get a homotopy $\vartheta' : \I\ra Y^X$ with required endpoints.

For transitivity, $f\stackrel{\vartheta}{\sim} g\ \&\ g\stackrel{\varphi}{\sim} h\Rightarrow f\sim h$, an analogous filling construction can be used with the open box:
\begin{equation*}%\label{diagram:extensionforX}
\xymatrix{
f  & h  \\
f \ar[u]^{\rho} \ar[r]_\vartheta & g \ar[u]_\varphi
}
\end{equation*}
Compatibility under pre- and post-composition is shown by representing homotopies by mapping into the pathspace, for precomposition, and out of the cylinder, for post-composition.
\end{proof}

\begin{definition}[Connected components]
The functor $$\pi_0 : \cSet\ra\Set$$ is defined on a cubical set $X$ as the coequalizer $$X_1\rightrightarrows X_0\ra \pi_0X,$$ where the two parallel arrows are the maps $X_{\delta_0}, X_{\delta_1} : X_1 \rightrightarrows X_0$ induced by the endpoints $\delta_0, \delta_1 : 1 \rightrightarrows \I$.   For any fibrant object $K$ we therefore have $\pi_0K = \hom(1,K)/\!\!\sim$, that is, $\pi_0K$ is the set of points $1\ra K$, modulo the homotopy equivalence relation on them.
\end{definition}

One can show that in fact $\pi_0X = \varinjlim_n X_n$, the colimit being left adjoint to the constant presheaf functor $\Delta : \Set\ra\cSet$. Since the category $\B$ of finite strictly bipointed sets is sifted, we have:

\begin{corollary}
The functor $\pi_0: \cSet\ra\Set$ preserves finite products. 
\end{corollary}

As usual, a map $f: X\ra Y$ in \cSet\ will be called a \emph{homotopy equivalence} if there is a \emph{quasi-inverse} $g: Y\ra X$ and homotopies $\vartheta : 1_X \sim g\circ f$ and $\varphi : 1_Y\sim f\circ g$.

\begin{definition}[Weak homotopy equivalence]\label{def:WHE}
A map $f: X\ra Y$ is called a \emph{weak homotopy equivalence} if for every fibrant object $K$, the ``internal precomposition'' map $K^f : K^Y \ra K^X$ is bijective on connected components,  $$\pi_0K^f : \pi_0K^Y \cong \pi_0K^X\,.$$
\end{definition}

\begin{lemma}\label{lemma:HEisWHE}
A homotopy equivalence is a weak homotopy equivalence.
\end{lemma}
\begin{proof}
If $f: X\ra Y$ is a homotopy equivalence, then so is $K^f : K^Y \ra K^X$ for any $K$, since homotopy respects composition. Since $K^X$ is always fibrant when $K$ is, $\pi_0$ is well defined, and it clearly takes homotopy equivalences to isomorphisms of sets.
\end{proof}


\begin{lemma}
The weak homotopy equivalences $f : X\ra Y$ satisfy the 3-for-2 condition. 
\end{lemma}
\begin{proof}
This follows from the corresponding fact about bijections of sets.
\end{proof}

Our goal of showing that the weak equivalences satisfy 3-for-2 is now reduced to showing that a map is a weak equivalence (WE) if and only if it is a weak homotopy equivalence (WHE). This will be proved in four cases, showing that a (co)fibration is a WE if and only if it is a WHE. 

\begin{lemma}\label{lem:WHEunwound}
A map $f : X\ra Y$ is a \emph{weak homotopy equivalence} iff it satisfies the following two conditions.
\begin{enumerate}
\item For every fibrant object $K$ and every map $x : X \ra K$ there is a map $y:Y\ra K$ such that $y\circ f \sim x$,
\[
\xymatrix{
X \ar[d]_{f} \ar[r]^{x}  & K.\\
Y \ar@{..>}[ru]_{y}^{\sim} &
}
\]
We say that $x$ ``extends along $f$ up to homotopy''.
\item For every fibrant object $K$ and maps $y, y' : Y \ra K$ such that $yf \sim y'f$, there is a homotopy $y\sim y'$,
\[
\xymatrix{
X \ar[d]_{f} \ar[r]  & K^\I\ar[d] \\
Y \ar@{..>}[ru] \ar[r]_-{\langle y,y'\rangle} & K\times K.
}
\]
\end{enumerate}
\end{lemma}
\begin{proof}
Condition (1) says exactly that the internal precomposition map $K^f : K^Y \ra K^X$ is surjective on connected components, while (2) says just that it is injective.
\end{proof}

\begin{lemma}\label{lemma:CofWEtoWHE}
A cofibration $c : A \mono B$ that is a WE is a WHE.
\end{lemma}

\begin{proof}
A cofibration $c : A \mono B$ that is a WE is a trivial cofibration by proposition \ref{prop:FWC}. 
So the result follows from Lemma \ref{lem:WHEunwound}, together with the fact that $K^\del: K^\I\ra K^{1+1}\cong K\times K$ is a fibration whenever $K$ is fibrant, since $\del : 1+1 \cof \I$ is a cofibration, 
\end{proof}

\begin{lemma}\label{lemma:FibWEtoWHE}
A fibration $ p : Y \onto X$ that is a WE is a WHE.
\end{lemma}
\begin{proof}
A fibration weak equivalence $f : Y\onto X$ is a trivial fibration by proposition \ref{prop:FWC}, and therefore has a section $s: X\mono Y$, by the lifting problem
\begin{equation*}%\label{diagram:extensionforX}
\xymatrix{
0 \ar@{>->}[d]_{} \ar[r] & Y \ar@{>>}[d]^{f} \\
X\ar[r]_{=} & X,
}
\end{equation*}
%
since $0\ra X$ is a cofibration. Moreover, there is a homotopy $\vartheta : sf \sim 1_Y$, resulting from the lifting problem
\begin{equation*}%\label{diagram:extensionforX}
\xymatrix{
Y+Y \ar@{>->}[d]_{[\iota_0, \iota_1]} \ar[r]^-{[sf, 1]}  & Y\ar@{>>}[d]^{f} \\
\I\times Y \ar[r]_{f\pi_2} & X.
}
\end{equation*}
Thus $f$ is a homotopy equivalence, and so a WHE by lemma \ref{lemma:HEisWHE}.
\end{proof}

\begin{corollary}
A WE $e : X \simeq Y$ is a WHE, since $e$ can be factored into a trivial cofibration followed by a trivial fibration, each of which is a WHE, and these are closed under composition. 
\end{corollary}

\begin{lemma}\label{FibHETFib}
If $K$ is fibrant, then any fibration $f : Y \onto K$ that is a HE is a WE.
\end{lemma}
\begin{proof}
This is a standard argument, which we just sketch.  It suffices to show that any diagram of the form
\begin{equation}\label{diagram:FHEisWE}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[r]^y & Y \ar@{>>}[d]^{f} \\
K\ar[r]_{=} & K,
}
\end{equation}
with  $c : C \mono X$  a cofibration, has a diagonal filler.  
Since $f$ is a HE it has a quasi-inverse $s:X\ra Y$ with $\vartheta : fs\sim 1_K$, which we can correct to a section $s' : K\ra Y$. 
Indeed, consider 
\begin{equation*}%\label{diagram:extensionforX}
\xymatrix{
K \ar@{>->}[d]_{\iota_0} \ar[r]^{s}  & Y\ar@{>>}[d]^{f} \\
K\times \I \ar[r]_{\vartheta} \ar@{..>}[ru]^{\vartheta'}& K\\
K \ar@{>->}[u]_{\iota_1} \ar[ru]_=&
}
\end{equation*}
where $\vartheta' $ results from $\iota_0 \pitchfork f$. Let $s' = \vartheta' \iota_1$, so that $\vartheta' : s\sim s'$ and $fs' = 1_K$.

Thus we can assume that $s = s' : K\ra Y$ is a section, which fills the diagram \eqref{diagram:FHEisWE} up to a homotopy in the upper triangle.
\begin{equation*}%\label{diagram:extensionforX}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[r]^y & Y \ar@{>>}[d]^{f} \\
K\ar[r]_{=} \ar[ru]_{s}^{\sim} & K,
}
\end{equation*}
Now we can correct $s: K\ra Y$ to a homotopic $t : K\ra Y$ over $f$ by using the homotopy $\varphi : sc\sim y$  to get a map $\varphi : C\ra Y^\I$ over $f$.  Since $f$ is a fibration, the projections $p_0, p_1:Y^\I \ra Y$ over $f$ are trivial fibrations, and so there is a lift $\varphi': K\ra Y^\I$ for which $t:= p_1\varphi'$ has $tc= y$ and $ft=1_K$, and so is a filler for \eqref{diagram:FHEisWE}.
\end{proof}

\begin{lemma}\label{FibWHEfibCodTFib}
If $K$ is fibrant, then any fibration $f : Y \onto K$ that is a WHE is a WE.
\end{lemma}
\begin{proof}
Since $K$ is fibrant, so is $Y$, and since $f$ is a WHE, there is a map $s : K\ra Y$ and a homotopy $\theta: sf \sim 1_Y$ by lemma \ref{lem:WHEunwound}(1).  Thus, applying $f$ again, we have a homotopy $f\vartheta: fsf \sim f$, forming the outer commutative square in
\[
\xymatrix{
Y \ar[d]_{f} \ar[r]^{f\vartheta}  & K^\I \ar[d] \\
K \ar@{..>}[ru]_{\varphi} \ar[r]_-{\langle fs, 1_K\rangle} & K\times K.
}
\]
By lemma \ref{lem:WHEunwound}(2) there is a diagonal filler $\varphi : fs\sim 1_K$, and so $f$ is a HE. Now apply lemma \ref{FibHETFib}.
\end{proof}

\begin{lemma}\label{CofWHEfibCodTCof}
If $K$ is fibrant, then any cofibration $c : A \mono K$ that is a WHE is a WE.
\end{lemma}
\begin{proof}
Let $c : A \mono K$ be a cofibration WHE and factor it into a trivial cofibration $i : A\mono Z$ followed by a fibration $p: Z\onto K$.  By lemma \ref{lem:WHEunwound}, it is clear that a trivial cofibration is a WHE.  So both 
$c$ and $i$ are WHE, and therefore so is $p$ by 3-for-2 for WHEs.   Since $K$ is fibrant, $p$ is a trivial fibration by lemma \ref{FibWHEfibCodTFib}, and thus $c$ is a WE.  
\end{proof}

\begin{lemma}[\cite{Cisinski:??}, x.n.m]\label{lemma:CofWHEiffFibLift}
A cofibration $ c : A \mono B$ WHE lifts against all fibrations $f : Y\onto K$ with fibrant codomain.
\end{lemma}
%
\begin{proof}
Let $c : A\mono B$ be a cofibration WHE and  $f : Y\onto K$ a fibration with fibrant codomain $K$, and consider a lifting problem
\begin{equation*}%\label{diagram:extensionforX}
\xymatrix{
A \ar@{>->}[d]_{c} \ar[r]^-{a}  & Y \ar@{>>}[d]^{f} \\
B \ar[r]_{b} &  K.
}
\end{equation*}
Let $\eta : B\mono B'$ be a fibrant replacement of $B$, since $K$ is fibrant, $b$ extends along $\eta$ to give $b' : B'\ra K$ as in:   
\begin{equation*}%\label{diagram:extensionforX}
\xymatrix{
A \ar@{>->}[d]_{c} \ar[r]^-{a}  & Y \ar@{>>}[d]^{f} \\
B \ar[r]_{b} \ar[d]_\eta &  K\\
B' \ar[ru]_{b'} & 
}
\end{equation*}
Since $\eta$ is a trivial cofibration, it is a WHE. So the composite $\eta c$ is also a WHE.  But since $B'$ is fibrant, $\eta c$ is then a trivial cofibration by lemma \ref{CofWHEfibCodTCof}.  Thus there is a lift $j : B'\ra Y$, and therefore also one $k = j\eta : B\ra Y$. 
%
%Conversely, suppose the cofibration $c : A\mono B$ lifts against every fibration with a fibrant codomain.   Let $\eta : B\mono B'$ be a fibrant replacement of $B$ as before, and factor $\eta c: A \ra B'$ into a trivial cofibration $i : A\mono Y$ followed by a fibration $f : Y\onto B'$. Then in the diagram
%\begin{equation*}%\label{diagram:extensionforX}
%\xymatrix{
%A \ar@{>->}[d]_{c} \ar@{>->} [r]^-{i}  & Y \ar@{>>}[d]^{f} \\
%B \ar[r]_{\eta} \ar@{..>}[ru]_{j} &  B'
%}
%\end{equation*}
%there is a diagonal filler $j : B\ra Y$.  Moreover, there is then a section $s$ of $f$ with $s\eta = j$, since $\eta$ is a trivial cofibration. This exhibits $\eta c$ as a retract of $i$, and therefore also a trivial cofibration, and so a WHE.  Thus $c$ is also a WHE by 3 for 2.
\end{proof}

%\begin{proposition}
%Every fibration is a pullback of one over a fibrant object.  More precisely, for every fibration $f : Y\onto  X$ there exists a fibrant object $K$, a map $X\ra K$, and a fibration $p : Z\onto K$ fitting into a pullback square,
%\begin{equation*}%\label{diagram:extensionforX}
%\xymatrix{
%Y \ar@{>>}[d]_{f} \ar[r] & Z \ar@{>>}[d]^{p} \\
%X \ar[r] &  K.
%}
%\end{equation*}
%\end{proposition}
%%
%This proposition is a consequence of several stronger ones, e.g.\ the equivalence extension property of \cite{Sattler:equivalence extension property}. It is easily seen to be equivalent to the following special case.

To complete the proof that a cofibration WHE is a WE, we use the following \emph{fibration extension property}), the proof of which is deferred to section \ref{sec:FEP}.

\begin{definition}[Fibration extension property]\label{def:fibextreplace}
For any fibration $ f : Y \onto X$ and trivial cofibration $\eta: X\ra X'$,
there is a fibration $f' : Y' \onto X'$ of which $f$ is a pullback along $\eta$, 
\begin{equation}\label{diagram:FEP}
\xymatrix{
Y \ar@{->>}[d]_{f} \ar[r]  \pbcorner & Y' \ar@{>>}[d]^{f'} \\
X \ar@{>->}[r]_{\eta} &  X'.
}
\end{equation}
\end{definition}

\begin{lemma}\label{lemma:CofWEiffFibLift}
Assuming the fibration extension property, a cofibration that lifts against every fibration $f : Y\onto K$ with fibrant codomain is a WE.
\end{lemma}

\begin{proof}
Let $c : A\mono B$ be a cofibration and consider a lifting problem against an arbitrary fibration $f: Y\onto X$,
\begin{equation}\label{diagram:CofWHEiffFibLift1}
\xymatrix{
A \ar@{>->}[d]_{c} \ar[r]^-{a}  & Y \ar@{>>}[d]^{f} \\
B \ar[r]_{b} &  X.
}
\end{equation}
Let $\eta: X\ra X'$ be a fibrant replacement, so $\eta$ is a trivial cofibration and $X'$ is fibrant. 
By the fibration extension property of definition \ref{def:fibextreplace}, there is a fibration $f' : Y' \onto X'$ such that $f$ is a pullback of $f'$ along $\eta$. So we can extend diagram \eqref{diagram:CofWHEiffFibLift1} to obtain the following, in which the righthand square is a pullback.
\begin{equation}\label{diagram:CofWHEiffFibLift2}
\xymatrix{
A \ar@{>->}[d]_{c} \ar[r]^-{a}  & Y \ar@{>>}[d]^{f} {\pbcorner} \ar[r]^{y} & Y' \ar@{>>}[d]^{f'} \\
B \ar[r]_{b} &  X  \ar[r]_\eta &  X'.
}
\end{equation}
By assumption, there is a lift $j' : B\ra Y'$ with $f' j' = \eta b$ and $j'c = yb$.  Therefore, since $f$ is a pullback, there is a map $j : B\ra Y$ with $fj = b$ and $y j = j'$.  
\begin{equation}\label{diagram:CofWHEiffFibLift2}
\xymatrix{
A \ar@{>->}[d]_{c} \ar[r]^-{a}  & Y \ar@{>>}[d]_<<<<{f} {\pbcorner} \ar[r]^{y} & Y' \ar@{>>}[d]^{f'} \\
B \ar[r]_{b} \ar@{..>}[ru]^{j} \ar@{..>}[rru]_>>>>{j'} &  X  \ar[r]_\eta &  X'.
}
\end{equation}
Thus $yjc = j'c = ya$.  But as a trivial cofibration, $\eta$ is monic, and as a pullback of $\eta$, $y$ is also monic. So $jc=a$.
\end{proof}

Combining the previous two lemmas \ref{lemma:CofWHEiffFibLift} and \ref{lemma:CofWEiffFibLift} we now have the following.

\begin{corollary}\label{cor:CofWHEtoWE}
Assuming the fibration extension property,  a cofibration $ c : A \mono B$ that is a WHE is a WE.
\end{corollary}

The following is not required, but we state it anyway for the record:

\begin{lemma}\label{lemma:FibWHEtoWE}
Assuming the fibration extension property, a fibration $ f : Y \onto X$ that is a WHE is a WE.
\end{lemma}
\begin{proof}
Factor $ f : Y \onto X$ into a cofibration $i : Y\mono Z$ followed by a trivial fibration $p: Z\onto X$.  Then $f$ is a trivial fibration if $i\pitchfork f$, for then $f$ is a retract of $p$.  Since $p$ is a trivial fibration, it is a WHE by lemma \ref{lemma:FibWEtoWHE}.  Since $f$ is also a WHE, so is $i$ by 3-for-2.  Thus $i$ is a trivial cofibration by corollary \ref{cor:CofWHEtoWE}. Since $f$ is a fibration, $i\pitchfork f$ as required.
\end{proof}

\begin{proposition}\label{prop:WHEiffWE}
Assuming the fibration extension property, a map $ f : X \mono Y$ is a WHE if and only if it is a WE.  Thus the weak equivalences $\mathcal{W}$ satisfy the 3-for-2 condition.
\end{proposition}
\begin{proof}
Let $ f : X \onto Y$ be a WE and factor it into a trivial cofibration $i : X\mono Z$ followed by a trivial fibration $p: Z\onto Y$.  Then both 
$i$ and $p$ are WHE, whence so is $f$.  Conversely, let $f$ be a WHE and factor it into a cofibration $i : X\mono Z$ followed by a trivial fibration $p: Z\onto Y$. Since  $p$ is then a WHE, as is $f$, it follows that $i$ is as well.  Thus $i$ is also a WE, by lemma \ref{cor:CofWHEtoWE}, hence a trivial cofibration. So $f$ is a WE.
\end{proof}

Our results to this point can now be summarized as follows.

\begin{theorem}\label{theorem:QMSmodFEP}
Assume the fibration weak factorization system of Definition \ref{def:FibWFSclasses} satisfies the fibration extension property of Definition \ref{def:fibextreplace} (as will be shown in Corollary \ref{cor:FEP}). 
Then the weak equivalences $\WW$ have the 3-for-2 property, and so by Proposition \ref{prop:FWC}, the three classes $(\CC,\WW,\FF)$ determined by Definition \ref{def:FibWFSclasses} form a Quillen model structure on the category $\cSet$ of cubical sets.

The weak equivalences are those maps $f: X\ra Y$ for which $K^f : K^Y \to K^X$ is bijective on connected components whenever $K$ is fibrant.
\end{theorem}

%Since lemmas n-m hold in greater generality, we can reformulate this result as follows:
%
%\begin{theorem}\label{theorem:QuasiMS isMSmodFEP}
%Let $(\CC, \WW, \FF)$ be a Barton quasi-model structure \cite{Barton} (on a presheaf category).   If the $(\CC\cap\WW, \FF)$ weak factorization system satisfies the fibration extension property of Definition \ref{def:fibextreplace}.  Then $(\CC, \WW, \FF)$ is a Quillen model structure.
%\end{theorem}

The proof of the fibration extension property will occupy the second half of these lectures, concluding in Section  \ref{sec:FEP}.  It requires several intermediate results, namely the equivalence extension property (Section \ref{sec:EEP}), a universal fibration (Section \ref{sec:U}), and the Frobenius condition (Section \ref{sec:Frobenius}), to which we now turn.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% maybe use this for something else, but it is not needed here
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section{Composition}\label{sec:composition}
%
%A novelty of the type-theoretic notion of fibration is the method (due to Coquand and first introduced in \cite{CCHM}) of reducing the (type-theoretically specified) notion of \emph{fibration structure} to the apparently weaker notion of a \emph{composition structure}.  Composition structure is more easily shown to be preserved by the type-forming operations like $\Sigma$ and $\Pi$, when these concepts are formulated in type theory, as is done in \cite{CCHM}, or in the internal lanuage of the ambient presheaf topos, as in \cite{OP}.  This is due to the fact that one can then efficiently calculate using the rules of type theory (and even in a proof assistant), making it possible to prove e.g.\  that the fibrations are closed under $\Pi$-types.  The approach taken here is a reformulation into diagrammatic language of those type-theoretic calculations.
%
%\subsection{Composition for an object}
%
%Let $p : 1 \ra \I$ be any point of the interval (e.g.\ $\delta_0$), and $\epsilon_p := X^p : X^\I \ra X$ the corresponding ``evaluation at $p$'' map.  Given another point $q : 1 \ra \I$, there is an evident factorization 
%\[
%\epsilon_p = \pi_1 \circ \langle \epsilon_p, \epsilon_q\rangle : X^\I \ra X\times X \ra X.
%\]
%We will say that the object $X$ \emph{has composition (from $p$ to $q$)} if for every object $Z$ and cofibration $c:C\mono Z$ and commutative square 
%\begin{equation}\label{diagram:composition1}
%\xymatrix{
%C \ar@{>->}[d]_{c} \ar[r]  & X^\I \ar[d]^{\epsilon_p} \\
%Z \ar[r] & X,
%}
%\end{equation}
%there is an arrow $k : Z \ra X\times X$ as indicated below making both subdiagrams commute.
%\begin{equation}\label{diagram:composition2}
%\xymatrix{
%C \ar@{>->}[dd]_{c} \ar[r]  & X^\I \ar[d]^{\langle \epsilon_p, \epsilon_q\rangle} \\
%& X\times X \ar[d]^{\pi_1} \\
%Z \ar[r] \ar@{..>}[ru]^{k} & X,
%}
%\end{equation}
%
%If $X$ is fibrant in the \emph{biased} sense of section \ref{sec:biasedfibration}, then $X$ clearly has composition from $\delta_0$ to $\delta_1$ (and back), since the outer rectangle then has a diagonal filler (as does the corresponding one with $\pi_2$ for $\pi_1$).   In the case where the category of cubes is assumed to have connections, one can also show the converse, that having composition implies diagonal filling for all such squares \eqref{diagram:composition1}; logical proofs of this fact can be found in \cite{CCHM,OP}, and a diagrammatic proof is given in Appendix 1.
%
%If $X$ is fibrant in the \emph{unbiased} sense of section \ref{sec:unbiasedfibration}, with the generic point $\delta : 1\ra \I$ over $\I$, then $X$  will have composition over $\I$ from $\delta$ to either of $\delta_0, \delta_1$, for the same reason as before: the map $(\delta\!\Rightarrow\!X) = X^\delta : X^\I \ra X$ is a trivial fibration over $\I$, by the definition of fibrancy. In order to arrive at a property equivalent to unbiased filling, we shall use a generic form of composition from $\delta$ to a second generic point $\delta'$.  This is obtained by pulling back along the (say, second) projection $\pi : \I\times\I \ra \I$ to work in $\cSet/(\I\times\I)$, where in addition to $\delta, \delta_0, \delta_1$ we now also have a point $\delta' : 1 \ra \I$, given by the additional diagonal map over $\I\times \I$,
%\begin{equation}\label{diagram:deltaprime}
%\xymatrix{
%\I\times\I  \ar[rd]_{\mathsf{id}} \ar[rr]^{\langle \pi_1, \pi_2, \pi_1\rangle}  && \I\times\I\times\I \ar[ld]^{\langle \pi_1, \pi_2\rangle} \\
%&  \I\times\I &.
%}
%\end{equation}
%%$$\delta' :=\langle \pi_1, ..., \rangle: \I\times\I \ra \I\times\I\times\I$$ 
%
%Observe that in $\cSet/\I\times\I$ the (binary) diagonal $\Delta : \I\mono \I\times\I$ is a subobject of the terminal object $\Delta\mono 1$, with associated base change 
%\begin{equation}\label{diagram:Deltabasechange}
%\xymatrix{
%\cSet/\I\ \ar@<-1ex>[rr]_{\Delta_*}  && \ar@<-1ex>[ll]_{\Delta^*} \ \cSet/\I\times\I \,.
%}
%\end{equation}
%%
%For any object $X$ in $\cSet/\I\times\I$, let $$\eta_X : X\ra X^\Delta$$ be the unit of $\Delta^*\dashv \Delta_*$.  
%Given objects and arrows $f, g : X \rightrightarrows Y$ in $\cSet/\I\times\I$, observe that
% $\Delta^*f = \Delta^*g$ in $\cSet/\I$ if and only if the composites with $\eta_Y$ are equal,
%\begin{equation}\label{diagram:composeDelta}
%\xymatrix{
%X \ar@<-1ex>[r]_{g}  \ar@<1ex>[r]^{f} & Y \ar[r]^{\eta_Y} & Y^\Delta.
%}
%\end{equation}
%%
%Indeed, consider the double naturality square
%\begin{equation}\label{diagram:Deltanatural}
%\xymatrix{
%X \ar[d]_{\eta_X} \ar@<-.8ex>[r]_{g}  \ar@<.8ex>[r]^{f} & Y \ar[d]^{\eta_Y} \\
%X^\Delta \ar@<-.8ex>[r]_{g^\Delta}  \ar@<.8ex>[r]^{f^\Delta} & Y^\Delta.
%}
%\end{equation}
%Then $\eta_Y f = \eta_Y g$ iff $f^\Delta \eta_X= g^\Delta \eta_X : X\ra Y^\Delta$ iff $\Delta^*f = \Delta^*g : \Delta^*X \ra\Delta^*Y$, by transposition, since $Y^\Delta = \Delta_*\Delta^* Y$. 
%% (A dual condition involving the counit $X\times \Delta \ra X$ also holds.)
%
%We can now define what it means for an object $X$ to have (unbiased) composition by saying that it has composition, in the sense of \eqref{diagram:composition2}, from $\delta$ to $\delta'$ over $\I\times \I$, and that, moreover, the two resulting maps $k_1, k_2 : Z\rightrightarrows X$ are coequalized by the unit $\eta_X : X\ra X^\Delta$.  We reformulate this condition equivalently as follows (cf.\ \cite{Coquand,ABCetc.}).
%
%\begin{definition}\label{def:unbiasedcomposition}
%An object $X$ will be said to have \emph{(unbiased) composition} if it satisfies the following condition: for every cofibration $c : C \mono Z$ in $\cSet/\I$ and every commutative square in $\cSet/\I$ of the form
%\begin{equation*}\label{diagram:compdef1}
%\xymatrix{
%C \ar@{>->}[d]_{c} \ar[r]^y  & X^\I \ar[d]^{\epsilon_\delta} \\
%Z \ar[r]_x & X
%}
%\end{equation*}
%with $\epsilon_\delta := X^\delta : X^\I \ra X$ the evaluation at the generic point $\delta : 1 \ra \I$, upon pulling back along $\pi : \I\times\I \ra \I$ to $\cSet/\I\times\I$, there is a map $x' : Z \ra X$ making the following commute, 
%\begin{equation}\label{diagram:compdef2}
%\xymatrix{
%C \ar@{>->}[d]_{c} \ar[r]^y  & X^\I \ar[d]_>>>>>>>{\epsilon_\delta} \ar[r]^{\epsilon_{\delta'}} &  X \ar[d]^{\eta_X}\\
%Z  \ar@{..>}[rru]_>>>>>>>>>{x'} \ar[r]_x & X \ar[r]_{\eta_X} & X^\Delta 
%}
%\end{equation}
%where $\epsilon_{\delta'} := X^{\delta'} : X^\I \ra X$ is the evaluation at the second generic point $\delta' : 1 \ra \I$.
%
%\end{definition}
%
%\begin{proposition}\label{prop:comptofillobj}
%Composition implies filling; that is, every cubical set $X$ with composition is fibrant.
%\end{proposition}
%
%\begin{proof}
%Let $X$ be a cubical set with composition, and suppose given a filling problem in $\cSet/\I$  of the form
%\begin{equation}\label{diagram:compimpfill}
%\xymatrix{
%C \ar@{>->}[d]_{c} \ar[r]^y  & X^\I \ar[d]^{\epsilon_\delta} \\
%Z \ar[r]_x & X.
%}
%\end{equation}
%Pulling back to $\cSet/(\I\times\I)$ (but omitting the $\pi^*$ everywhere), since $X$ has composition there is a map $x' : Z \ra X$ making the following commute, 
%\begin{equation}\label{diagram:compimpfill2}
%\xymatrix{
%C \ar@{>->}[d]_{c} \ar[r]^y  & X^\I \ar[d]_>>>>>>>{\epsilon_\delta} \ar[r]^{\epsilon_{\delta'}} 
%	&  X \ar[d]^{\eta_X}\\
%Z  \ar@{..>}[rru]_>>>>>>>>>{x'} \ar[r]_x & X \ar[r]_{\eta_X} & X^\Delta \,.
%}
%\end{equation}
%%where $\epsilon_{\delta'} := X^{\delta'} : X^\I \ra X$ is the evaluation at the second generic point $\delta' : 1 \ra \I$.
%%
%Transposing by the adjunction $\pi^* \dashv {\pi}_*$ results in a commutative diagram in $\cSet/\I$ of the form
%\begin{equation}\label{diagram:compimpfill3}
%\xymatrix{
%C \ar@{>->}[d]_{c} \ar[r]^y  & X^\I \ar[d]_>>>>>>>{\epsilon_\delta} \ar[r]^{\widetilde{\epsilon_{\delta'}}} 
%	&  \pi_*\pi^*X \ar[d]^{\pi_*\eta_X} \\
%Z \ar[r]_x \ar@{..>}[rru]_>>>>>>>>>{\widetilde{x'}} & X\ar[r]_-{\widetilde{\eta_X}} & \pi_*X^\Delta,
%}
%\end{equation}
%where $\widetilde{\epsilon_{\delta'}} : X^\I \ra \pi_*\pi^*X$ is the adjoint transpose of $\epsilon_{\delta'}$, and similarly for $\widetilde{x'}$ and $\widetilde{\eta_X}$.  To compute these transpositions, we factor them through the unit maps $\eta^\pi$ of the adjunction $\pi^* \dashv {\pi}_*$,
%\begin{equation}\label{diagram:compimpfill4}
%\xymatrix{
%C \ar@{>->}[d]_{c} \ar[r]^y  & X^\I \ar[d]^{\epsilon_\delta} \ar[r]^{\eta^{\pi}_{X^\I}} 
%	&  (X^\I)^\I  \ar[d]^{(\epsilon_\delta)^\I} \ar[r]^{\pi_*{\epsilon_{\delta'}}}  &  \pi_*\pi^*X   \ar[d]^{\pi_*\eta_X} \\
%Z \ar[r]_x \ar@{..>}[rrru]^{\widetilde{x'}} & X \ar[r]_{\eta^\pi_X} 
%	& X^\I \ar[r]_-{\pi_*\eta_X} & \pi_*X^\Delta.
%}
%\end{equation}
%%
%Next, observe that $\pi_*\pi^*X = X^\I$ and, up to the iso $(X^\I)^\I \cong X^{\I\times\I}$, the map $\pi_*{\epsilon_{\delta'}}$ is
%\[
%\pi_*{\epsilon_{\delta'}} = X^{(\Delta: \I \mono \I\times\I)} : X^{\I\times\I} \ra X^\I\,,
%\]
%which we write as $\Delta^* : X^{\I\times\I} \ra X^\I$ to avoid confusion with the exponential object $X^\Delta$.
%The map $\Delta^* $ is plainly a retraction of 
%\[
%\eta^{\pi}_{X^\I} = X^{(\pi: \I\times\I\ra \I)}: X^\I \ra (X^\I)^\I \cong X^{\I\times\I}\,.
%\]
%The last diagram \eqref{diagram:compimpfill4} now becomes
%\begin{equation}\label{diagram:compimpfill5}
%\xymatrix{
%C \ar@{>->}[d]_{c} \ar[r]^y  & X^\I \ar[d]^{\epsilon_\delta} \ar[rr]^{\eta^{\pi}_{X^\I}}  \ar@/^5ex/ [rrr] ^{=}
%	&&  X^{\I\times\I}  \ar[d]^{(\epsilon_\delta)^\I} \ar[r]^{\Delta^*}  &  X^\I   \ar[d]^{\pi_*\eta_X} \\
%Z \ar[r]_x \ar@{..>}[rrrru]^{\widetilde{x'}} & X \ar[rr]_{\eta^\pi_X} 
%	&& X^\I \ar[r]_-{\pi_*\eta_X} & \pi_*X^\Delta.
%}
%\end{equation}
%Finally, we claim that $\pi_*X^\Delta \cong X$, and that, up to this iso,  $$\pi_*\eta_X = \epsilon_\delta : X^\I\ra X,$$ which will finish the proof, since this is a retraction of $\eta^\pi_X : X\ra X^\I$.  Indeed, writing out the object $\pi_*X^\Delta$ explicitly, in terms of the two adjunctions $\pi^* \dashv {\pi}_*$ and $\Delta^* \dashv \Delta_*$, we have
%\[
%\pi_*X^\Delta = \pi_*\Delta_*\Delta^*\pi^*X \cong (\pi\circ\Delta)_*(\pi\circ\Delta)^*X \cong X,
%\]
%since $(\pi\circ\Delta) = 1$.  
%
%To see that $\pi_*\eta_X = \epsilon_\delta$, first let us make the base change $$\I^* : \cSet \ra \cSet/\I$$ explicit, so that $\epsilon_\delta$ is the counit of the adjunction $\I^* \dashv \I_*$ at $\I^*X$,
%\[
%\epsilon_\delta = \epsilon_{(\I^*X)} : X^\I \times \I \ra X\times \I \quad\text{(over $\I$)}.
%\]  
%By a triangle law, this map has the inverse $\I^*(\eta_{X}^\I) : X\times\I \ra X^\I \times \I$, where $$\eta_X^\I : X \ra X^\I$$ is the unit of $\I^*\dashv \I_*$ at $X$.  It suffices to show that $\I^*(\eta_{X}^\I)$ is also an inverse for $\pi_*\eta_X$ which, more explicitly is:
%\[
%\pi_*\eta_X = \pi_*(\eta^\Delta_{\pi^*(\I^*X)}),
%\]
%where $\eta^\Delta$ is the unit of $\Delta^* \dashv \Delta_*$. Since $\I^*$ preserves exponentials, we have
%\[
%\I^*(\eta_{X}^\I) = \eta_{(\I^*X)}^\pi : \I^*X \ra (\I^*X)^{\I^*\I} \cong \pi_*\pi^*(\I^*X)\quad\text{(over $\I$)}.
%\]
%Now, for the composition of the $\pi^* \dashv {\pi}_*$ and $\Delta^* \dashv \Delta_*$ adjunctions, 
%
%\begin{equation}\label{diagram:Deltapibasechange}
%\xymatrix{
%\cSet/\I\ \ar@<-1ex>[rr]_-{\Delta_*}  && \ar@<-1ex>[ll]_-{\Delta^*} \ \cSet/\I\times\I \ \ar@<-1ex>[rr]_-{\pi_*}  
%	&& \ar@<-1ex>[ll]_-{\pi^*} \ \cSet/\I 
%}
%\end{equation}
%the units $\eta^\pi$ and $\eta^\Delta$ satisfy the well-known law
%\[
%\eta^{\pi\circ\Delta} = \pi_*(\eta^{\Delta}_{\pi^*}) \circ (\eta^\pi)\,.
%\]
%But $\eta^{\pi\circ\Delta} = \mathsf{id}$, since $\pi\circ\Delta =1$.  We therefore have 
%\[
%\pi_*(\eta^\Delta_{\pi^*(\I^*X)}) \circ \eta_{(\I^*X)}^\pi = \eta^{(\pi\circ\Delta)}_{(\I^*X)} = \mathsf{id}_{(\I^*X)},
%\]
%as required.
%\end{proof}
%
%%the maps $X^\delta : X^\I \ra X$ and $(X^\I)^\delta : (X^{\I})^{\I} \ra X^\I$ make the following commute, and indeed make $\epsilon_\delta$ a retract of $\pi_1\circ\pi_*\langle \epsilon_\delta, \epsilon_{\delta'}\rangle$ in the arrow category of $\cSet/\I$.
%%\begin{equation}\label{diagram:compimpfill4}
%%\xymatrix{
%%X^\I \ar[dd]_{\epsilon_\delta} \ar[r]^{\rho_{X^\I}} 
%%	& (X^{\I})^{\I} \ar[d]^{\pi_*\langle \epsilon_\delta, \epsilon_{\delta'}\rangle} \ar[r]^{(X^\I)^\delta} & X^\I \ar[dd]^{\epsilon_\delta}  \\
%% & (X\times X)^\I \ar[d]^{\pi_1^\I} & \\
%%X\ar[r]_{\rho_X} & X^I \ar[r]_{X^\delta} & X,
%%}
%%\end{equation}
%%To see that this commutes, note that the middle vertical composite is known to be $(\epsilon_\delta)^\I$ by construction.
%%
%%Finally, we claim that there is a map $\gamma: (X\times X)^\I \ra X^\I$ making the following commute.
%%\begin{equation}\label{diagram:compimpfill5}
%%\xymatrix{
%%X^\I \ar[dd]_{\epsilon_\delta} \ar[r]^{\rho_{X^\I}} 
%%	& (X^{\I})^{\I} \ar[d]_{\pi_*\langle \epsilon_\delta, \epsilon_{\delta'}\rangle} \ar[r]^{(X^\I)^\delta} & X^\I \ar[dd]^{\epsilon_\delta}  \\
%% & (X\times X)^\I \ar[d]_{\pi_1^\I} \ar@{..>}[ru]_{\gamma} & \\
%%X\ar[r]_{\rho_X} & X^I \ar[r]_{X^{\delta}} & X,
%%}
%%\end{equation}
%%Indeed, up to isomorphism, the right hand part of this last diagram is:
%%\begin{equation}\label{diagram:compimpfill6}% _{ X^{ (\delta_{\I} ) } } % ^{ X^{ (\I_{\delta}) } } 
%%\xymatrix{
%%X^{\I\times\I} \ar[rd]^{X^\phi}\ar[dd]_{X^{(\delta_{\I})}}  \ar[rr]^{X^{(\I_{\delta})}} 
%% && X^\I \ar[dd]^{X^\delta}  \\
%%& X^{\I+\I} \ar[ld]_{X^L} \ar@{..>}[ru]_{\gamma} & \\
%%X^\I \ar[rr]_{X^{\delta}} && X,
%%}
%%\end{equation}
%%in which all maps are of the form $X^{(-)}$, and are induced by the following,
%%\begin{equation}\label{diagram:compimpfill7}
%%\xymatrix{
%%\I\times\I  && \I \ar[ll]_{\I_\delta}  \ar@{..>}[ld]^{G} \\
%% 	& \ar[lu]_{\phi} \I+\I & \\
%%\I \ar[uu]^{\delta_\I}  \ar[ru]_{L} && \ar[ll]^{\delta}  \ar[uu]_{\delta}  1.
%%}
%%\end{equation}
%%in which:
%%\begin{align*}
%%\I_\delta &:= \langle \delta!, 1_\I\rangle \\
%%\delta_\I &:= \langle 1_\I,\delta!\rangle \\
%%\phi &:= [\delta_\I, \I_\delta]\\
%%L &:= \text{the left coproduct inclusion.}
%%\end{align*}
%%For $G : \I\ra \I+\I$ we can therefore also take the right coproduct inclusion $R$ to make everything commute .... .  
%%
%%XXXXX Need to add the side condition on the composition when the two points are the same.
%%We then let $\gamma := X^R$ to complete the proof.
%
%\subsection{Composition for a map}
%We next generalize the notion of compostion for an object $X$ to composition for a map $f : Y\ra X$.  First consider biased fibrations in the sense of section \ref{sec:biasedfibration}; recall from Corollary \ref{cor:fibstrequivplustr} that a (biased) fibration structure on a map $f :Y\ra X$ is the same thing as a pair of $+$-algebra structures on the maps
%\[
%(\delta_\epsilon\Rightarrow\!{f}) : Y^\I \ra X^\I \times_{X} Y
%\]
%for $\epsilon = 0,1$.  The construction of $\delta_0\Rightarrow\!{f}$ is recalled from \eqref{diagram:pullbackhom} in the pullback diagram below, in which $X^{\delta_0}:X^\I \ra X$ is the evaluation map at $\delta_0 : 1\ra \I$.
%\begin{equation}\label{diagram:pullbackhomreview}
%\xymatrix{
%Y^\I \ar@/_4ex/ [rdd]_{f^\I} \ar[rd]^{\delta_0\Rightarrow{f}} \ar@/^4ex/ [rrd]^{Y^{\delta_0}} && \\
%& X^\I \times_{X} Y \ar[d] \ar[r] & Y \ar[d]^{f} \\
%& X^\I \ar[r]_{X^{\delta_0}} &  X
%}
%\end{equation}
%%
%Given another point $\delta_1 : 1\ra \I$, we have an analogous construction
%\begin{equation}\label{diagram:pullbackhomreviewprime}
%\xymatrix{
%Y^\I \ar@/_4ex/ [rdd]_{f^\I} \ar[rd]^{\delta_1\Rightarrow{f}} \ar@/^4ex/ [rrd]^{Y^{\delta_1}}  && \\
%& X^\I \times_{X} Y \ar[d] \ar[r] & Y \ar[d]^{f} \\
%& X^\I \ar[r]_{X^{\delta_1}} &  X.
%}
%\end{equation}
%But note that now the pullback object $X^\I \times_{X} Y $ is a different one, with fiber over $p : \I \ra X$ being the fiber of $f$ over $p\delta_1$ rather than over $p\delta_0$.  Let us call these two different pulled-back maps $f_0:Y_0\ra X^\I$ and $f_1:Y_1 \ra X^\I$ and write $f^\epsilon := (\delta_\epsilon\Rightarrow{f})$ for $\epsilon = 0,1$.  There is then a commutative diagram,
%%
%\begin{equation}\label{diagram:composition3}
%\xymatrix{
%Y^\I \ar[d]_{f^0} \ar[rd]|{f^\I} \ar[r]^{f^1} & Y_1 \ar[d]^{f_1}\\
%Y_0 \ar[r]_{f_0} & X^\I\,,
%}
%\end{equation}
%%
%We will say that $f:Y\ra X$ \emph{has composition from 0 to 1} if for every cofibration $c : C\mono Z$ and maps $y_0 : Z\ra Y_0$ and $y : C\ra Y^\I$ making the square on the left below commute, there is a map $y_1 : Z\ra Y_1$ making the following commute.
%\begin{equation}\label{diagram:composition4}
%\xymatrix{
%C \ar@{>->}[d]_{c} \ar[r]^{y} & Y^\I \ar[d]_>>>>>>>{f^0} \ar[r]^{f^1} & Y_1 \ar[d]^{f_1}\\
%Z \ar@{..>}[rru]_>>>>>>{y_1} \ar[r]_{y_0} & Y_0 \ar[r]_{f_0} & X^\I
%}
%\end{equation}
%
%To define \emph{unbiased} composition, we begin with $f : Y\ra X$ in $\cSet$ and then move to $\cSet/\I$, where we have the generic point $\delta : 1\ra\I$.  Now we consider an arbitrary cofibration $c : C\mono Z$ and maps $y_\delta : Z\ra Y_\delta$ and $y : C\ra Y^\I$ making the square below commute
%\begin{equation}\label{diagram:composition3}
%\xymatrix{
%C \ar@{>->}[d]_{c} \ar[r]^{y} & Y^\I \ar[d]^{f^\delta} \\
%Z \ar[r]_{y_\delta} & Y_\delta 
%}
%\end{equation}
%where $Y_\delta$ and $f^\delta$ are defined in terms of $\delta : 1\ra \I$ just as were $Y_0$ and $f^0$ in terms of $\delta_0 : 1\ra \I$.  Passing to $\cSet/(\I\times \I)$ by a further pullback, as before we have another point $\delta':1\ra\I$, as well as a subobject $\Delta \mono 1$, determined by the further diagonals.
%
%\begin{definition}
%The map $f:Y\ra X$ \emph{has (unbiased) composition} if, in $\cSet/\I$, for any cofibration $c : C\mono Z$ and maps $y_\delta : Z\ra Y_\delta$ and $y : C\ra Y^\I$ as on the left below, there is in $\cSet/(\I\times \I)$ a map $y_{\delta'} : Z\ra Y_{\delta'}$ making the following commute
%\begin{equation}\label{diagram:composition4}
%\xymatrix{
%C \ar@{>->}[d]_{c} \ar[r]^{y} & Y^\I \ar[d]_>>>>>>>{f^\delta} \ar[r]^{f^{\delta'}} & Y_{\delta'} \ar[d]^{\eta_{Y_{\delta'}}}\\
%Z \ar@{..>}[rru]_>>>>>>{y_{\delta'}} \ar[r]_{y_\delta} & Y_\delta \ar[r]_{\eta_{Y_\delta}} & Y^\Delta\,,
%}
%\end{equation}
%where $Y_{\delta'}$ and $f^{\delta'}$ are defined in terms of $\delta' : 1\ra \I$, and $Y^\Delta$ is $Y_\delta^\Delta = Y_{\delta'}^\Delta$, since $\Delta^*{\delta} = \Delta^*{\delta'}$.
%\end{definition}
%
%
%\begin{proposition}\label{prop:comptofillmap}
%Composition implies filling for maps; that is, every $f : Y\ra X$ with composition is a fibration.
%\end{proposition}
%
%\begin{proof}
%Analogous to the proof of Proposition \ref{prop:comptofillobj}.
%\end{proof}
%
%\begin{remark}
%One can also promote the \emph{property} of an object or map of ``having composition'' to the notion of a \emph{composition structure}.  This procedes via the notion of a \emph{uniform composition structure}, which is defined with respect to cofibrations $c : C\mono \I^n$ with representable codomains, and a requirement of naturality in $\I^n$, and which can then be internalized as a suitable map representing the uniform structure, in a way that is analogous to the case for trivial fibrations formulated in proposition \ref{prop:uniformstructequivrelative}.
%\end{remark}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The Frobenius condition}\label{sec:Frobenius}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In this section, we show that the (unbiased) fibration weak factorization system from section \ref{FWFS} satisfies what has been called the \emph{Frobenius condition}: the left maps are stable under pullback along the right maps (see \cite{vdBG}).  This will imply the \emph{right properness} of our model structure: the weak equivalences are preserved by pullback along fibrations.  In our setting, it then follows that the entire model structure is stable under such a base change.  The Frobenius condition will be used in the proof of the equivalence extension property in Section \ref{sec:EEP}.  

An ``algebraic'' proof of Frobenius in the related setting of cubical sets \emph{with connections} was given in \cite{GS} using conventional, functorial methods.  By contrast, the type theoretic approach of \cite{CCHM} provides a proof that is much more direct, and can also be modified to work without connections (as in \cite{AXYZ}).  That approach proves the dual fact that the \emph{pushforward} operation, which is right adjoint to pullback and always exists in a topos, preserves fibrations when applied along a fibration.  This corresponds to the type-theoretic $\Pi$-formation rule, and the proof given in \opcit\ is entirely in type theory.  It also employs a reduction of box filling (in all dimensions) to an apparently weaker condition of \emph{Kan composition} (in all dimensions), which merely ``puts a lid on" the open box, rather than filling it.  This aspect of the type theoretic proof can also be described algebraically, but is not used in the proof given here, and will therefore not be discussed further (see \cite{LOPS} for an algebraic description of Kan composition with connections, and \cite{A:composition,filling,Frobenius,etc} for the same without connections).

This section applies the same strategy as that used in defining the unbiased fibrations, namely we first establish something in the \emph{biased but generic} setting, and then transfer it to the unbiased setting by pulling back along the base change $\cSet\to\cSet/_\I$.  In order to emphasize this approach, we give the second step first, in the form of a conditional statement.

\begin{proposition}\label{prop:biasedFrobimpliesunbiasedFrob}
Suppose the $\delta$-biased fibrations in $\cSet/_\I$ satisfy the Frobenius condition. Then the unbiased fibrations in $\cSet$ also satisfy the Frobenius condition.
\end{proposition}

\begin{proof}
This follows almost immeditely from the fact that the pullback functor $\I^* : \cSet \to \cSet/_\I$ preserves the locally cartesian closed structure, takes unbiased fibrations to $\delta$-biased ones, and reflects $\delta$-biased fibrations to unbiased ones.  In detail, let unbiased fibrations $B \fib A$ and $A \fib X$ in $\cSet$ be given, and we wish to find $C\fib X$ and $e : A\times_X C \to B$ over $A$, universal in the way recalled in the diagram below.
\begin{equation}\label{diagram:biasedFrobenius2unbiasedFrobenius}
\begin{tikzcd}
%\widehat{\bbC}/_X  \ar[d,swap,"{{X_!}}"] \ar[r, "{\sim}"] 
%	& \widehat{\textstyle \int_{\bbC}X} \ar[d,swap,"{{(p_X)_!}}"] \ar[r, "{\sim}"] 
%		& \mathsf{dFib}/_{\int_{\bbC}X} \ar[d,"p_X\circ(-)"]  \\
% \widehat{\bbC}  \ar[r,swap, "{\sim}"]   & \widehat{\bbC}  \ar[r,swap, "{\sim}"] 
%	&  \mathsf{dFib}/_{\bbC}.
A \times_X C \ar[d, dotted, "e"] \ar[r, dotted] & C \ar[dd, two heads, dotted]\\
B \ar[d, two heads] &   \\
A \ar[r, two heads]  & X 
\end{tikzcd}
\end{equation}
%
Take the pushforward $C := A_*B \to X$, and its associated map $e : A\times_X C \to B$, in the locally cartesian closed category $\cSet$.  Since fibrations are stable under (all) pullbacks, %(and since the subcategory of fibrations over a fixed base is by definition full in the slice category), 
it then suffices to show that $C\to X$ is a fibration.  

By definition, $C\to X$ is an unbiased fibration in $\cSet$ just in case the base change $\I^*C \to \I^*X$ is a $\delta$-biased fibration in the slice category $\cSet/_\I$.  Since the pullback functor $\I^* : \cSet \to \cSet/_\I$ preserves all lcc structure, over $\I^*X$ we have an iso,
\[
\I^*C = \I^*(A_*B) \cong (\I^*A)_*\I^*B\,,
\]
where the pushforward $(\I^*A)_*\I^*B$ is taken in the topos $\cSet/_\I$.  But $\I^*B \to \I^*A$ and $\I^*A \to \I^*X$ are $\delta$-biased fibrations in $\cSet/_\I$ because $B \to A$ and $A \to X$ were assumed to be unbiased fibrations in $\cSet$.  Since we are assuming the Frobenius condition for $\delta$-biased fibrations in $\cSet/_\I$, the pushforward $\I^*C \cong (\I^*A)_*\I^*B \to \I^*X$ is also a $\delta$-biased fibration, as required.
\end{proof}
  
%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Frobenius for biased fibrations.}

The results proved in this section will be applied to the slice category $\cSet/_\I$ and the generic point $\delta : 1 \ra \I = \I^*\I$, but nothing depends on this particular case, and so we shall write simply $\delta : 1\to \I$ for a chosen pointed object in an arbitrary topos $\EE$.  (Indeed, in this section $\EE$ may even be taken to be just a locally cartesian closed category with a representable class of cofibrations.)

Recall from Definition \ref{def:unbiasedfibration} that a map $f:A\ra X$  is a $\delta$-biased fibration just if the map $\delta \Rightarrow f$ admits a relative +-algebra structure, and is therefore a trivial fibration.  The definition of the pullback-hom $\pbh{\delta}{f}$ is recalled below.
\begin{equation}\label{diagram:frobenius1}
\xymatrix{
A^\I \ar@/_3ex/ [rdd]_{f^\I} \ar@{.>}[rd]^{\delta\Rightarrow{f}} \ar@/^3ex/ [rrd]^{A^{\delta}}  && \\
& X^\I \times_{X} A \ar[d] \ar[r] & A \ar[d]^{f} \\
& X^\I \ar[r]_{X^{\delta}} &  X
}
\end{equation}
Let us write this condition schematically as follows:
\begin{equation}\label{diagram:frobenius1}
\xymatrix{
A^\I \ar[r]|| \ar[r]  & A_\epsilon\ar[d] \pbcorner \ar[r] & A \ar[d]^f \\
& X^\I \ar[r]_{\epsilon} &  X
}
\end{equation}
where $\epsilon = X^{\delta}$ and $A_\epsilon = X^\I \times_{X} A$, and the struck-through arrow indicates that it admits a +-algebra structure.

\begin{lemma}\label{lemma:fibrationspullback}
Let  $A \ra X$ be a $\delta$-biased fibration and $t: Y\ra X$ any map, then the pullback $t^*A \ra Y$ is also a $\delta$-biased  fibration.
\end{lemma}
\begin{proof}
This is clear from the fact that the $\delta$-biased fibrations can be made into the right class of a weak factorization system (by reasoning analogous to that for Proposition \ref{prop:fibrationwfs}), but it will be useful to see how the structure indicated in \eqref{diagram:frobenius1} is itself stable under pullback.  Indeed, consider the following commutative diagram, in which the front face of the cube is the pullback in question, and the right and left sides are the respective versions of the construction in \eqref{diagram:frobenius1}.
%
\begin{equation}\label{diagram:fibrationspullback}
\xymatrix{
 (t^*A)^\I \ar[rr] \ar[d] && A^\I \ar[d] & \\
  (t^*A)_\epsilon \ar[dd] \ar[rd] \ar@{.>}[rr] && A_\epsilon \ar[dd] \ar[rd] & \\
  & t^*A \ar[rr] \ar[dd]  && A \ar[dd]  \\
Y^\I \ar[rd]_\epsilon \ar[rr] & &  X^\I \ar[rd]_\epsilon & \\
 & Y \ar[rr]_t && X 
 }
\end{equation}
%
The rear square of solid arrows is the image of the front face under the pathobject functor and is therefore also a pullback. The base commutes by the naturality of the maps $\epsilon$, as does a corresponding top square involving further such $\epsilon$'s not shown.  Note that these naturality squares need not be pullbacks, but the vertical squares on the sides are, by construction.  It follows that there is a dotted arrow as shown, making the resulting lower rear square commute.  That lower square is then also a pullback, since the other vertical faces of the resulting cube are pullbacks, and thus finally, the upper rear square is also a pullback.  

Now if $A\to X$ is a $\delta$-biased fibration, then $A^\I \to A_\epsilon$ is a trivial fibration, and then so is its pullback $(t^*A)^\I \to (t^*A)_\epsilon$ since relative $+$-algebras are stable under pullback.  Therefore the pullback $t^*A\to Y$ is also a $\delta$-biased fibration.
\end{proof}

\begin{remark}
In this way we can show algebraically that the pullback of a $\delta$-biased fibration is again one by pulling back the structure that makes it so.  In Section \ref{sec:universalfibration}, the pullback stability of the fibration structure will be used in the construction of a universal fibration via a closely related argument.
\end{remark}

\begin{lemma}\label{lemma:fibrationscompose}
Let  $\alpha : A \ra X$ and $\beta: B\ra A$ be $\delta$-biased fibrations, then the composite $\alpha\circ\beta : B \ra X$ is also a $\delta$-biased fibration.
\end{lemma}
\begin{proof}
Again for maps in the right class of a weak factorization system this is immediate.  But let us see how the fibration structures also compose.  We have the following diagram for the fibration structures on $B\ra A$ and $A\ra X$ (with obvious notation).
\begin{equation}\label{diagram:fibcomposition1}
%\xymatrix{
%B^\I \ar[r]|+  & B_{\epsilon_A} \ar[r]  \ar[d] \pbcorner & B'  \ar[d] \pbcorner \ar[r] & B \ar[d]\\
%&A^\I \ar[r]|+ & A_{\epsilon} \ar[d] \pbcorner \ar[r] & A \ar[d]\\
%&& X^\I \ar[r]_{\epsilon} &  X,
%}
%\end{equation}
\xymatrix{
B^\I \ar[r]|| \ar[r]  & B_{\epsilon_A} \ar[rr]  \ar[d] \pbcorner & & B \ar[d]\\
&A^\I \ar[r]|| \ar[r] & A_{\epsilon_X} \ar[d] \pbcorner \ar[r] & A \ar[d]\\
&& X^\I \ar[r]_{\epsilon_X} &  X,
}
\end{equation}
Pulling back $B\ra A$ in two steps we therefore obtain the intermediate map $B_{\epsilon_X} \to A_{\epsilon_X}$  indicated in the following diagram. 
\begin{equation}\label{diagram:fibcomposition2}
\xymatrix{
B^\I \ar[r]|| \ar[r]   & B_{\epsilon_A} \ar[r]  \ar[d] \pbcorner & B_{\epsilon_X}  \ar[d] \pbcorner \ar[r] & B \ar[d]\\
&A^\I \ar[r]|| \ar[r]  & A_{\epsilon_X} \ar[d] \pbcorner \ar[r] & A \ar[d]\\
&& X^\I \ar[r]_{\epsilon_X} &  X
}
\end{equation}
Now use the fact that a trivial fibration structure (\ie\ a +-algebra structure) has a canonical pullback along any map, and that two such structures have a canonical composition (cf.\ Remark \ref{trivfibpushforward}), to obtain a trivial fibration structure for the indicated composite map $B^\I \ra B_{\epsilon_X}$, which is then a fibration structure for the composite $B\to A\to X$.
\end{proof}

%\begin{remark}
%In terms of semantics of (dependent) type theory, we have just shown that the +-algebras form a category of display maps, or \emph{clan} (see \cite{J}): a family of maps that are closed under isos and composition and stable under pullbacks along all maps.   The following adds closure under pushforwards, giving a ``$\Pi$-clan''.  Note that the subcategory consisting of all such maps between those objects $A$ for which $A\to 1$ is also a +-algebra is then locally cartesian closed.
%\end{remark}


%\begin{lemma}\label{lemma:pluspushforward}
%+-algebras push forward.
%\end{lemma}
%\begin{proof}
%This is Corollary \ref{cor:plusalgpushforward}. 
%\end{proof}

\begin{proposition}[Biased Frobenius]\label{prop:Frobenius}
If $\alpha : A \ra X$ and $\beta: B\ra A$  are $\delta$-biased fibrations, then the pushforward $\alpha_*\beta : \Pi_AB \ra X$ is also a $\delta$-biased fibration.
\end{proposition}

\begin{proof}
Given $\delta$-biased fibrations $\alpha : A \ra X$ and $\beta: B\ra A$, let $a : A^\I \ra A_\epsilon$ and $b : B^\I \ra a^*B_\epsilon$ be the associated trivial fibrations, so that we have the situation of diagram \eqref{diagram:fibcomposition2}, with all three squares pullbacks.
\begin{equation}\label{diagram:frobenius1.5}
\xymatrix{
B^\I \ar[r]|| \ar[r]^{b} \ar[rd]_{\beta^\I}  & a^*B_\epsilon \ar[r]  \ar[d]  & B_{\epsilon}  \ar[d]   \ar[r] & B \ar[d]^\beta \\
&A^\I \ar[r]|| \ar[r]^{a} \ar[rd]_{\alpha^\I}  & A_{\epsilon} \ar[d]   \ar[r] & A \ar[d]^\alpha \\
&& X^\I \ar[r]_{\epsilon} &  X.
}
\end{equation}
Taking the pushforward of the righthand vertical column give a map, 
\[
\gamma:= \alpha_*\beta : \Pi_A{B} \to X\,,
\]
and placing it underneath, along with the corresponding construction from \eqref{diagram:frobenius1}, we then have the following commutative diagram.
 \begin{equation}\label{diagram:frobenius2}
\xymatrix{
B^\I \ar[r]|| \ar[r]^{b} \ar[rd]_{\beta^\I}  & a^*B_\epsilon \ar[r]  \ar[d]  & B_{\epsilon}  \ar[d]   \ar[r] & B \ar[d]^\beta \\
& A^\I \ar[r]|| \ar[r]^{a} \ar[rd]_{\alpha^\I}  & A_{\epsilon} \ar[d]   \ar[r] & A \ar[d]^\alpha \\
&& X^\I \ar[r]_{\epsilon} &  X \\
& (\Pi_AB)^\I  \ar[r]_c  \ar[ru]^{\gamma^\I} & (\Pi_AB)_\epsilon  \ar[u] \ar[r] & \Pi_AB \ar[u]_\gamma 
}
\end{equation}
We wish to show that the indicated  map $c : (\Pi_AB)^\I \ra (\Pi_AB)_\epsilon$
admits a +-algebra structure. This we will do by showing that it is a retract of a known +-algebra.
Namely, we can apply the pushforward along the map $\alpha^\I:A^\I \ra X^\I$ to the +-algebra $b : B^\I \ra a^*B_\epsilon$ regarded as an arrow over $A^\I$.  We obtain an arrow over $X^\I$ of the form
\begin{equation}\label{plusalgretract}
\Pi_{A^\I}\,b :  \Pi_{A^\I}\,B^\I \too \Pi_{A^\I}\,a^*B_\epsilon 
\end{equation}
which is indeed a +-algebra, since these are preserved under pushing forward, by Remark \ref{trivfibpushforward}.

Next, observe that by the Beck-Chevalley condition for the central pullback, for the codomain of $c$ we have an isomorphism
\[
(\Pi_AB )_\epsilon\ \cong\ \Pi_{A_\epsilon} B_\epsilon \qquad \text{over $X^\I$.}
\]
And since $\Pi_{A^\I} \cong \Pi_{A_\epsilon} \circ a_*$, for the codomain of our $+$-algebra $\Pi_{A^\I}\,b$ from \eqref{plusalgretract} we also have
\[
 \Pi_{A^\I}\,a^*B_\epsilon\ \cong\ \Pi_{A_\epsilon} a_*a^* B_\epsilon \,.
\]
Thus the image of the unit $\eta : B_\epsilon \ra a_*a^* B_\epsilon$ under $\Pi_{A_\epsilon}$ provides a map 
$\sigma := \Pi_{A_\epsilon}\eta$ over $X^\I$ of the form:
\begin{equation}\label{diagram:frobenius3}
\xymatrix{
& X^\I  \\
 (\Pi_AB)^\I  \ar[r]_c   \ar[ru] & \Pi_{A_\epsilon}B_\epsilon  \ar[u] \ar[d]^{\sigma}\\
 \Pi_{A^\I}B^\I \ar[r]_-{\Pi_{A^\I}\,b} & \Pi_{A_\epsilon} a_*a^* B_\epsilon
}
\end{equation}
Our goal is now to determine further arrows $\varphi, \psi,\tau$ as indicated below, exhibiting $c$ as a retract of $\Pi_{A^\I}\,b$ in the arrow category over $X^\I$.
\begin{equation}\label{diagram:frobenius4}
\xymatrix{
& X^\I  \\
 (\Pi_AB)^\I  \ar[r]_c  \ar[ru] \ar@{..>}[d]_\varphi & \Pi_{A_\epsilon}B_\epsilon  \ar[u] \ar[d]^{\sigma}\\
 \Pi_{A^\I}B^\I \ar[r]_-{\Pi_{A^\I}\,b} \ar@{..>}[d]_\psi & \Pi_{A_\epsilon} a_*a^* B_\epsilon \ar@{..>}[d]^\tau\\
  (\Pi_AB)^\I  \ar[r]_c  & \Pi_{A_\epsilon}B_\epsilon
}
\end{equation}

\smallskip

\noindent $\bullet$ For $\varphi$, we require a map 
\[
\varphi : (\Pi_AB)^\I \ra \Pi_{A^\I}B^\I \qquad \text{over $X^\I$.}
\]
%To that end, we take an arbitrary $Z \ra X^\I$ and associate to any map 
%\[
%Z \ra (\Pi_AB)^\I \qquad \text{over $X^\I$}
%\]
%another map 
%\[
%Z \ra \Pi_{A^\I}B^\I \qquad \text{over $X^\I$}
%\]
%in a way that is natural in the object $Z \ra X^\I$.  

Consider the following diagram, which is based on \eqref{diagram:frobenius2}.
\begin{equation}\label{diagram:frobenius7}
\xymatrix{
B^\I \ar[r]|| \ar[r]_{b} \ar[rd]_{\beta^\I}  & a^*B_\epsilon \ar[r]  \ar[d]  & B_{\epsilon}  \ar[d]   \ar[r] & B \ar[d]^\beta & \\
& A^\I \ar[r]|| \ar[r]_{a}  \ar[rd]_{\alpha^\I}  & A_{\epsilon} \ar[d]   \ar[r] & A \ar[d]^\alpha &  \ar[d] \ar[l] \ar@{..>}[lu]_{e}\Pi_AB\times_{X} A\\
 (\Pi_AB \times_{X} A)^\I \ar@{..>}[uu]^{e^\I} \ar[ru] \ar[rd] && X^\I \ar[r]_{\epsilon} &  X &   \Pi_AB \ar[l]\\
& (\Pi_AB)^\I \ar[ru] \ar@{..>}[r]_\varphi  & \Pi_{A^\I}B^\I   \ar[u] & &
}
\end{equation}
The map $e$ is the counit at $\beta: B\ra A$ of the pullback-pushforward adjunction along $\alpha: A\ra X$. The right-hand side of the diagram, including $e$ and the associated pullback square, reappears (mirrored) on the left under the functor $(-)^\I$, which preserves the pullback. Thus we can take $\varphi$ to be the transpose of $e^\I$ under the pullback-pushforward adjunction along $\alpha^\I: A^I\ra X^\I$,
\[
\varphi\, :=\, \widetilde{e^\I}\,.
\]
An easy diagram chase involving the pullback-pushforward adjunction along $A_\epsilon\ra X^\I$ shows that the upper square in \eqref{diagram:frobenius4} then commutes.

%Any map $i$ induces a unique map $ii$ by exponential transposition, which in turn determines a unique map $iii$ by the universal property of $\Pi_AB$.  We now apply $(-)^\I$ to the two righthand columns and interpolate the result on the left, using the unit $Z \ra (Z\times \I)^\I$.
%\begin{equation*}\label{diagram:frobenius8}
%\xymatrix{
%B^\I \ar[r]|| \ar[r]_{q} \ar[rd]  & p^*B_\epsilon \ar[rr]  \ar[d]  && B_{\epsilon}  \ar[d]   \ar[r] & B \ar[d]& \\
%(A\times_X (Z\times \I))^\I \ar[r] \ar[rd] \ar@{..>}[u]^{iv} & A^\I \ar[rr]|| \ar[rr]_{p}  \ar[rrd]  && A_{\epsilon} \ar[d]   \ar[r] & A \ar[d]
%	& \ar[d] \ar[l] \ar@{..>}[lu]_{iii} A\times_X (Z\times \I) \\
%Z \ar[r] \ar@{..>}[rd]_-{i} & (Z\times \I)^\I \ar[rr] \ar[d] \ar@{..>}[rrd]^<<<<<<<{v} && X^\I \ar[r]_{\epsilon} &  X & \ar[l] \ar@{..>}[d]^{ii} Z\times \I\\
%& (\Pi_AB)^\I \ar[rru] \ar@{..>}[rr]_\varphi  && \Pi_{A^\I}B^\I   \ar[u] \ar[r]  & \Pi_{A_\epsilon}B_\epsilon  \ar[lu] \ar[r] & \Pi_AB \ar[lu]
%}
%\end{equation*}
%We therefore have the map $iv = (iii)^\I$, and since $(-)^\I$ preserves pullbacks, the domain of $iv$ is
%\[
%(A\times_X (Z\times \I))^\I \cong A^\I\times_{X^\I} (Z\times \I)^\I\,.
%\]  
%Thus by the universal property of $\Pi_{A^\I}B^\I$ there is an associated map $v$, which, when precomposed with the unit $Z \ra (Z\times \I)^\I$ gives the desired map $Z \ra \Pi_{A^\I}B^\I$.
%
\smallskip

\noindent $\bullet$ For $\tau$: referring to the diagram \eqref{diagram:frobenius2}, since $a : A^\I \ra A_\epsilon$ is a trivial fibration, it has a section $o :  A_\epsilon \ra A^\I$ by lemma \ref{cor:plusalgsection}.  Pulling  $a^*B_\epsilon \ra A^\I$ back along $o$ results in an iso,
\[
o^*a^* B_\epsilon \cong B_\epsilon\quad\text{over $A_\epsilon$}
\]
and so by the adjunction $o^*\!\dashv o_*$ there is an associated map,
\[
a^* B_\epsilon \ra o_* B_\epsilon\quad\text{over $A^\I$}
\]
to which we can apply $a_*$ to obtain a map,
\[
t : a_*a^* B_\epsilon \ra a_*o_*B_\epsilon \cong B_\epsilon\quad \text{over $A_\epsilon$\,.}
\]
This map $t$ is evidently a retraction of the unit $\eta : B_\epsilon \ra a_*a^* B_\epsilon$ over $A_\epsilon$.  Applying the functor $ \Pi_{A_\epsilon}$ therefore gives the desired retraction  of $\sigma$, 
\[
\tau\, :=\, \Pi_{A_\epsilon}t :  \Pi_{A_\epsilon}a_*a^* B_\epsilon \ra \Pi_{A_\epsilon}B_\epsilon\,.
\]

\medskip
\noindent $\bullet$ For $\psi$, we require a map 
\[
\psi:\Pi_{A^\I}B^\I \ra (\Pi_AB)^\I \qquad \text{over $X^\I$.}
\]
Consider the following diagram resulting from combining \eqref{diagram:frobenius2} and \eqref{diagram:frobenius4}, in which all solid arrows are those already introduced. The dotted arrow labelled $p$ is the evident composite.
\begin{equation}\label{diagram:frobenius8}
\xymatrix{
& X^\I \ar[r]^\epsilon & X \\
 (\Pi_AB)^\I  \ar[r]  \ar[ru] \ar[d] & \Pi_{A_\epsilon}B_\epsilon  \ar[u] \ar[d] \ar[r] & \Pi_{A}B \ar[u]\ar[dd]^= \\
 \Pi_{A^\I}B^\I \ar[r] \ar@{..>}[rrd]^>>>>>>>>>>>{p} & \Pi_{A_\epsilon} a_*a^* B_\epsilon \ar[d] & \\
  (\Pi_AB)^\I  \ar[r]  & \Pi_{A_\epsilon}B_\epsilon \ar[r] & \Pi_{A}B 
}
\end{equation}
%
The lower horizontal composite is the evaluation of the pathobject $(\Pi_AB)^\I$ at the point $\delta : 1 \to \I$, 
\[
\epsilon_{\Pi_AB} = (\Pi_AB)^\delta : (\Pi_AB)^\I \too (\Pi_AB)^1 \cong \Pi_AB\,.
\] 
This is constructed from the (cartesian closed) evaluation,
\[
\eval : \I \times (\Pi_AB)^\I \too \Pi_AB
\]
which is the counit of $\I\times(-) \dashv (-)^\I$, as the composite shown below.
\begin{equation}\label{diagram:biasedfrobenius}
\xymatrix{
(\Pi_AB)^\I \ar[d]_{\cong} \ar[rr]^{\epsilon_{\Pi_AB}} && \Pi_AB  \\
1\times (\Pi_AB)^\I \ar[rr]_{\delta\times{(\Pi_AB)^\I}} && \ar[u]_{\eval}  \I \times (\Pi_AB)^\I 
}
\end{equation}
%
Let us analyse this evaluation at $\delta$ further, in terms of the \emph{locally} cartesian closed structure associated to the base changes along the section $\delta : 1\to \I$  and retraction $\I \to 1$ in~$\EE$.
Since $\mathsf{id}  \cong \delta^*\I^* : \EE \to \EE/_\I \to \EE$, the map $\epsilon_{\Pi_AB}$ can be rewritten as follows.
\begin{equation}\label{diagram:biasedfrobenius2}
\xymatrix{
(\Pi_AB)^\I \ar[d]_{\cong} \ar[rr]^{\epsilon_{\Pi_AB}} && \Pi_AB  \ar[d]^{\cong} \\
\delta^*\I^*((\Pi_AB)^\I )  \ar[d]_{\cong}  \ar[rr]^{\delta^*\I^*\epsilon_{\Pi_AB}}  &&  \delta^*\I^*\Pi_AB  \ar[d]^{=} \\
\delta^*\I^*\I_*\I^*\Pi_AB \ar[rr]  \ar[rr]_{\delta^*\varepsilon}  & &  \delta^*\I^*\Pi_AB 
}
\end{equation}
where the map $\delta^*\varepsilon$ across the bottom is the counit of the adjunction $\I^*\dashv\I_*$, taken at $\I^*\Pi_AB$, and then pulled back along $\delta : 1\to\I$.  
%By a triangle law, it is a retraction of $\delta^*$ applied to the associated unit at $\I^*\Pi_AB$,
%\begin{equation}\label{diagram:biasedfrobenius3}
%\xymatrix{
%(\Pi_AB)^\I \ar[d]_{\cong} &&& \ar[lll]_{\eta_{\Pi_AB}} \Pi_AB  \ar[d]^{\cong} \\
%\delta^*\I^*\I_*\I^*\Pi_AB  &&& \ar[lll]^{\delta^*\I^*\eta_{\Pi_AB}}    \delta^*\I^*\Pi_AB\,.
%}
%\end{equation}
Before taking the pullback, we therefore have the following iso over $\I$ between that counit $\varepsilon_{\I^*}$ and the image under $\I^*$ of the previously considered evaluation $\epsilon : (\Pi_AB)^\I \to \Pi_AB$ from \eqref{diagram:biasedfrobenius}.
\begin{equation}\label{diagram:biasedfrobenius3}
\xymatrix{
\I^*((\Pi_AB)^\I) \ar[d]_{\cong}  \ar[rrr]^{\\I^*\epsilon} &&& \I^*\Pi_AB  \ar[d]^{=} \\
\I^*\I_*\I^*\Pi_AB   \ar[rrr]_{\varepsilon_{\I^*}}  &&&  \I^*\Pi_AB\,.
}
\end{equation}
%
%The objects  $\Pi_{A^\I}B^\I$ and $(\Pi_AB)^\I $ can be rewritten as
%\begin{align*}
%(\Pi_AB)^\I  &\cong \I_*\I^*\Pi_AB 	&\cong  \I_*\Pi_{(\I^*A)}\I^*B   \\
% \Pi_{A^\I}B^\I & 	\cong \Pi_{(\I_*\I^*A)}\I_*\I^*B   &\cong \Pi_{\I_*\I^*(A)}\I_*\I^*(B)
%\end{align*}
%Indeed, since for the point  $\delta : 1 \to \I$, we have $\delta^*\I^* \cong \i$, the latter is 
%\[
%(\Pi_AB)^\I \cong \I_*\I^*\Pi_AB \cong \delta^*\I^*(\I_*\I^*(\Pi_AB)) \cong  \,.
%\]
Now let us apply $\I^*$ to  \eqref{diagram:frobenius8} to get the map $\I^*p$ in the diagram below, which therefore factors (up to \eqref{diagram:biasedfrobenius3}) through the counit $\varepsilon_{\I^*}$ as $\varepsilon_{\I^*}\circ\I^*(\widetilde{\I^*p})$, where $\widetilde{\I^*p}$ is the adjoint transpose of $\I^*p$, as shown.
%
\begin{equation}\label{diagram:biasedfrobenius4}
\xymatrix{
\I^*\Pi_{A^\I}B^\I \ar[d]_{\I^*(\widetilde{\I^*p})} \ar[r] \ar@{..>}[rrd]^>>>>>>>>>>>{\I^*p} & \I^*\Pi_{A_\epsilon} a_*a^* B_\epsilon \ar[d] & \\
  \I^*\I_*\I^*\Pi_AB  \ar[r] \ar@/_4ex/ [rr]_{\varepsilon_{\I^*}} & \I^*\Pi_{A_\epsilon}B_\epsilon \ar[r] & \I^*\Pi_{A}B 
}
\end{equation}
%
We can therefore set $$\psi\, := \, \widetilde{\I^*p}\,,$$
and we obtain $\epsilon\circ \psi = p$, from which it follows that the square in \eqref{diagram:biasedfrobenius4} commutes by the definition of $\Pi_{A_\epsilon}B_\epsilon$ as a pullback. The same square without $\I^*$ then also commutes by applying the retraction $\delta^*$.  

We have now defined all the maps indicated below, the squares involving $\varphi$ and $\psi$ commute, and the  composite of $\sigma$ and $\tau$  is the identity.
\begin{equation}\label{diagram:frobenius9}
\xymatrix{
& X^\I \ar[r] & X \\
 (\Pi_AB)^\I  \ar[r]  \ar[ru] \ar[d]_{\varphi} 
 	& \Pi_{A_\epsilon}B_\epsilon  \ar[u] \ar[d]^\sigma \ar[r] & \Pi_{A}B \ar[u]\ar[dd]^= \\
 \Pi_{A^\I}B^\I \ar[r] \ar[d]_{\psi} \ar@{..>}[rrd]^>>>>>>>>>>>{p} 
 	& \Pi_{A_\epsilon} p_*p^* B_\epsilon \ar[d]^\tau & \\
  (\Pi_AB)^\I  \ar[r] \ar@/_4ex/ [rr]_\epsilon & \Pi_{A_\epsilon}B_\epsilon \ar[r] & \Pi_{A}B 
}
\end{equation}
%
To see that $\psi\circ\varphi = 1$, an easy chase through the diagram \eqref{diagram:frobenius9} shows that
\[
\epsilon\circ \psi\circ\varphi = p \circ \varphi = \epsilon\,.
\]
Thus by applying $\I^*$ and using \eqref{diagram:biasedfrobenius3} we have $
\varepsilon_{\I^*} \circ \I^*(\psi \circ\varphi) = \varepsilon_{\I^*}$, 
and so $\psi \circ\varphi = \widetilde{\varepsilon_{\I^*}} = 1$.

 %%say,
%%\begin{align*}
%%\I^*\varphi &=: f\\
%%\I^*\psi &=: g\,,
%%\end{align*}
%%where  $g = \widetilde{\I^*p}$.
%%%
%Recall that for any map $h : X \ra \I_*Y$, the unit $\varepsilon$ satisfies, 
%\[
%\varepsilon \circ \I^*(h) = \tilde{h}\,.
%\]
%Therefore
%\begin{align*}
%\varepsilon\circ \I^*\psi \circ \I^*\varphi  &= \varepsilon \circ \I^*(\psi \circ \varphi) \\
%&= \widetilde{(\psi \circ \varphi)}  
%\end{align*}
%
%%\begin{align*}
%%\varepsilon\circ\psi\circ\varphi &= \varepsilon\circ\I^*g\circ\I^*f\\
%%&= \varepsilon\circ\I^*(g\circ f)\\
%%&= \widetilde{(g\circ f)}.
%%\end{align*}
%On the other hand, an easy diagram chase on \eqref{diagram:frobenius9} shows that 
%\[
%\varepsilon\circ\psi\circ\varphi = \varepsilon.
%\]
%Therefore $g\circ f = \tilde{\varepsilon} = 1$, and so $\psi\circ\varphi = \I^*g\circ\I^*f = \I^*(g\circ f) = 1$.
%

%Now observe that the objects  $\Pi_{A^\I}B^\I $, $\Pi_{A}B$, and $(\Pi_AB)^\I $ are in the image of the base change $\I^*$, and so are actually  of the form $\I^*\Pi_{A^\I}B^\I $, $\I^*\Pi_{A}B$, and $\I^*((\Pi_AB)^\I) $.  Indeed, the latter is 
%\[
%\I^*((\Pi_AB)^\I) = \I^*\I_*\I^*\Pi_AB\,.
%\]
%Since the lower horizontal map is the counit $\varepsilon$ of the base change $\I^* \dashv \I_*$, the map $p$ factors as $\varepsilon\circ\I^*\tilde{p}$, where $\tilde{p}$ is the adjoint transpose of $p$, as shown in the following.
%\begin{equation}\label{diagram:frobenius9}
%\xymatrix{
%\I^*\Pi_{A^\I}B^\I \ar[d]_{\I^*\tilde{p}} \ar[r] \ar@{..>}[rrd]^>>>>>>>>>>>{p} & \Pi_{A_\epsilon} a_*a^* B_\epsilon \ar[d] & \\
%  \I^*\I_*\I^*\Pi_AB  \ar[r] \ar@/_4ex/ [rr]_\varepsilon & \Pi_{A_\epsilon}B_\epsilon \ar[r] & \I^*\Pi_{A}B 
%}
%\end{equation}
%We can therefore set $\psi\, := \, \I^*\tilde{p}$, making the square commute.  
%
%We have now defined all the maps below, the squares involving $\varphi$ and $\psi$ commute, and the  composite of $\tau$ and $\sigma$  is the identity.
%\begin{equation}\label{diagram:frobenius8}
%\xymatrix{
%& X^\I \ar[r] & X \\
% (\Pi_AB)^\I  \ar[r]  \ar[ru] \ar[d]_{\varphi} & \Pi_{A_\epsilon}B_\epsilon  \ar[u] \ar[d]^\sigma \ar[r] & \Pi_{A}B \ar[u]\ar[dd]^= \\
% \Pi_{A^\I}B^\I \ar[r] \ar[d]_{\psi} & \Pi_{A_\epsilon} p_*p^* B_\epsilon \ar[d]^\tau & \\
%  (\Pi_AB)^\I  \ar[r] \ar@/_4ex/ [rr]_\varepsilon & \Pi_{A_\epsilon}B_\epsilon \ar[r] & \Pi_{A}B 
%}
%\end{equation}
%
%To see that $\psi\circ\varphi = 1$, observe that each map is in the image of $\I^*$, say:
%\begin{align*}
%\varphi &= \I^*f\\
%\psi &= \I^*g\,,
%\end{align*}
%where  $g = \tilde{p}$.
%
%Recall that for any map $h : X \ra \I_*Y$, the unit $\varepsilon$ satisfies, 
%\[
%\varepsilon\circ \I^*(h) = \tilde{h}\,.
%\]
%Therefore
%\begin{align*}
%\varepsilon\circ\psi\circ\varphi &= \varepsilon\circ\I^*g\circ\I^*f\\
%&= \varepsilon\circ\I^*(g\circ f)\\
%&= \widetilde{(g\circ f)}.
%\end{align*}
%On the other hand, an easy diagram chase on \eqref{diagram:frobenius8} shows that 
%\[
%\varepsilon\circ\psi\circ\varphi = \varepsilon.
%\]
%Therefore $g\circ f = \tilde{\varepsilon} = 1$, and so $\psi\circ\varphi = \I^*g\circ\I^*f = \I^*(g\circ f) = 1$.
%
\end{proof}

From Proposition \ref{prop:biasedFrobimpliesunbiasedFrob} we then have:

\begin{corollary}[Unbiased Frobenius]\label{cor:unbiasedFrobenius}
The unbiased fibration weak factorization system on $\cSet$ satisfies the Frobenius condition.
\end{corollary}

\begin{remark}\label{remark:unbiasedFrobeniusgeneralizes}
We note in passing that the proof just given for the $\delta$-biased case of Frobenius, Proposition \ref{prop:Frobenius}, made no use of the fact that $\delta : 1\to\I$ is generic, nor even that we were working in the slice category over $\I$.  Indeed the same algebraic argument works for $p$-biased fibrations for any point $p : 1\to\I$ of any object $\I$ in any (quasi-)topos $\EE$.
\end{remark}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{A universal fibration}\label{sec:U}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

We next construct a \emph{universal small fibration} $\dot{\U}\ra \U$.  
It will be shown in Section \ref{sec:FEP} that the base object $\U$ is fibrant, using the equivalence extension property to be proved in Section \ref{sec:EEP}.\footnote{With only minor changes the position of this section and Section \ref{sec:EEP} could be exchanged.}  

Our construction of $\dot{\U}\ra \U$ makes use, first of all, of a new description of the well-known Hofmann-Streicher universe in a category $\widehat{\bbC} = [\op{\bbC}, \Set]$ of presheaves on a small category~$\bbC$, which was used in \cite{HS:1997} to interpret dependent type theory. See \cite{awodey:HSuniverse} for further details. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Classifying families}\label{sec:Ufam}

\begin{definition}[\cite{HS:1997}]\label{def:HSuniverse}
Let $\bbC$ be a small category.  A (type-theoretic) \emph{universe}  $(U, {\mathsf{E}l})$  consists of 
$U\in\widehat{\bbC}$ and $\textstyle{\mathsf{E}l} \in \widehat{\int_\bbC U}$ with: 
 \begin{align}
	U(c)\ &=\ \Cat\big(\op{\bbC/_c}, \Set\big) \label{eq:universeob}\\ 
	%E(I)\ &=\ {\textstyle \coprod_{A\in U(I)}{\mathsf{E}l}(\langle I, A\rangle)}\\
 	{\mathsf{E}l}(c, A)\ &=\ A(id_c) \label{eq:universeel}
 \end{align}
with the evident associated action on morphisms.  
\end{definition}

A few comments are required: 
%
\begin{itemize}
%
\item In contrast to \cite{HS:1997}, in \eqref{eq:universeob}  we take the underlying set of objects of the functor category $\widehat{\bbC/_c}=[\op{\bbC/_c}, \Set]$.
%\psh{\bbC/_c}$.

\item As in \cite{HS:1997}, \eqref{eq:universeel} adopts the ``categories with families'' point of view in describing an arrow $E\to U$ in $\widehat{\bbC}$ equivalently as a presheaf on the category of elements $\int_{\bbC}U$, using 
\begin{equation}\label{eq:elements}\textstyle
\widehat{\bbC}/_U\ \simeq\  \widehat{\int_{\bbC}U}\,
\end{equation}
where
\[
E(c)\ =\ {\textstyle \coprod_{A\in U(c)}{\mathsf{E}l}(c, A)}.
\]
The argument $(c, A) \in \int_{\bbC}U$ in \eqref{eq:universeel} thus consists of an object $c\in\bbC$ and an element $A\in U(c)$.
%
\item To account for size issues, the authors of \cite{HS:1997} assume a Grothendieck universe $u$ in $\Set$, the elements of which are called \emph{small}. The category $\bbC$ is assumed to be small, as are the values of the presheaves, unless otherwise stated.  
%
\end{itemize}

The presheaf $U$, which is not small, is then regarded as the Grothendieck universe $u$ ``lifted'' from $\Set$ to $[\op{\bbC}, \Set]$.  We first analyse this specification of $(U, {\mathsf{E}l})$ from a different perspective, in order to establish its basic property as a classifier for small families in $\widehat\bbC$. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{A realization-nerve adjunction.}

For a presheaf $X$ on $\bbC$, recall that the category of elements is the comma category,
\[\textstyle
\int_\bbC X\ =\ \yon_\bbC/_X\,,
\] 
where $\yon_\bbC : \bbC \to \psh\bbC$ is the Yoneda embedding, which we sometimes supress and write simply $\bbC/_X$ for $\yon_\bbC/_X$. 
%While the category of elements $\int_\bbC X$ is used in the specification of the Hofmann-Streicher universe $(U, {\mathsf{E}l})$ at the point \eqref{eq:elements}, the authors seem to have missed a trick  which would have simplified things:

\begin{proposition}[\cite{G:1983},\S{28}]
The category of elements functor $$\textstyle \int_\bbC : \widehat\bbC \too \Cat$$ has a right adjoint,
\[
\nu_\bbC : \Cat \too \widehat\bbC\,.
\]
For a small category $\A$, we shall call the presheaf $\nu_\bbC(\A)$ the \emph{($\bbC$-)nerve} of $\A$.
\end{proposition}
\begin{proof}
The adjunction $\int_\bbC\! \dashv \nu_\bbC$ is an instance of the usual ``realization/nerve'' adjunction, here with respect to the covariant slice category functor $\bbC/- : \bbC\to\Cat$, as indicated below.
\begin{equation}\label{eq:nerve}\textstyle
\begin{tikzcd}
	 \widehat\bbC \ar[rr, swap,"\int_\bbC"] &&  \ar[ll, swap,bend right=20, "{ \nu_\bbC}"] \Cat\\  
	 \\
	\bbC \ar[uu, hook, "\yon"] \ar[rruu, swap,"{\bbC/_{-}}"] &&
 \end{tikzcd}
 \end{equation}
%
In detail, for  $\A\in\Cat$ and $c\in\bbC$, let $\nu_{\bbC}(\A)(c)$ be the Hom-set of functors,
\begin{align*}
\nu_\bbC(\A)(c) &= \Cat\big( {\bbC/_c}\,,\, \A \big)\,,
\end{align*}
with contravariant action on $h : d\to c$ given by pre-composing a functor $P : {\bbC/_c}\to\A$  with the post-composition functor
\[
{\bbC/_h} : {\bbC/_d}\too {\bbC/_c} \,.
\]
For the adjunction, observe that the slice category $\bbC/_c$ is the category of elements of the representable functor $\y{c}$\,,
\[\textstyle
\int_\bbC\y{c}\ \cong\ \bbC/_c\,.
\]
 Thus for representables $\y{c}$\,, we have the required natural isomorphism
 \[\textstyle
 \widehat\bbC\big( \y{c}\,,\, \nu_\bbC(\A) \big)\ \cong\ \nu_\bbC(\A)(c)\  =\ \Cat\big( {\bbC/_c}\,,\, \A \big)\ \cong\ \Cat\big( \int_\bbC\y{c}\,,\, \A \big)\,.
  \]
For arbitrary presheaves $X$, one uses the presentation of $X$ as a colimit of representables over the index category $\int_\bbC X$, and the easy to prove fact that $\int_\bbC$ itself preserves colimits.  Indeed, for any category $\D$, we have an isomorphism in $\Cat$,
\[
\varinjlim_{d\in\D}\,\D/_d \ \cong\ \D\,.
\]
\end{proof}

When $\bbC$ is fixed, we may omit the subscript in the notation $\yon_\bbC$ and  $\int_\bbC$ and $\nu_\bbC$.  The unit and counit maps of the adjunction $\int \dashv \nu$, 
\begin{align*}\textstyle
\eta :&\ \textstyle  X \too \nu{\elem{X}}\,, \\
\epsilon :&\ \textstyle  \elem\nu\A \too \A\,,
\end{align*}
 are then as follows.  At $c\in\bbC$, for $x : \y{c}\ra X$, the functor $(\eta_X)_c(x) : \bbC/_c \to \bbC/_X$ is just composition with $x$, 
\begin{equation}\label{eq:eta}
(\eta_X)_c(x) = \bbC/_x : \bbC/_c \too \bbC/_X\,.
\end{equation}
For $\A\in\Cat$, the functor $ \epsilon : \int\nu\A \to \A$ takes a pair $(c\in\bbC, f : \bbC/_c \to \A)$ to the object $f(1_c) \in \A$,
\[
\epsilon(c,f) = f(1_c).
\]
\begin{lemma}\label{lemma:natpb}
For any $f : Y\to X$, the naturality square below is a pullback.
\begin{equation}\label{eq:naturality}\textstyle
\begin{tikzcd}
	 Y \ar[d, swap,"f"] \ar[r, "{\eta_Y}"] & \nu{\int\!{Y}} \ar[d, "{ \nu{\int\!{f}}}"]\\  
	X \ar[r, swap,"{\eta_X}"] &   \nu{\int\!{X}}.
 \end{tikzcd}
 \end{equation}
\end{lemma}

\begin{proof}
It suffices to prove this for the case $f : X\ra 1$.  Thus consider the square 
\begin{equation}\label{eq:naturalityobject}\textstyle
\begin{tikzcd}
	 X \ar[d] \ar[r, "{\eta_X}"] & \nu{\int\!{X}} \ar[d]\\  
	1\ar[r, swap,"{\eta_1}"] &   \nu{\int\! 1}.
 \end{tikzcd}
 \end{equation}
Evaluating at $c\in\bbC$ and applying \eqref{eq:eta} gives the following square in $\Set$.
\begin{equation}\label{eq:naturalityobjecteval}\textstyle
\begin{tikzcd}
	 Xc \ar[d] \ar[r, "{\bbC/_{-}}"] & \Cat\big( {\bbC/_c}\,,\, {\bbC/_X}\, \big) \ar[d]\\  
	1c\ar[r, swap, "{\bbC/_{-}}"] &   \Cat\big( {\bbC/_c}\,,\, \bbC/_1 \big)
 \end{tikzcd}
 \end{equation}
The image of $*\in 1c$ along the bottom is the forgetful functor $U_c : \bbC/_c\to \bbC$, and its fiber under the map on the right is the set of functors $F : {\bbC/_c}\to {\bbC/_X}$ such that $U_X\circ F = U_c$, where $U_X : \bbC/_X\to \bbC$ is also a forgetful functor. But any such $F$ is uniquely of the form $\bbC/_{x}$ for $x = F(1_c) : \y{c} \to X$.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{A universal family.}

For the terminal presheaf $1\in\widehat{\bbC}$ we have an iso $\elem{1} \cong\bbC$, so for every $X\in\widehat{\bbC}$ there is a canonical projection  $\elem X \ra\bbC$, which is a discrete fibration.  It follows that for any map $Y\to X$ of presheaves, the associated map $\elem Y \to \elem X$ is also a discrete fibration. 
Ignoring size issues temporarily, recall that discrete fibrations in $\Cat$ are classified by the forgetful functor $\op{\dot{\Set}}\to \op{\Set}$ from (the opposites of) the category of pointed sets to that of sets (cf.~\cite{W:2007}).  For every presheaf $X\in\widehat{\bbC}$, we therefore have a pullback diagram in $\Cat$,
\begin{equation}\label{eq:classifyuniversecat}\textstyle
\begin{tikzcd}
	 \elem X \ar[d] \ar[r] \pbmark & \op{\dot{\Set}} \ar[d]\\  
	\bbC \ar[r,swap,"X"] &  \op{\Set}.
 \end{tikzcd}
 \end{equation}
Using $\bbC\cong\elem{1}$ and transposing by the adjunction $\int \dashv \nu$ then gives a commutative square in $\widehat{\bbC}$ of the form:
\begin{equation}\label{eq:classifyuniversetype}\textstyle
\begin{tikzcd}
	 X \ar[d] \ar[r] & \nu\op{\dot{\Set}} \ar[d]\\  
	1 \ar[r,swap,"\tilde{X}"] &  \nu\op{\Set}.
 \end{tikzcd}
 \end{equation}

\begin{lemma}
The square \eqref{eq:classifyuniversetype} is a pullback in $\widehat{\bbC}$. More generally, for any map $Y\ra X$ in $\widehat{\bbC}$, there is a canonical pullback square 
\begin{equation}\label{eq:classifyuniversefamily}\textstyle
\begin{tikzcd}
	 Y \ar[d] \pbmark \ar[r] & \nu\op{\dot{\Set}} \ar[d] \\  
	X \ar[r] &  \nu\op{\Set}\,.
 \end{tikzcd}
 \end{equation}
\end{lemma}

\begin{proof}
Apply the right adjoint $\nu$ to the pullback square \eqref{eq:classifyuniversecat} and paste the naturality square \eqref{eq:naturality} from Lemma \ref{lemma:natpb} on the left, to obtain the transposed square \eqref{eq:classifyuniversefamily} as a pasting of two pullbacks.
\end{proof}

Let us write $\VV \to \V$ for the vertical map on the right in \eqref{eq:classifyuniversefamily}, setting
\begin{align}\label{eq:universedef}\textstyle
\VV\, &:=\, \nu\op{\dot{\Set}}\\  
\V\, &:=\, \nu\op{\Set}.\notag
 \end{align}
 
 We summarize our results so far as follows.

 \begin{proposition}\label{prop:Vclassifies}
The nerve $\VV\to\V$  of the classifier for discrete fibrations $\op\SSet\to\op\Set$, as defined in \eqref{eq:universedef}, classifies natural transformations $Y\to X$ in $\widehat{\bbC}$, in the sense that there is always a pullback square,
\begin{equation}\label{eq:classifyuniversefamily2}\textstyle
\begin{tikzcd}
	 Y \ar[d] \pbmark \ar[r] & \VV \ar[d] \\  
	X \ar[r,swap, "\tilde{Y} "] &  \V.
 \end{tikzcd}
 \end{equation}
The classifying map $\tilde{Y} : X\to \V$ is determined by the adjunction $\int \dashv \nu$ as the transpose of the classifying map of the discrete fibration $\elem Y\to\elem X$.  
\end{proposition}

Given a natural transformation $Y\to X$, the classifying map $\tilde{Y} : X\to \V$ is of course not in general unique. Nonetheless, we can  use the construction of $\VV\to\V$ as the nerve of the discrete fibration classifier $\op\SSet\to\op\Set$, for which classifying functors $\bbC \to \op\Set$ are unique up to natural isomorphism, to infer the following proposition, which will be required below (cf.~\cite{Shu:15,GSS:22}).

\begin{proposition}[Realignment for families]\label{prop:realignment}
Given a monomorphism $c : C\cof X$ and a family $Y\to X$, let $y_c : C \to \V$ classify the pullback $c^*Y\to C$.  Then there is a classifying map $y: X \to \V$ for $Y\to X$ with $y\circ c = y_c$.
%
\begin{equation}\label{diagram:presheafrealignment}
\begin{tikzcd}
c^*Y \ar[dd] \ar[rd] \ar[rr] && \VV \ar[dd] \\
& Y \ar[dd] \ar[ru, dotted] & \\
C  \ar[rd, tail,swap, "c"] \ar[rr, near start, "y_c"] && \V  \\
& X \ar[ru, dotted, swap, "y"] &
\end{tikzcd}
\end{equation}
\end{proposition}
%
\begin{proof}
Transposing the realignment problem \eqref{diagram:presheafrealignment} for presheaves across the adjunction $\int\dashv \nu$ results in the following realignment problem for discrete fibrations.
\begin{equation}\label{diagram:presheafrealignment2}
\begin{tikzcd}
\elem  c^*Y \ar[dd] \ar[rd] \ar[rr] && \op{\dot{\Set}}  \ar[dd] \\
&\elem  Y \ar[dd] \ar[ru, dotted] & \\
\elem  C  \ar[rd, tail,swap, "{\elem  c}"] \ar[rr, near start, "\widetilde{y_c}"] && \op{{\Set}}   \\
& \elem  X \ar[ru, dotted, swap, "\tilde{y}"] &
\end{tikzcd}
\end{equation}
The category of elements functor $\int $ is easily seen to preserve pullbacks, hence monos; thus let us consider the general case of a functor  $C : \bbC \mono \D$ which is monic in $\Cat$, a pullback of discrete fibrations as on the left below, and a presheaf $E : \bbC \to  \op{{\Set}}$ with $\elem E \cong \mathbb{E}$ over $\bbC$. 
\begin{equation}\label{diagram:presheafrealignment3}
\begin{tikzcd}
\mathbb{E} \ar[dd] \ar[rd] \ar[rr] && \op{\dot{\Set}}  \ar[dd] \\
& \mathbb{F}  \ar[dd] \ar[ru, dotted] & \\
\bbC  \ar[rd, tail,swap, "{C}"] \ar[rr, near start, "E"] && \op{{\Set}}   \\
& \D \ar[ru, dotted, swap, "F"] &
\end{tikzcd}
\end{equation}
We seek $F : \D \to  \op{{\Set}}$ with $\elem F \cong \mathbb{F}$ over $\D$ and $F\circ C = E$.  Let $F_0 : \D \to  \op{\Set}$ with $\elem F_0 \cong \mathbb{F}$ over $\D$, which exists since $\mathbb{F}\to\D$ is a discrete fibration.  Since $F_0\circ C$ and $E$ both classify $\mathbb{E}$, there is a natural iso $e : F_0\circ C \cong E$.
Consider the following diagram
\begin{equation}\label{diagram:presheafrealignment4}
\begin{tikzcd}
\bbC \ar[dd, tail, swap, "{C}"]  \ar[rr, "e"] && {\op{(\Set^{\cong})}}  \ar[dd,"{p_1}"] \ar[r,swap,"{p_2}"] &  {\op{\Set}} \\
&&&\\
\D  \ar[rr,swap, "F_0"]  \ar[rruu, dotted, swap, "f"] && \op{\Set} &  \\
\end{tikzcd}
\end{equation}
where $\Set^{\cong}$ is the category of isos in $\Set$, with $p_1, p_2$ the (opposites of the) domain and codomain projections.  There is a well-known weak factorization system on $\Cat$ (part of the ``canonical model structure'') with injective-on-objects functors on the left and isofibrations on the right.  Thus there is a diagonal filler $f$ as indicated.  The functor $F := p_2\circ f : \D \to \op{\Set}$ is then  the one we seek.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Small maps.}
 
Of course, as defined in \eqref{eq:universedef}, the classifier $\VV\to\V$ cannot be a map in $\widehat{\bbC}$, for reasons of size; we now address this.  
Let $\alpha$ be a cardinal number, and call the sets strictly smaller than it $\alpha$-\emph{small}.  Let $\Set_\alpha\hook\Set$ be the full subcategory of $\alpha$-small sets.  
Call a presheaf $X : \op{\bbC} \to \Set$ $\alpha$-small if all of its values are $\alpha$-small sets, and thus if, and only if, it factors through $\Set_\alpha\hook\Set$. Call a map $f:Y\to X$ of presheaves $\alpha$-small if all of the fibers $f_c^{-1}\{ x\} \subseteq Yc$ are $\alpha$-small sets (for all $c\in\bbC$ and $x\in Xc$). The latter condition is of course equivalent to saying that, in the pullback square over the element $x:\y{c} \to X$, 
\begin{equation}\label{eq:smallmap}\textstyle
\begin{tikzcd}
	 Y_x \ar[d] \pbmark \ar[r] & Y \ar[d, "f"] \\  
	\y{c} \ar[r,swap,"x"] &  X,
 \end{tikzcd}
 \end{equation}
the presheaf $Y_x$ is $\alpha$-small.

% Consider $\Set_\alpha^{\C^{\mathrm{op}}}$, the category of $\alpha$-small set valued presheaves on $\C$.  
% and similarly for the small pointed sets $\SSet_\alpha\hook\SSet$

Now let us restrict the specification \eqref{eq:universedef} of $\VV\to\V$ to the $\alpha$-small sets:
\begin{align}\label{eq:universedefalpha}\textstyle
\VV_\alpha\, &:=\, \nu \dot{\Set^{\mathsf{op}}_\alpha}\\  
\V_\alpha\, &:=\, \nu \Set^{\mathsf{op}}_\alpha. \notag
 \end{align}
Then the evident forgetful map $\VV_\alpha\to\V_\alpha$ \emph{is} a map in the category $\widehat{\bbC}$ of presheaves, and it is in fact $\alpha$-small. Moreover, it has the following basic property, which is just a restriction of the basic property of $\VV\to\V$ stated in Proposition \ref{prop:Vclassifies}.

 \begin{proposition}\label{prop:familyclassifier}
The map $\VV_\alpha\to\V_\alpha$ classifies $\alpha$-small maps $f:Y\to X$ in $\widehat{\bbC}$, in the sense that there is always a pullback square,
\begin{equation}\label{eq:classifyuniversefamilyalpha}\textstyle
\begin{tikzcd}
	 Y \ar[d] \pbmark \ar[r] & \VV_\alpha \ar[d] \\  
	X \ar[r,swap, "\tilde{Y}"] &  \V_\alpha.
 \end{tikzcd}
 \end{equation}
The classifying map $\tilde{Y} : X\to \V_\alpha$ is determined by the adjunction $\int \dashv \nu$ as (the factorization of) the transpose of the classifiyng map of the discrete fibration $\elem X\to\elem Y$. 
\end{proposition}

\begin{proof} If $Y\to X$ is $\alpha$-small, its classifying map $\tilde{Y} : X\to\V$ factors through $\V_\alpha \hook \V$, as indicated below, 
\begin{equation}\label{eq:classifyuniversetype2}\textstyle
\begin{tikzcd}
	 Y \ar[d] \ar[rr, bend left] \ar[r] & \nu\op{\dot{\Set_\alpha}} \ar[d] \ar[r,hook] & \nu\op{\dot{\Set}} \ar[d]\\  
	X \ar[rr, bend right, swap,"\tilde{Y}"] \ar[r] &  \nu\op{\Set_\alpha} \ar[r,hook] &  \nu\op{\Set},
 \end{tikzcd}
 \end{equation}
%
in virtue of the following adjoint transposition,
\begin{equation}\label{eq:adjointtranspose}\textstyle
\begin{tikzcd}
	 \elem Y \ar[d] \ar[rr, bend left] \ar[r] & \op{\dot{\Set_\alpha}} \ar[d] \ar[r,hook] & \op{\dot{\Set}} \ar[d]\\  
	 \elem X \ar[rr, bend right, ] \ar[r]  &  \op{\Set_\alpha} \ar[r,hook]  &  \op{\Set}.
 \end{tikzcd}
  \end{equation}
Note that the square on the right is evidently a pullback, and so the one on the left is, too, because the outer rectangle is the classifying pulback of the discrete fibration $\elem Y \to \elem X$, as stated.  Thus the left square in \eqref{eq:classifyuniversetype2} is also a pullback.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Examples of universal families $\VV_\alpha \too \V_\alpha$.}

\begin{enumerate}
%
\item Let $\alpha = \kappa$ a strongly inaccessible cadinal, so that $\mathsf{ob}({\Set_\kappa})$ is a Grothendieck universe.  Then the Hofmann-Streicher universe of Definition \ref{def:HSuniverse} is recovered as the $\kappa$-small map classifier
\begin{equation*}
E\, \cong\, \VV_\kappa \too \V_\kappa\, \cong\, U
\end{equation*}
 in the sense of Proposition \ref{prop:familyclassifier}.  Indeed, for $c\in\bbC$, we have 
 \begin{align}
  \V_{\kappa}{c}\ &=\ \nu(\Set^{\mathsf{op}}_\kappa)(c) = \Cat\big( {\bbC/_c}\,,\, \Set^{\mathsf{op}}_\kappa \big)\  =\ \mathsf{ob}(\widehat{\bbC/_c})\ =\ U{c} \,.
   \end{align} 
For $\VV_{\kappa}$ we then have,
   \begin{align}\label{eq:veedotc}
   \VV_{\kappa}{c}\ =\ \nu(\SSet^{\mathsf{op}}_\kappa)(c)\ &=\ \Cat\big( {\bbC/_c}\,,\, \SSet^{\mathsf{op}}_\kappa \big) \notag \\ 
   &\cong\ {\textstyle \coprod_{A\in\V_{\kappa}{c}}\Cat_{{\bbC/_c}}\big( {\bbC/_c}\,,\, A^*\Set^{\mathsf{op}}_\kappa \big)}
   \end{align}
   where the $A$-summand in \eqref{eq:veedotc} is defined by taking sections of the  pullback indicated below.
   \begin{equation}\label{eq:pbforindexing}\textstyle
\begin{tikzcd}
	A^*\Set^{\mathsf{op}}_\kappa \ar[d] \ar[r] \pbmark & \SSet^{\mathsf{op}}_\kappa \ar[d]\\  
	\bbC/_c \ar[r,swap,"A"] \ar[u, bend left, dotted] \ar[ur, dotted] &  \Set^{\mathsf{op}}_\kappa
 \end{tikzcd}
 \end{equation}
 But $A^*\Set^{\mathsf{op}}_\kappa\ \cong\ {\textstyle \int_{\bbC/_c}\!A}$ over $\bbC/_c\,$, and sections of this discrete fibration in $\Cat$ correspond uniquely to natural maps $1\to A$ in $\widehat{{\bbC/_c}}$.  Since $1$  is representable in $\widehat{{\bbC/_c}}$ we can continue \eqref{eq:veedotc} by
  \begin{align*}
   \VV_{\kappa}{c}\ &\cong\ {\textstyle \coprod_{A\in \V_{\kappa}{c}}\Cat_{{\bbC/_c}}\big( {\bbC/_c}\,,\, A^*\Set^{\mathsf{op}}_\kappa \big)}\\
   	&\cong\ {\textstyle \coprod_{A\in \V_{\kappa}{c}} \widehat{{\bbC/_c}}(1, A)}\\
	&\cong\ {\textstyle \coprod_{A\in \V_{\kappa}{c}} A(1_c) } \\
	& =\ {\textstyle \coprod_{A\in \V_{\kappa}{c}} {\mathsf{E}l}(\langle c, A\rangle)}\\
	& =\  E c\,.
   \end{align*}
 
% The second line is in virtue of the iso,
%  \begin{align}
%  \V_{\kappa}{c}\ &=\ \nu(\Set^{\mathsf{op}}_\kappa)(c) = \Cat\big( {\C/_c}\,,\, \Set^{\mathsf{op}}_\kappa \big)\  =\ U{c} \,\notag\\ 
%   \VV_{\kappa}{c}\ &=\ \nu(\SSet^{\mathsf{op}}_\kappa)(c) = \Cat\big( {\C/_c}\,,\, \SSet^{\mathsf{op}}_\kappa \big)
%   = \textstyle{ \coprod_{A\in U{c}} }A(1_c) = \textstyle\coprod_{A\in U{c}}{\mathsf{E}l}(\langle c, A\rangle) \,.
% \end{align}

\item By functoriality of the nerve $\nu : \Cat \to \widehat{\bbC}$, a sequence of Grothendieck universes $$\Set_\alpha \subseteq \Set_{\beta} \subseteq ...$$ in $\Set$ gives rise to a (cumulative) sequence of type-theoretic universes $$\V_\alpha \mono {\V_\beta} \mono ...$$ in $\widehat{\bbC}$. More precisely, there is a sequence of  cartesian squares,
\begin{equation}\label{eq:Vhierarchy}\textstyle
\begin{tikzcd}
	 \VV_\alpha \ar[d] \ar[r,tail] \pbmark & {\VV_\beta} \ar[d] \ar[r,tail] \pbmark & \dots \\  
	 \V_\alpha  \ar[r, tail]  &  {\V_\beta} \ar[r,tail]  & \dots\,,
 \end{tikzcd}
  \end{equation}
in the image of $\nu : \Cat\too\widehat\bbC$, classifying small maps in $\widehat\bbC$ of increasing size, in the sense of Proposition \ref{prop:familyclassifier}.

\item\label{universeexample:sliceuniverse} Let $\alpha = 2$ so that $1\to 2$ is the subobject classifier of $\Set$, and 
$$\mathbbm{1} = \SSet^{\mathsf{op}}_2 \too  \Set^{\mathsf{op}}_2 = \mathbbm{2}$$ is then a classifier in $\Cat$ for \emph{sieves}, i.e.\ full subcategories $\mathbb{S}\hook\A$ closed under the domains of arrows $a\to s$ for $s\in\mathbb{S}$.  The nerve $\VV_{2}  \to \V_{2}$ is then the usual subobject classifier $1\to\Omega$ of $\widehat\bbC$,
\[
1 = \nu \mathbbm{1} = \VV_{2} \too  \V_{2} = \nu \mathbbm{2} = \Omega  \,.
\]

\item For any $X\in \widehat{\bbC}$, we have an equivalence 
\[
\widehat{\bbC}/_X\ %\simeq\ \widehat{\bbC/_X}\ 
\simeq\ \widehat{\textstyle \int_{\bbC}X}\ \simeq\ \mathsf{dFib}/_{\int_{\bbC}X}
\]
where, generally, $\mathsf{dFib}/_{\mathbb{D}}$ is the category of discrete fibrations over a category $\mathbb{D}$.
This equivalence commutes with composition along discrete fibrations, in the sense that the forgetful functor $${X_!}: \widehat{\bbC}/_X \to \widehat{\bbC}$$ given by composition along $X \to 1$ agrees (up to canonical isomorphism) with the base change $(p_X)_! \dashv (p_X)^*$ of presheaves along the projection  ${\textstyle  p_X : \int_{\bbC}X \to  \bbC}$, and with composition along the discrete fibration $p_X$, as indicated in:
\begin{equation}\label{diagram:sliceuniversepullsback}
\begin{tikzcd}
\widehat{\bbC}/_X  \ar[d,swap,"{{X_!}}"] \ar[r, "{\sim}"] 
	& \widehat{\textstyle \int_{\bbC}X} \ar[d,swap,"{{(p_X)_!}}"] \ar[r, "{\sim}"] 
		& \mathsf{dFib}/_{\int_{\bbC}X} \ar[d,"p_X\circ(-)"]  \\
 \widehat{\bbC}  \ar[r,swap, "{\sim}"]   & \widehat{\bbC}  \ar[r,swap, "{\sim}"] 
	&  \mathsf{dFib}/_{\bbC}.
\end{tikzcd}
\end{equation}

It follows that the pullback functor $X^* : \widehat{\bbC} \to \widehat{\bbC}/_X$ commutes with the corresponding right adjoints (one of which is the nerve), and therefore preserves the respective universes, 
\[\textstyle
 X^* \V_{\bbC} \ 
   \cong\ (p_X)^* \nu_{\bbC}(\Set^{\mathsf{op}}) \ 
   \cong\  \nu_{\int_{\bbC}X}(\Set^{\mathsf{op}}) \ 
   \cong\  \V_{ \int_{\bbC}X} \,.
 \]

%\item Let $i : \mathbbm{2} \hook \Set_\kappa$ and $ p : \Set_\kappa \to \mathbbm{2} $ be the embedding-retraction pair with $i : \mathbbm{2} \hook \Set_\kappa$ the inclusion of the full subcategory on the sets $ \{0, 1\}$ and $p : \Set_\kappa \to \mathbbm{2}$ the retraction that takes $0 = \emptyset$ to itself, and everything else (i.e.\ the non-empty sets) to $1 = \{\emptyset\}$. There is a retraction (of arrows) in $\Cat$,
%%
%\begin{equation}\label{eq:Setretraction}\textstyle
%\begin{tikzcd}
%	 \mathbbm{1} \ar[d]  \ar[r,hook] \pbmark & \SSet_\kappa \ar[d] \ar[r] &\mathbbm{1} \ar[d] \\  
%	 \mathbbm{2}   \ar[r,hook,swap, "i"]  &  \Set_\kappa \ar[r, swap, two heads, "p"]  & \mathbbm{2} 
% \end{tikzcd}
%  \end{equation}
%  where the left square is a pullback.  
%    
%By the functoriality of (\,$\op{-}$ and) $\nu : \Cat \to \widehat{\C}$ we then have a retract diagram in $\widehat\C$, again with a pullback on the left, 
%\begin{equation}\label{eq:Vretraction}\textstyle
%\begin{tikzcd}
%	 1 \ar[d]  \ar[r,hook] \pbmark & \VV_\kappa \ar[d] \ar[r] &1\ar[d] \\  
%	 \Omega   \ar[r,hook,swap, "\{-\}"]  &  \V_\kappa  \ar[r, swap, two heads, "{[-]}"]  &  \Omega 
% \end{tikzcd}
%  \end{equation}
%  where for any $\phi : X\to \Omega$ the subobject $\{\phi\}\mono X$ is classified as a small map by the composite $\{\phi\} : X\to \V_\kappa$\,, and for any small map $A\to X$, the image $[A] \mono X$ is classified as a subobject by the composite $[\alpha] : X\to \V_\kappa \to \Omega$\,, where $\alpha : X\to \V_\kappa$ classifies $A\to X$.  The idempotent composite $$|\!|\!-\!|\!| = \{[-]\} : \V_\kappa  \too \V_\kappa $$ is the \emph{propositional truncation modality} in the natural model of type theory given by $\VV_\kappa\to \V_\kappa$ (see \cite{AGH}).
\end{enumerate}

 \begin{corollary}\label{prop:familyclassifierforslices}
Let $\VV_\alpha\to\V_\alpha$ classify $\alpha$-small maps in $\widehat{\bbC}$, as in Proposition \ref{prop:familyclassifier}.  Then for any $X\in \bbC$, the pullback $X^*\VV_\alpha\to X^*\V_\alpha$ classifies 
$\alpha$-small maps in $\widehat{\bbC}/_X$
\end{corollary}


%%%%%%%%%%%%%%%% end of H-S universes notes %%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\paragraph{Classifying families.}
%\ednote{revise from here - or sooner!}
%
%Let $\kappa$ be an inaccessible cardinal number.  Let $\Set_\kappa$ be the category of sets of size strictly less than $\kappa$, called \emph{small},  and let $\cSet_\kappa = \Set_\kappa^{\C^{\mathrm{op}}}$ be the category of small set valued presheaves on the cube category $\C$.  By a \emph{small fibration} we mean a fibration in this category of small cubical sets, which we identify with the evident subcategory, $\cSet_\kappa \subseteq \cSet$.  Finally, let $\dot{\Set}_\kappa$ be the category of small pointed sets, i.e.\ the coslice category $1/\Set_\kappa$.  There is an evident forgetful functor  $U:\dot{\Set}_\kappa \ra {\Set}_\kappa$.
%% which induces another one $U^{\C^{op}} : \dot{\Set}_\kappa^{\C^{op}} \ra {\Set}_\kappa^{\C^{op}}$ from small pointed presheaves to small presheaves.
%
%\begin{definition}
%The ($\kappa$-)\emph{universe} $p : \VV \ra \V$ in $\cSet$ is defined:
%\begin{enumerate}
%
%\item $\V_n = \{ A: \C/[n] \ra \Set^{op}_\kappa\ \}$, the \emph{set} of small presheaves on $\C/[n]$.  
%
%The action of a map $h : [m] \ra [n]$ in  $\C$  is given by precomposition with postcomposition: from  $h : [m] \ra [n]$ we have  $\C/h : \C/[m] \ra \C/[n]$, which we precompose with any $A: \C/[n]\ra \Set_\kappa^{op} $ to get $A.h = A\circ \C/h$,
%\begin{equation}\label{diagram:U1}
%\xymatrix{
%[n] & \C/[n] \ar[r]^{A} & \Set_\kappa^{op} \\
%[m] \ar[u]^{h} & \C/[m] \ar[u]^{\C/h}  \ar[ru]_{A.h} &
%}
%\end{equation}
%
%\item $\VV_n = \{ a: \C/[n] \ra \dot{\Set}^{op}_\kappa\ \}$, the \emph{set} of small pointed presheaves on $\C/[n]$, with the corresponding action.
%
%\item For $a \in \VV_n$, let $p_n (a) = U(a) \in \V_n$, where $U : \dot{\Set_\kappa} \ra {\Set_\kappa}$.
%\end{enumerate}
%\end{definition}
%Functoriality of $\V$ and $\VV$ and naturality of $p: \VV\ra\V$ are immediate. 
%
%\begin{lemma}
%For each $A : \I^n \ra \V$ there is a canonical choice of a small family $p_A : E_A\ra \I^n$ and a map $q_A: E_A \ra\VV$ making a pullback square as follows.
%\begin{equation}\label{diagram:U2}
%\xymatrix{
%E_A \ar[d]_{p_A} \ar[r]^{q_A}  \pbcorner& \VV\ar[d]^{p}  \\
%\I^n \ar[r]_{A} & \V
%}
%\end{equation}
%\end{lemma}
%%
%\begin{proof}
%Since $\I^n \cong y[n]$ is representable, there is a distinguished associated presheaf $A : (\C/[n])^{op} \ra \Set_\kappa$. Define $p_A : E_A \ra \I^n$ by
%\[
%(E_A)_k = \coprod_{h\in \C(k,n)} A(h) \qquad \ni (h, a)\,
%\]
%with first projection $(p_A)_k(h,a) = h$. Note that $(E_A)_k$ is small.
%Then let $q_A:E_A \ra\VV$ be defined on $(h,a): \I^k \ra E_A$ by 
%\[
%(q_A)\circ(h, a) = a \in Ah
%\]
%as illustrated below.
%\begin{equation}\label{diagram:U3}
%\xymatrix@=5em{
%& E_A \ar[d]^>>>>>>{p_A} \ar@{..>}[r]^{q_A} & \VV\ar[d]^{p}  \\
%\I^k \ar[r]_{h} \ar[ru]^{(h,a)}\ar[rru]_>>>>>>>>>>>{a} & \I^n \ar[r]_{A} & \V
%}
%\end{equation}
%The proof that the square is a pullback is left to the reader.
%\end{proof}
%
%\begin{lemma}\label{charforfamovercube}
%For each small family $p_E : E \ra \I^n$ there is a canonical map $\chi_E : \I^n \ra \V$ and a map $q_E:E \ra\VV$ making a pullback square as follows.
%\begin{equation}\label{diagram:U2}
%\xymatrix{
%E \ar[d]_{p_E} \ar[r]^{q_E}  \pbcorner& \VV\ar[d]^{p}  \\
%\I^n \ar[r]_{\chi_E} & \V
%}
%\end{equation}
%\end{lemma}
%%
%\begin{proof}
%It suffices to give a small set $(\chi_E)_k(h)$ for each $h :[k] \ra [n]$ in a way that is functorial in $h \in \C/[n]$ and natural in $[k]$.  Thus let
%\[
%(\chi_E)_k(h) := \Gamma(h, E)\ = \ \{ e : \I^k \ra E \ |\ p_E\circ e = h \}.
%\]
%\[
%\xymatrix{& E \ar[d]^{p_E} \\ \I^k \ar@{..>}[ru]^{e}\ar[r]_h & \I^n } 
%\]
%which is small if each $E_k$ is.  
%
%To define $q_E:E \ra\VV$,  take any $e : \I^k \ra E$ and first compose with $p_E$ and observe that $e \in  \Gamma(p_Ee, E)$.  Thus the assignment gives a map $\dot{e} : \I^k \ra \VV$ making the solid arrows in the following commute.
%\begin{equation}\label{diagram:U4}
%\xymatrix@=5em{
%&E \ar[d]^>>>>>>>{p_E} \ar@{..>}[r]^{q_E} & \VV\ar[d]^{p}  \\
%\I^k \ar[r]_{p_Ee} \ar[ru]^{e}\ar[rru]_>>>>>>>>>>>{\dot{e}} & \I^n \ar[r]_{E} & \V
%}
%\end{equation}
%Since the assignment of $\dot{e}$ to $e$ is natural in $[k]$, we get the required map $q_E : E\ra \VV$.
%The proof that the square is a pullback is again left to the reader.
%\end{proof}
%
%\begin{corollary}
%Given a small family $p_E : E \ra \I^n$ there is a unique isomorphism $E \cong E_{\chi_E}$ over $\I^n$ making a commutative diagram as follows.
%
%\begin{equation}\label{diagram:U5}
%\xymatrix@=5em{
%E \ar[rd]_{p_E} \ar@/^2.0pc/[rr]^{q_E} \ar[r]^{\cong}  & E_{\chi_E} \ar[d]^{p_{\chi_E}} \ar[r]_{q_{\chi_E}} & \VV \ar[d]^{p}  \\
% &\I^n \ar[r]_{\chi_E} & \V
%}
%\end{equation}
%\end{corollary}
%%
%
%\begin{proposition}\label{prop:familyclassifier}
%For any cubical set $X$ and any small family $p_E : E \ra X$ there are canonical maps $\chi_E : X \ra \V$ and $q_E : E \ra\VV$ making a pullback square as follows.
%\begin{equation}\label{diagram:U6}
%\xymatrix{
%E \ar[d]_{p_E} \ar[r]^{q_E}  \pbcorner & \VV\ar[d]^{p}  \\
%X \ar[r]_{\chi_E} & \V
%}
%\end{equation}
%Moreover, $\chi_E$ and $q_E$ are uniquely determined by the equations \eqref{eqns:U} below.
%\end{proposition}
%
%\begin{proof}
%Write $X = \varinjlim_{x} \I^n$ as a colimit of a cocone of maps $ x : \I^n \ra X$ from representables, over the canonical index category $([n],x) \in \int_\C X$.  Form the family of pullback squares below, where the arrows with a dot represent cocones, and the cocone consisting of the $q_x : E_x \ra E$  is determined by taking pullbacks along $p_E$, and is therefore also a colimit. 
%\begin{equation}\label{diagram:U7}
%\xymatrix@=3em{
%E_x \ar[d]_{p_{E_x}} \ar[r]_{\cdot}^{q_x} \ar@/^2.0pc/[rr]^{q_{E_x}} \pbcorner & E \ar[d]_{p_{E}} \ar@{..>}[r]^{q_E} & \VV\ar[d]^{p}  \\
%\I^n \ar@/_2.0pc/[rr]_{\chi_{E_x}}  \ar[r]^{\cdot}_x & X \ar@{..>}[r]_{\chi_E} & \V
%}
%\end{equation}
%The maps $\chi_{E_x}$  and $q_{E_x}$ are determined by lemma \ref{charforfamovercube}, since the families $p_{E_x}$ are small if $p_E: E \ra X$ is.  Thus we can define the indicated maps $\chi_E$ and $q_E$ from the colimits as those uniquely determined by the equations:
%\begin{align}\label{eqns:U}
%\chi_E \circ x &= \chi_{E_x}\\
%q_E \circ q_{x} &= q_{E_x}
%\end{align}
%The square on the right is a pullback because the outer squares are all pullbacks,  the family of left-hand squares are pullbacks, and the family of maps $x : \I^n \ra X$ covers $X$.
%\end{proof}
%
%\begin{remark} 
%Note that the classification operation $$\chi : \cSet_\kappa/X \ra \cSet(X, \V)$$ again has the evident ``pullback of $p : \VV\ra\V$'' operation 
%$$E : \cSet(X, \V) \ra \cSet_\kappa/X $$ as a left (quasi-)inverse $
%E \cong E_{\chi_E}$, which is (pseudo-)natural in $X$. 
%But there is no corresponding uniqueness of classifying maps, relating $A : X\ra \V$ and $\chi_{E_A} : X\ra\V$.  (This is what is provided, in a suitable sense, by the \emph{univalence} of the universe $\UU\ra\U$ of fibrations, to be established in section \ref{sec:EEP}.)
%\end{remark}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Classifying trivial fibrations}

Returning now to the presheaf category $\cSet = \psh{\Box}$ of cubical sets, recall from section \ref{sec:cofibrations} that (uniform) trivial fibration structures on a map $A\ra X$ correspond bijectively to relative +-algebra structures over $X$ (definition \ref{def:+alg}).  A relative $+$-algebra structure on $A \ra X$ is an algebra structure for the pointed endofunctor $+_X : \cSet/X \ra \cSet/X$, where recall from \eqref{eq:partialmapclassifier}, 
\[
A^+ = \sum_{\varphi:\Phi}A^{[\varphi]}\quad\text{over $X$}.
\]
A +-algebra structure is then a retract $\alpha : A^+\ra A$ over $X$ of the canonical map $\eta_A : A\ra A^+$,
\begin{equation}\label{eq:Aplus}
\xymatrix{
A\ar[rd] \ar[r]^{\eta_A} \ar@/^6ex/ [rr]^= & A^+ \ar[r]^{\alpha} \ar[d]& \ar[ld]A \\
& X. &
}
\end{equation}
In more detail, let us write $A\ra X$ as a family $(A_x)_{x\in X}$, so that $A=\sum_{x:X}A_x \ra X$. Since the +-functor acts fiberwise, the object $A^+$ in \eqref{eq:Aplus} is then the indexing projection
\[
\sum_{x:X}A^+_x \ra X.
\]
Working in the slice  $\cSet/X$, the (relative) exponentials (internal Hom's) $[A^+, A]$ and $[A, A]$ and the ``precomposition by $\eta_A$'' map $[\eta_A, A]$,  fit into the following pullback diagram 
\begin{equation}\label{diag:plualgstru}
\xymatrix{
+\mathsf{Alg}(A)\ar[d] \ar[r] \pbcorner & [A^+, A] \ar[d]^{[\eta_A, A]}\\
1 \ar[r]_{'{id_A}'} & [A, A].
}
\end{equation}
The constructed object $+\mathsf{Alg}(A) \ra X$ over $X$ is then the \emph{object of +-algebra structures on $A\ra X$}, in the sense that sections $X \ra +\mathsf{Alg}(A)$ correspond uniquely to +-algebra structures on $A\ra X$. Moreover, $+\mathsf{Alg}(A) \ra X$ is stable under pullback, in the sense that for any $f:Y\ra X$, we have two pullback squares,
\begin{equation}\label{diagram:pbplus}
\xymatrix{
f^*A \ar[d] \ar[r]  & A \ar[d]\\
Y \ar[r]_{f} &X\\
+\mathsf{Alg}(f^*A)\ar[u] \ar[r] & +\mathsf{Alg}(A)\ar[u].
}
\end{equation}
because the +-functor, exponentials and pullbacks occurring in the construction of $+\mathsf{Alg}(A) \ra X$ are themselves all stable. 

It then follows from Proposition \ref{prop:familyclassifier} that, if $A\ra X$ is small, then $+\mathsf{Alg}(A) \ra X$ is itself a pullback of the analogous object $+\mathsf{Alg}(\VV) \ra \V$ constructed from the universal small family $\VV\ra\V$ of Proposition \ref{prop:familyclassifier}, so there are two pullback squares:
\begin{equation}\label{diagram:tfib1}
\xymatrix{
A \ar[d] \ar[r]  & \VV \ar[d]\\
X \ar[r]_{\chi_A} & \V\\
+\mathsf{Alg}(A)\ar[u] \ar[r] & +\mathsf{Alg}(\VV)\ar[u].
}
\end{equation}

\begin{proposition}\label{prop:classTFib}
There is a \emph{universal small trivial fibration}  $$\TTFib\ra\TFib.$$  Every small trivial fibration $A \ra X$ is a pullback of $\TTFib\ra\TFib$ along a canonically determined classifying map $X\ra \TFib$.
\begin{equation}\label{diagram:classifytf}
\xymatrix{
A \ar[d] \ar[r]  \pbcorner & \TTFib\ar[d]\\
X \ar[r] & \TFib
}
\end{equation}
\end{proposition}

\begin{proof}
We can take $$\TFib := +\mathsf{Alg}(\VV),$$ which comes with its projection $+\mathsf{Alg}(\VV) \ra \V$ as in diagram \eqref{diagram:tfib1}.  Now define $p_t:\TTFib\ra\TFib$ by pulling back the universal small family,
\[
\xymatrix{
\TTFib \ar[d]_{p_t} \ar[r]  \pbcorner & \VV\ar[d]^p\\
\TFib \ar[r] & \V.
}
\]
Consider the following diagram, in which all the squares (including the distorted ones) are pullbacks, with the outer one coming from proposition \ref{prop:familyclassifier} and the lower one from \eqref{diagram:tfib1}.
%\[
%\xymatrix{
%A \ar[ddd] \ar[rrr]^{q_A} \pbcorner \ar@{.>}[rrd] &&& \VV\ar[ddd]^p\\
%& & \TTFib \ar[d]_{p_t} \ar[ru]  \pbcorner &\\
%& \TFib(A) \ar[ld] \ar[r] \pbcorner & \TFib \ar[rd] &\\
%X \ar[rrr]_{\chi_A} \ar@{.>}@/^.5pc/[ru]^\alpha \ar@{.>}[rru]_{\alpha'} &&& \V.
%}
%\]
\begin{equation}\label{diagram:classifytf2}
\xymatrix{
&A \ar[ddd] \ar[rrr]^{q_A}   \ar@{.>}[rrd] &&& \VV\ar[ddd]^p\\
& && \TTFib \ar[d]_{p_t} \ar[ru]  &\\
\TFib(A) \ar[rd] \ar[rrr] |<<<<<<<<<<<<\hole  &&& \TFib \ar[rd] &\\
&X \ar[rrr]_{\chi_A} \ar@{.>}@/^1pc/[lu]^\alpha \ar@{.>}[rru]_{\alpha'} &&& \V.
}
\end{equation}
A trivial fibration structure $\alpha$ on $A\ra X$ is a section the object of $+$-algebra structures on $A$, occurring in the diagram as $$\TFib(A) := +\mathsf{Alg}(A),$$ the pullback of $\TFib = +\mathsf{Alg}(\VV)$ along the classifying map $\chi_A : X \to \V$ for the small family $A\to X$.  Such sections correspond uniquely to factorizations $\alpha'$ of $\chi_A$ as indicated, which in turn induce pullback squares of the required kind \eqref{diagram:classifytf}.

Note that the map $p_t : \TTFib\ra\TFib$ has a canonical trivial fibration structure. Indeed, consider the following diagram, in which both squares are pullbacks.
\begin{equation}\label{diagram:fibisfib}
\xymatrix{
\TTFib \ar[d]_{p_t} \ar[r]  & \VV \ar[d]\\
\TFib \ar[r] & \V\\
\TFib(\TTFib) \ar[u] \ar[r] & \TFib(\VV)\ar[u].
}
\end{equation}
$\TFib(\VV)$ is the object of trivial fibration structures on $\VV\ra\V$, and its pullback $\TFib(\TTFib)$ is therefore the object of trivial fibration structures on $p_t : \TTFib\ra\TFib$.  Thus we seek a section of $\TFib(\TTFib) \ra \TFib$.  But recall that $\TFib = \TFib(\VV)$ by definition, so the lower pullback square is the pullback of $\TFib(\VV)\ra \V$ against itself, which does indeed have a distinguished section, namely the diagonal
\[
\Delta : \TFib(\VV) \ra \TFib(\VV)\times_\V\TFib(\VV).
\]
\end{proof}

We record the following notation and corresponding fact from the foregoing proof for future reference:

\begin{lemma}\label{lemma:TFibstable}
The classifying type $\TFib(A) := +\mathsf{Alg}(A) \to X$ for trivial fibration structures on a map $A\to X$  is stable under pullback, in the sense that for any $f:Y\ra X$, we have two pullback squares,
\begin{equation}\label{diagram:TFibstable}
\xymatrix{
f^*A \ar[d] \ar[r]  & A \ar[d]\\
Y \ar[r]_{f} &X\\
\TFib(f^*A)\ar[u] \ar[r] & \TFib(A)\ar[u].
}
\end{equation}
\end{lemma}

Since the universal small trivial fibration $\TTFib\ra\TFib$ in $\cSet$ from Proposition \ref{prop:classTFib} was constructed as $\TFib = \TFib(\VV)$ for the universal small family $\VV\to \V$, which in turn is stable under pullback by Corollary \ref{prop:familyclassifierforslices}, we also have: 

\begin{corollary}\label{por:classTFibslice}
The base change of the universal small trivial fibration  $$\TTFib\ra\TFib$$ in $\cSet$ along $\I^* : \cSet \to \cSet/_\I$ is a universal small trivial fibration in $\cSet/_\I$.
\end{corollary}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Classifying fibrations}\label{sec:universalfibration}

In order to classify fibrations $A\fib X$, we shall proceed as for trivial fibrations by constructing, for any map $A\ra X$, an object $\Fib(A)\to X$ of fibration structures which, moreover, is stable under pullback.  We then apply the construction to the universal small family $\VV\ra\V$ of Proposition \ref{prop:familyclassifier} to obtain a universal small fibration.    Here we will of course need to distinguish between biased and unbiased fibrations.  In Proposition \ref{Fibclassbiased}, we first construct a stable classifying type $\Fib(A)\ra X$ for $\delta$-biased fibration structures on any map $A\to X$ in $\cSet/_\I$ where $\delta$ is the generic point.    In Proposition \ref{Fibclassunbiased} we then transfer the construction along the base change $\I^* : \cSet \to \cSet/_\I$ to obtain a classifier $\Fib(A)\ra X$ for unbiased fibration structures on any $A\to X$ in~$\cSet$.

The construction of $\Fib(A)\ra X$ for biased fibration structures with respect to a point $\delta : 1\to \I$ is already a bit more involved than was that of $\TFib(A)\ra X$.  In particular, it requires the codomain $\I$ of $\delta$ to be \emph{tiny}, which is indeed the case for the generic point $\delta : 1 \to  \I^*\I$ in $\cSet/_\I$ by Lemma~\ref{lemma:tinyslicedI}.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{The classifying type of biased fibration structures.}

A classifying type $\Fib(A)\ra X$ of (uniform, $\delta$-biased) fibration structures on a map $p: A\ra X$, 
as defined in Section \ref{sec:biasedfibration}, can be constructed as follows.

 \begin{enumerate}
%\item First, pull the map $p_A : A\ra X$ back  to $\cSet/_\I$ by applying the functor $\I\times (-) : \cSet \to \cSet/_\I$.  We may continue to write $p_A : A\ra X$ for the resulting map over $\I$. 

\item First form the pullback-hom $\pbh{\delta}{p} : A^\I \ra X^\I \times_X A$ with the point $\delta : 1\to \I$, as indicated in the following diagram.
\begin{equation}\label{diagram:fibU1}
\xymatrix{
A^\I \ar@/_4ex/ [rdd]_{(p_A)^\I} \ar@{.>}[rd]^{\delta\Rightarrow{p}} \ar@/^4ex/ [rrd]^{A^\delta} && \\
& X^\I \times_{X} A \ar[d] \ar[r] & A \ar[d]^{p} \\
& X^\I \ar[r]_{X^\delta} &  X 
}
\end{equation}

\item A fibration structure on $p : A\ra X$ is then a relative +-algebra structure on $\delta\Rightarrow p$ in the slice category over its codomain $X^\I \times_X A$. 
To construct a classifier for such structures, let us first relabel the objects and arrows in diagram \eqref{diagram:fibU1} as follows:
\begin{align*}
\epsilon &:= X^\delta : X^\I \ra X \\
A_\epsilon &:= X^\I \times_X A\\
%\epsilon_A &:= A^\delta\\
\epsilon_A &:= \delta\Rightarrow p
\end{align*}
so that the working part of \eqref{diagram:fibU1} becomes:
\begin{equation}\label{diagram:fibU2}
\xymatrix@=2em{
A^\I \ar[rd]_{\epsilon_A} && \\
& A_\epsilon\ar[d]_{p_\epsilon} \ar[r] \pbcorner & A \ar[d]^{p} \\
& X^\I \ar[r]_{\epsilon} &  X 
}
\end{equation}

\item Now a relative +-algebra structure on $\epsilon_A$ (Definition \ref{def:+alg}) is a retract $\alpha$ over $A_\epsilon$ of the unit $\eta$, as indicated below, where $D$ is simply the domain of the map $(\epsilon_A)^+$ resulting from applying the relative +-functor in the slice category over $A_\epsilon$ to the object $\epsilon_A$.
\begin{equation}\label{diagram:fibU3}
\xymatrix{
A^\I \ar[rd]_{\epsilon_A} \ar[r]_\eta & \ar@{.>}@/_1pc/[l]_\alpha D \ar[d]^{(\epsilon_A)^+} & \\
& A_\epsilon\ar[d]_{p_\epsilon} \ar[r] \pbcorner & A \ar[d]^{p} \\
& X^\I \ar[r]_{\epsilon} &  X 
}
\end{equation}

\item As in the construction \eqref{diag:plualgstru}, there is an object $\TFib(\epsilon_A) = +\mathsf{Alg}(\epsilon_A)$ over  $A_\epsilon$ of relative +-algebra structures on $\epsilon_A$, the sections of which correspond uniquely to relative +-algebra structures on $\epsilon_A$ (and thus to fibration structures on $A$).
\begin{equation}\label{diagram:fibU4}
\xymatrix{
&A^\I \ar[d]_{\epsilon_A} \ar[r]_\eta & \ar@{.>}@/_1pc/[l]_\alpha D \ar[ld]^<<<<<{(\epsilon_A)^+}  \\
\TFib(\epsilon_A) \ar[r] & A_\epsilon\ar[d]_{p_\epsilon} \ar[r] \pbcorner & A \ar[d]^{p} \\
& X^\I \ar[r]_{\epsilon} &  X 
}
\end{equation}

\item Sections of $\TFib(\epsilon_A)\too A_\epsilon$ then correspond to sections of its push-forward along $p_\epsilon$, which we shall call $F_A$: 
\[
F_A := (p_\epsilon)_*\TFib(\epsilon_A)\,.
\]

\begin{equation}\label{diagram:fibU5}
\xymatrix{
&A^\I \ar[d]_{\epsilon_A} \ar[r]_\eta & \ar@{.>}@/_1pc/[l]_\alpha D \ar[ld]^<<<<<{(\epsilon_A)^+}  \\
\TFib(\epsilon_A) \ar[r] & A_\epsilon\ar[d]_{p_\epsilon} \ar[r] \pbcorner & A \ar[d]^{p} \\
F_A \ar[r] & X^\I \ar[r]_{\epsilon} &  X 
}
\end{equation}

\item One might now try taking another pushforward of $F_A \ra X^\I$ along $\epsilon : X^\I\ra X$ to get the object $\Fib(A) \ra X$ that we seek, but unfortunately, this would not be stable under pullback along arbitrary maps $Y\ra X$, because the evaluation $\epsilon = X^\delta : X^\I \ra X$ is not stable in that way.  Instead we use the \emph{root} functor, i.e.\ the right adjoint of the pathspace, $(-)^\I \dashv (-)_\I$ (Proposition \ref{prop:Itiny}). 

Let $f : F_A \ra X^\I$ be the map $(p_\epsilon)_*\TFib(\epsilon_A)$ indicated in \eqref{diagram:fibU5}, and let $\eta : X \ra (X^\I)_\I$ be the unit of the root adjunction at $X$.  Then define $\Fib(A)\ra X$ by 
$$ \Fib(A) :=  \eta^*{f_\I}$$
 as indicated in the following pullback diagram.
\begin{equation}\label{diagram:fibU6}
\xymatrix{
  \Fib(A)  \ar[d] \ar[r] \pbcorner & (F_A)_\I \ar[d]^{f_\I}\\
  X \ar[r]_{\eta} &  (X^\I)_\I
}
\end{equation}
By adjointness, sections of $\Fib(A)\ra X$ then correspond bijectively to sections of  $f : F_A \ra X^\I$.  
\end{enumerate}

\begin{lemma}\label{lemma:classtypebiasedfibstruct}
For any map $A\ra X$ in $\cSet/_\I$, the map $\Fib(A)\ra X$  in \eqref{diagram:fibU6} is a \emph{classifying type for $\delta$-biased fibration structures}: sections of $\Fib(A)\ra X$ correspond bijectively to $\delta$-biased fibration structures on $A\ra X$, and the construction is stable under pullback in the sense that for any $f:Y\ra X$, we have two pullback squares,
\begin{equation}\label{diagram:Fibstable}
\xymatrix{
f^*A \ar[d] \ar[r]  & A \ar[d]\\
Y \ar[r]_{f} &X\\
\Fib(f^*A)\ar[u] \ar[r] & \Fib(A)\ar[u].
}
\end{equation}
\end{lemma}

\begin{proof}
It is clear from the construction that fibration structures on $A\ra X$ correspond bijectively to sections of $\Fib(A)\ra X$. We show that $\Fib(A)\ra X$ is also stable under pullback.  To that end, the relevant steps of the construction are recalled schematically below.
\begin{equation}\label{diagram:fibU8}
\xymatrix{
&A^\I \ar[d]_{\epsilon_A} & &\\
\TFib(\epsilon_A) \ar[r] & A_\epsilon\ar[d]_{p_\epsilon} \ar[r] \pbcorner & A \ar[d]^{p} &\\
F_A \ar[r] & X^\I \ar[r]_{\epsilon} &  X & \ar[l] \Fib(A)
}
\end{equation}

Now consider the following diagram, in which the right hand side consists  of the data from  \eqref{diagram:fibU8}, and the front, central square is a pullback.
\begin{equation}\label{diagram:fibU9}
\xymatrix{
 & B^\I \ar[rrr] \ar[d]_{\epsilon_B} &&& A^\I \ar[d]^{\epsilon_A} &\\
 \TFib(\epsilon_B) \ar[r] & B_\epsilon \ar[d] \ar[rd] \ar@{.>}[rrr] &&& A_\epsilon \ar[d] \ar[ld] &  \TFib(\epsilon_A) \ar[l] \\
 F_B  \ar[r] & Y^\I \ar[rd] \ar@{.>}@/_.75pc/[rrr] & B \ar[r] \ar[d] & A \ar[d] &  X^\I \ar[ld]  & \ar[l] F_A \\
 &\Fib(B) \ar[r] & Y \ar[r]_f & X &\Fib(A) \ar[l] &
 }
\end{equation}
As in the proof of Lemma \ref{lemma:fibrationspullback}, on the left side we repeat the construction with $B \ra Y$ in place of $A\ra X$.  The left face of the indicated (distorted) cube is then also a pullback, whence the back (dotted) face is a pullback, since the two-story square in back is the image of the front pullback square under the right adjoint $(-)^\I$. Finally, the top rectangle in the back is therefore also a pullback.
 
It follows that $\TFib(\epsilon_B)$ is a pullback of $\TFib(\epsilon_A)$ along the upper dotted arrow, as in Lemma \ref{lemma:TFibstable}, and so the pushforward $F_B$ is a pullback of the corresponding $F_A$, along the lower dotted arrow (which is $f^\I$), by the Beck-Chevalley condition for the dotted pullback square.  Let us record this for later reference:
\begin{equation}\label{eq:pbFB}
F_B \cong (f^\I)^*F_A.
\end{equation}

It remains to show that $\Fib(B)$ is a pullback of $\Fib(A)$ along $f:Y\ra X$, and now it is good that we did not take these to be pushforwards of $F_B$ and $F_A$, because the floor of the cube need not be a pullback, and so the Beck-Chavalley condition would not apply.  Instead, consider the following diagram.
\begin{equation}\label{diagram:fibU10}
\xymatrix{
& \Fib(B) \ar[ld] \ar[dd]  \ar[r] & \Fib(A) \ar[dd] \ar[rd] & \\
(F_B)_\I \ar[dd] \ar[rrr] &&& (F_A)_\I \ar[dd] \\
& Y \ar[ld]_\eta \ar[r]_f & X \ar[rd]^\eta &\\
(Y^\I)_\I \ar[rrr]_{(f^\I)_\I} &&& (X^\I)_\I 
 }
\end{equation}
The sides of the cube are pullbacks by the construction of $\Fib(A)$ and $\Fib(B)$. The front face is the root of the pullback \eqref{eq:pbFB} and is thus also a pullback, since the root is a right adjoint. The base commutes by naturality of the unit of the adjunction, and so the back face is also a pullback, as required.  
\end{proof}

Now let us apply the foregoing construction of $\Fib(A)$ to the universal family $\VV\to\V$ to get $\Fib(\VV) \ra \V$, and define the universal small ($\delta$-biased) fibration in $\cSet/_\I$ by setting $\Fib : =\Fib(\VV)$ and $\FFib\fib\Fib$ by pulling back the universal family,
\begin{equation}\label{diagram:universalfib}
\xymatrix{
\FFib \ar[d] \ar[r]  \pbcorner & \VV\ar[d]^p\\
\Fib \ar[r] & \V.
}
\end{equation}
%
The proof of the following then proceeds just as that given for $\TTFib \to \TFib$ in Proposition \ref{prop:classTFib}.

\begin{proposition}\label{prop:UniversalFib}
The map $\FFib\ra\Fib$ constructed in \eqref{diagram:universalfib} is a \emph{universal small $\delta$-biased fibration} in $\cSet/_\I$: every small $\delta$-biased fibration $A \fib X$ in $\cSet/_\I$ is a pullback of $\FFib \fib \Fib$ along a canonically determined classifying map $X\ra \Fib$.
\begin{equation}\label{diagram:classifyfib}
\xymatrix{
A \ar@{>>}[d] \ar[r]  \pbcorner & \FFib \ar@{>>}[d] \\
X \ar[r] & \Fib
}
\end{equation}
\end{proposition}

\begin{remark}
Proposition \ref{prop:UniversalFib} made no use of the fact that we were working in the slice category $\cSet/_\I$ with $\delta : 1\to\I$ the generic point. It holds equally for $\delta$-biased fibrations with respect to any point $\delta: 1\to\I$ of a tiny object $\I$.  Thus \eg\ it could be used (with obvious adjustment) to construct a classifier for the $\{\delta_0, \delta_1\}$-biased fibrations of Section \ref{sec:biasedfibration} in (Cartesian, Dedekind, or other varieties of) cubical sets $\cSet$.  
\end{remark}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{The classifying type of unbiased fibration structures.}\label{par:classifyunbiasedfib} 

In order to classify \emph{unbiased} fibration structures on maps $A\to X$ in $\cSet$, we first apply the pullback $\I^*: \cSet \ra \cSet/_\I$ and take the classifier $\Fib(\I^*A)\ra \I^*X$ for $\delta$-biased fibration structures, then apply the pushforward $\I_*: \cSet/_\I \ra \cSet$ and pull the result   $\I_*\Fib(\I^*A)\ra \I_*\I^*X$ back along the unit  $X \to \I_*\I^*X$.  

To show that this indeed classifies unbiased fibration structures on $A\to X$, let us first rename the classifying type from Lemma \ref{lemma:classtypebiasedfibstruct}, which was constructed over $\I$, to $\Fib_i(\I^*A) \ra \I^{*}X$, and then apply $\I_*$ to get the map,
\[
\Pi_{i:\I}\Fib_i(\I^*A) := \I_*(\Fib_i(\I^*A)) \too X^\I
\]
in $\cSet$.  Then, as just said, we define the desired map $\Fib(A)\ra X$ as the pullback along the unit $\rho : X \ra X^\I$ of  $\I^*\dashv \I_*$ as indicated below.
\begin{equation}\label{diagram:fibU7}
\xymatrix{
 \Fib(A) \ar[d] \ar[r] \pbcorner & \ar[d] \Pi_{i:\I}\Fib_i(\I^*A) \\
 X \ar[r]_{\rho} &  X^\I
}
\end{equation}
It now immediately from the adjunction $\I^*\dashv \I_*$ that sections of $\Fib(A)\ra X$ correspond bijectively to sections of $\Fib_i (\I^*A)\ra \I^{*}X$ over~$\I$, and thus to \emph{unbiased} fibration structures on $A\to X$.

\begin{lemma}\label{lemma:classtypeunbiasedfibstruct}
For any map $A\ra X$ in $\cSet$, the map $\Fib(A)\ra X$ in \eqref{diagram:fibU7} is a \emph{classifying type for unbiased fibration structures}: sections of $\Fib(A)\ra X$ correspond bijectively to unbiased fibration structures on $A\ra X$, and the construction is stable under pullback in the expected sense (as in Lemma \ref{lemma:classtypebiasedfibstruct}).
\end{lemma}

\begin{proof} It remains only to check the stability, but since both of the adjoints in $\I^* \dashv \I_* : \cSet/_\I \ra\cSet$ preserve pullbacks, this follows easily from the fact that the classifying types $\Fib_i$ are stable under pullback by Lemma \ref{lemma:classtypebiasedfibstruct}.
\end{proof}

%The construction just applied can be formulated in greater generality:
%%
%\begin{proposition}\label{prop:transferclassifier}
%Let $f^*\dashv f_* : \FF \to \EE$ be a geometric morphism, and 
%\begin{equation}\label{diagram:classifyfib}
%\xymatrix{
%A \ar@{>>}[d] \ar[r]  \pbcorner & \FFib \ar@{>>}[d] \\
%X \ar[r] & \Fib
%}
%\end{equation}
%\end{proposition}
%


Finally, we can again take $\Fib := \Fib(\VV)$ to now obtain a universal small \emph{unbiased} fibration $\FFib\ra\Fib$ in $\cSet$, as in \eqref{diagram:universalfib}, and the proof can conclude just as in that for Proposition~\ref{prop:classTFib}.  

\begin{proposition}\label{prop:UniversalunbiasedFib}
The map $\FFib\ra\Fib$ just constructed is a \emph{universal small unbiased fibration} in $\cSet$: every small unbiased fibration $A \fib X$ is a pullback of $\FFib \fib \Fib$ along a canonically determined classifying map $X\ra \Fib$.
\begin{equation}\label{diagram:classifyfib}
\xymatrix{
A \ar@{>>}[d] \ar[r]  \pbcorner & \FFib \ar@{>>}[d] \\
X \ar[r] & \Fib
}
\end{equation}
\end{proposition}

%\begin{definition}\label{def:U}
%Write $\UU \fib \U$ for the universal small fibration $\FFib\fib\Fib$ of \eqref{diagram:universalfib}, as shown by Proposition~\ref{prop:UniversalFib}.
%\end{definition}

\begin{remark}\label{sliceuniversalfibrations}
Recall from Proposition \ref{prop:familyclassifierforslices} that the universe in the slice category $\cSet/_\I$ is the pullback of the universe $\V$ from $\cSet$ along the base change $\I^* : \cSet \to \cSet/_\I$.  Thus in the construction just given of the classifier $\FFib\ra\Fib$ for unbiased fibrations in $\cSet$  we are first building the classifying type $$\Fib_i(\I^*\VV) \to \I^*\V$$ for $\delta$-biased fibration structures on the universal family in $\cSet/_\I$, and then taking a pushforward $\I_*: \cSet/_\I \to \cSet$ to obtain the (base of the) classifier for unbiased fibrations as the pullback along the unit:
\begin{equation}\label{diagram:fibUuniversal}
\xymatrix{
 \Fib(\VV) \ar[d] \ar[r] \pbcorner & \ar[d] \Pi_{i:\I}\Fib_i(\I^*\VV) \\
 \V \ar[r]_{\rho} &  \V^\I
}
\end{equation}
We remark for later reference that this classifying type $\Fib = \Fib(\VV) \to \V$ for unbiased fibration structures can therefore be constructed as the pushforward of the classifier $\Fib_i(\I^*\VV) \to \I^*\V$ for $\delta$-biased fibration structures along the projection $q : \I^*\V =  \I\times \V \to \V$ indicated below.
\begin{equation}\label{diagram:fibUuniversal2}
\xymatrix{
 \Fib_i(\I^*\VV) \ar[d] &  \Fib(\VV) \ar[d] \ar[r] \pbcorner & \ar[d] \Pi_{i:\I}\Fib_i(\VV) \\
 \I^*\V \ar[r]_q \ar[d] \pbcorner & \V \ar[r]_{\rho} \ar[d] &  \V^\I\\
 \I \ar[r] & 1
}
\end{equation}
We record this fact as:
\begin{corollary}\label{cor:Fibaspushforwardalongq}
$\Fib = \Sigma_{\V}\,q_* \Fib_i(\I^*\VV).$
\end{corollary}

The reader may also find it illuminating to reconsider the construction of the universal small unbiased fibration in more type theoretic terms.  
It was defined to be $\FFib\fib\Fib = \Fib(\VV)$, for the universal family $\VV \to \V$, with $\FFib$ the pullback of $\VV \to \V$ along the canonical projection $\Fib(\VV)\to\V$. Since, type theoretically, we have $\VV = \Sigma_{A:\V}A$, by the stability of the classifying type $\Fib(-)$ we can  write $\Fib = \Sigma_{A:\V}\Fib(A)$ so that:
\[
\FFib = \Sigma_{A:\V}\Fib(A)\times A\ \too\ \Sigma_{A:\V}\Fib(A)\ =\ \Fib \,.
\]
\end{remark}



%\begin{lemma}\label{lemma:Fibfib}
%The map $\FFib\ra\Fib$ just constructed has a canonical fibration structure.
%\end{lemma}
%\begin{proof}
%Consider the following diagram, in which both squares are pullbacks.
%\begin{equation}\label{diagram:fibisfib}
%\xymatrix{
%\FFib \ar[d] \ar[r]  & \VV \ar[d]\\
%\Fib \ar[r] & \V\\
%\Fib(\FFib) \ar[u] \ar[r] & \Fib(\VV)\ar[u].
%}
%\end{equation}
%$\Fib(\VV)$ is the object of fibration structures on $\VV\ra\V$, and its pullback $\Fib(\FFib)$ is therefore the object of fibration structures on $\FFib\ra\Fib$.  Thus we seek a section of $\Fib(\FFib) \ra \Fib$.  But recall that $\Fib = \Fib(\VV)$ by definition, so the lower pullback square is the pullback of $\Fib(\VV)\ra \V$ against itself, which does indeed have a distinguished section, namely the diagonal
%\[
%\Delta : \Fib(\VV) \ra \Fib(\VV)\times_\V\Fib(\VV).
%\]
%\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Realignment for fibration structure}\label{sec:realignment}

The realignment for families of Proposition \ref{prop:realignment} will need to be extended to (structured) fibrations. Our approach makes use of the notion of a \emph{weak proposition}.  Informally, a map $P\to X$ may be said to be a weak proposition if it is ``conditionally contractible'', in the sense that it is contractible if it has a section (recall that a proposition may be defined as a fibration that is ``contractible if inhabited'').  More formally, we have the following.

\begin{definition}
A map $P\to X$ is said to be a \emph{weak proposition} if the projection $P\times_X P\to P$ is a trivial fibration.
\begin{equation}\label{diagram:weakprop}
\begin{tikzcd}
P^2 \ar[d,two heads,swap,"{\sim}"] \ar[r]  \pbmark & P \ar[d] \\
P \ar[r] &  X.
\end{tikzcd}
\end{equation}
Note that if either projection is a trivial fibration, then both are.
\end{definition}

As an object over the base, a weak proposition is thus one that ``thinks it is contractible''.  The key fact needed for realignment is the following.

\begin{lemma}\label{lemma:Fibweakprop} For any $A\to X$, the classifying type $\TFib(A) \to X$ is a weak proposition.  Moreover, the same is true for $\Fib(A)\to X$ (both the biased and unbiased versions) if the cofibrations are closed under exponentiation by the interval $\I$.
%, in the sense that $c:A \cof B$ implies
%\[
%c^\I:A^\I \cof B^\I\,.
%\]
\end{lemma}
%
%
\begin{proof}
Let $A\to X$ and consider the following diagram, in which we have written $A' = \TFib(A)\times_X A$ and $\TFib(A)^2 = \TFib(A)\times_X \TFib(A)$.
%
\begin{equation}\label{diagram:TFibweakprop}
\begin{tikzcd}
A' \ar[dd]  \ar[rr] \pbmark && A \ar[dd]  \\
& \TFib(A)^2 \ar[ld] \ar[rr]  \pbmark && \TFib(A) \ar[ld] \\
\TFib(A) \ar[rr] && X
\end{tikzcd}
\end{equation}
Since $\TFib$ is stable under pullback (by Lemma \ref{lemma:TFibstable}), we have $\TFib(A)^2 \cong \TFib(A')$, and since $\TFib(A)^2$ has a canonical section, $A' \to \TFib(A)$ is therefore a trivial fibration.  Inspecting the definition of $\TFib(A) = +\mathsf{Alg}(A)$ in \eqref{diag:plualgstru}, we see that if a map $A\to X$ is a trivial fibration, then so is $\TFib(A)\to X$ (since $\eta : A\to A^+$ is always a cofibration). Thus $\TFib(A)^2 \cong \TFib(A') \to\TFib(A)$ is also a trivial fibration.

For $\Fib(A)\to X$, with reference to the construction \eqref{diagram:fibU8} we use the foregoing to infer that $\TFib(\epsilon_A) \to A_\epsilon$ is a weak proposition, and so therefore is its pushforward $F_A = (p_\epsilon)_*\TFib(\epsilon_A)\to X^\I$ along the projection $p_\epsilon : A_\epsilon = X^I\times_X A \to X^\I$, since pushforward clearly preserves weak propositions.  Applying the root $(-)_\I$ preserves trivial fibrations, by the assumption that its left adjoint $(-)^\I$ preserves cofibrations, and so, as a right adjoint, it also preserves weak propositions. Therefore $(F_A)_\I \to (X^\I)_\I$ is a weak proposition, but then so is its pullback along the unit $X\to (X^\I)_\I$, which is $\Fib_i(A)\to X$, the classifier for $\delta$-biased fibration structures.  The same reasoning shows that $\Fib(A) = \rho^*\Pi_{i:\I}\Fib_i(\I^*A)$ (as in \eqref{diagram:fibU7}) is also a weak proposition.
\end{proof}

In light of Lemma \ref{lemma:Fibweakprop} we shall assume as a final axiom on cofibrations:
 
\begin{enumerate}
\item[(C8)] The pathobject functor preserves cofibrations: thus $c:A \cof B$ implies $c^\I:A^\I \cof B^\I$.
\end{enumerate}

Now, by Propositions \ref{prop:UniversalFib} and \ref{prop:UniversalunbiasedFib} we have universal small $\delta$-biased and unbiased fibrations, the former in $\cSet/_\I$, the latter in $\cSet$.  The following remarks apply to both, which we refer to neutrally as $\UU \fib \U$.  The base object $\U$ is (the domain of) the classifying type $\mathsf{Fib}(\VV) \to \V$, where $\VV \to \V$ is the universal small family.  Type theoretically, this object can be written as
\[
\U = \Sigma_{E:\V}\Fib(E)\,,
\] 
which comes with the canonical projection
\[
\U = \Sigma_{E:\V}\Fib(E) \too \V\,.
\] 
In these terms, a fibration $E \fib X$ is a pair $\langle E, e \rangle$, consisting of the underlying family $E\to X$, equipped with a fibration structure $e :\Fib(E)$.
%
\noindent Lemma \ref{lemma:Fibweakprop}  then allows us to establish the following, which was first isolated in \cite{Shu:UAERP}  (as condition (2'), also see \cite{Shu:15}). It holds for both biased and unbiased fibrations, and will be used in the sequel to ``correct'' the fibration structure on certain maps.

\begin{lemma}[Realignment for fibrations]\label{lemma:realignmentforfibrations}
Given a fibration $F\fib X$ and a cofibration $c : C\cof X$, let $f_c : C \to \U$ classify the pullback $c^*F\fib C$.  Then there is a classifying map $f: X \to \U$ for $F$ with $f\circ c = f_c$.
%
\begin{equation}\label{diagram:fibrationrealignment}
\begin{tikzcd}
c^*F \ar[dd, two heads] \ar[rd] \ar[rr] && \UU \ar[dd, two heads] \\
& F \ar[dd, two heads] \ar[ru, dotted] & \\
C  \ar[rd, tail,swap, "c"] \ar[rr, near start, "f_c"] && \U  \\
& X \ar[ru, dotted, swap, "f"] &
\end{tikzcd}
\end{equation}
\end{lemma}
%
\begin{proof}
First, let $|f_{c}|: C\to \V$ be the composite of $f_c: C\to \U$ with the canonical projection $\U\to \V$, thus classifying the underlying family $c^*F \to C$.  Next, let $f_0 : X\to \V$ classify the underlying family $F\to X$.  We may assume that $f_0\circ c = |f_{c}|$ by realignment for families, Proposition \ref{prop:realignment}.
%
\begin{equation}\label{diagram:fibrationrealignment2}
\begin{tikzcd}
c^*F \ar[dd, two heads] \ar[rd] \ar[rr] && \UU \ar[dd, two heads] \ar[r] & \VV \ar[dd] \\
& F \ar[dd, two heads] \ar[rru, dotted] & &\\
C  \ar[rd, tail,swap, "c"] \ar[rr, near start, "f_c"] && \U \ar[r] & \V \\
& X \ar[rru, dotted, swap, "f_0"] &
\end{tikzcd}
\end{equation}
%
Since $F\fib X$ is a fibration, there is a lift $f_1 : X \to \U$ of $f_0$ classifying the fibration structure.
We thus have the following commutative diagram in the base of \eqref{diagram:fibrationrealignment2}.
%
\begin{equation}\label{diagram:realignmentproof}
\begin{tikzcd}
C  \ar[d, tail,swap, "c"] \ar[r,swap, "{f_c}"] \ar[rr, bend left, "{|f_{c}|}"] & \U \ar[r] & \V \ar[d, equals]  \\
X \ar[r, "f_1"]  \ar[rr,swap,bend right, "f_0"] & \U \ar[r]  & \V
\end{tikzcd}
\end{equation}
%
Now pull $\U\to \V$ back against itself and rearrange the previous data to give (the solid part of) the following, which also commutes.
\begin{equation}\label{diagram:realignmentproof2}
\begin{tikzcd}
C \ar[d, tail, swap, "{c}"] \ar[rr, swap, "{\langle f_{1}c, f_c \rangle}"]  \ar[rrr, bend left, "{f_{c}}"] 
	&& \U\times_\V \U \ar[r, swap, "{\pi_2}"] \ar[d, two heads, swap, "{\pi_1}"] \pbmark & \U \ar[d]  \\
X \ar[rr,swap, "{f_1}"] \ar[rru, dotted, swap, "{f_2}"]  \ar[rrr,swap, bend right, "{f_0}"] && \U \ar[r]  & \V
\end{tikzcd}
\end{equation}
Since $\U=\Fib(\VV)\to\V$ is a weak proposition by Lemma \ref{lemma:Fibweakprop} and (C8), the projection $\pi_1: \U\times_\V \U \fib \U$ is a trivial fibration, so there is a diagonal filler $f_2 : X\to \U\times_\V \U$ as indicated.  Taking $f := \pi_2\circ f_2 : X\to \U\times_\V \U \to \U$ gives another classifying map for the fibration structure on $F\to X$, for which $f\circ c =  f_c$ as required.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The equivalence extension property}\label{sec:EEP}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

The equivalence extension property is closely related to the \emph{univalence} of the universal fibration $\UU\fib\U$ constructed in section \ref{sec:universalfibration} (see \cite{Shu2015}).  It will be used in section \ref{sec:FEP} to show that the base object $\U$ is fibrant.  The proof of the equivalence extension property given here is a reformulation of a type-theoretic argument due to Coquand \cite{CCHM}, which in turn is a modification of the original argument of Voevodsky \cite{KLV}.  See \cite{sattler} for another reformulation.  

In this section we are interested mainly in \emph{unbiased} fibrations in $\cSet$. 
Thus for the remainder of this section ``fibration'' unqualified will always mean ``unbiased fibration in $\cSet$''.  

We first recall some basic facts and make some simple observations. 
For any object $Z \in\cSet$, the slice category $\cSet/_Z$ inherits the premodel structure of Proposition \ref{prop:FWC} from $\cSet$ via the forgetful functor $\Sigma_Z : \cSet/_Z \to \cSet$.  Thus a map $f : X \to Y$ over $Z$ is a (trivial) cofibration, weak equivalence, or (trivial) fibration, over $Z$ just if it is one in $\cSet$ after forgetting the $Z$-indexing. We shall call this the \emph{sliced premodel structure} on $\cSet/_Z$.  The reader is warned that when $Z = \I$ there a possibility of confusion with the $\delta$-biased fibrations in $\cSet/_\I$, which do not in general agree with the sliced fibrations.  

For any map $f :X\ra Y$ in $\cSet$, recall the \emph{pathspace factorization} $f = t\circ s$ indicated below.
%\begin{equation}\label{diag:pathspace factorization}
%\xymatrix{
%X \ar[r]^-s \ar[dd]_= & f^*(Y^\I)  \ar[d] \ar[rr] \pbcorner && Y^\I \ar[d] \ar[rd] & \\
%& X\times Y \ar[d] \ar[rr]  \pbcorner && \ar[d]^{p_1} Y\times Y \ar[r]_-{p_2}& Y\\
%X \ar[r]_= & X \ar[rr]_f  && Y &\\
%}
%\end{equation}
%\begin{equation}\label{diag:pathspace factorization}
%\xymatrix{
%X \ar@/_1.5pc/[dd]_= \ar[d]^s \ar[rr]^f \pbcorner && Y \ar[d]_r \ar[rd]^=\\
%P_f  \ar[d]^{p_f} \ar[rr]^{p_0^*f}  \pbcorner && Y^\I \ar[d]_{p_0} \ar[r]^-{p_1} & Y \\
%X \ar[rr]_f  &&  Y &
%}
%\end{equation}
\begin{equation}\label{diag:pathspace factorization}
\xymatrix{
X \ar@/_1.5pc/[ddd]_= \ar[d]^s \ar[rr]^f \pbcorner && Y \ar[d]_r \ar[rrd]^=\\
P_f  \ar[dd]^{p_f} \ar[rr]^{p_0^*f} \ar@{.>}@/_1.5pc/[rrrr]_<<<<<<<<<<<<<<<t \pbcorner && Y^\I \ar[dd]_{p_0} \ar[rr]^-{p_1} && Y \\
\\
X \ar[rr]_f  &&  Y &
}
\end{equation}
Here $p_0, p_1$ are the evaluations $Y^{\delta_{0}}, Y^{\delta_{1}}$ at the endpoints $\delta_0, \delta_1 : 1\ra\I$, and let $r:= Y^!$ for $! : \I\ra 1$, so that $p_0r = p_1r = 1_Y$.  Then let  $p_f := f^*p_0 : P_f \ra Y$, the pullback of $p_0$ along $f$, and $s:= f^*r : X\ra P_f$ (over $X$).  Finally, let $t:= p_1\circ p_0^*f : P_f \ra Y$ be the indicated horizontal composite. 
The following facts are well-known in general, but still need to be checked in this particular case.
\begin{enumerate}
\item If $f:X\ra Y$ is a map over a base $Z$ in $\cSet$, we instead use the relative pathobject $Y^\I \to Z$, where the exponential is taken in the slice over $Z$, and the interval in the exponent is the result of pulling the interval $\delta_0, \delta_1 : 1\ra\I$ from $\cSet$ back along $Z\to 1$. The factorization $t\circ s:X\ra P_f \ra Y$ is then stable under pullback along any map $g : Z' \ra Z$, in the sense that $g^*(Y^\I) \cong g^*(Y)^\I$ and so $g^*P_f = P_{g^*f}$, where $g^*f : g^*X \ra g^* Y$, and similarly for the factors $g^*s$ and~$g^*t$.  

\item The retraction $p_0\circ r = 1_Y$ pulls back along $f$ to a retraction $p_f \circ s =1_X$.

\item If $Y$ is a fibrant object, then $p_0 , p_1 : Y^\I \ra Y$ are both trivial fibrations by Proposition \ref{prop:sanitycheck}.  If $f:X\ra Y$ is over a base $Z$ and $Y$ is fibrant over $Z$, then the maps $p_0 , p_1 : Y^\I \ra Y$ over $Z$ are also trivial fibrations, again by Proposition \ref{prop:sanitycheck}\ednote{add a proof}.  In that case, the pullback $p_f : P_f \ra X$ (which is also a map over $Z$) is also a trivial fibration. 

\item If $X$ and $Y$ are both fibrant (over any base $Z\in \cSet$), then $t= p_1\circ p_0^*f : P_f \ra Y$ is a fibration.  This can be seen by factoring the maps $p_0, p_1 :Y^\I \rightrightarrows  Y$ through the product projections as $\pi_0\circ p, \pi_1\circ p : Y^\I \ra Y\times Y \rightrightarrows Y$, with $p = (p_0, p_1)$, and then interpolating the pullback along the map $(f,1_X) : X\times Y\ra Y\times Y$ into \eqref{diag:pathspace factorization} as indicated below.
\begin{equation}\label{diag:pathspace factorization2}
\xymatrix{
& X \ar[d]^s \ar[rr]^f \pbcorner && Y \ar[d]_r \\
& \ar[ld]_t P_f  \ar[d]^{f^*p} \ar[rr]^{p_0^*f} \pbcorner && Y^\I \ar[d]_{p} \ar[rd]^{p_1}\\
Y & \ar[l]^-{\pi'_1} X\times Y\ar[d]_-{\pi'_0} \ar[rr]_{(f,1_Y)} \pbcorner  &&  Y\times Y \ar[d]^{\pi_0} \ar[r]_-{\pi_1} & Y \\
& X \ar[rr]_f  &&  Y &
}
\end{equation}
The second factor $t = p_1\circ p_0^*f : P_f \ra Y$ now appears also as $\pi_1\circ(f,1_Y)\circ f^*p$, which is the pullback $f^*p: P_f \ra X\times Y$ followed by the second projection $\pi'_1 : X\times Y \ra Y$ (which is not a pullback). But if $Y$ is fibrant, then $p : Y^\I \ra Y\times Y$ is a fibration, and then so is $f^*p$. And if $X$ is fibrant, then the projection $\pi'_1:X\times Y \ra Y$ is a fibration. Thus in this case, $t = \pi'_1\circ f^*p : P_f \ra Y$ is a fibration, as claimed.

\item Summarizing (1)-(4), for any map $f : X\ra Y$ (over any base $Z\in \cSet$), we have a stable factorization $f = t\circ s : X\ra P_f \ra Y$, in which $s$ has a retraction $p_f$, which is a trivial fibration when $Y$ is fibrant, and $t$ is a fibration when both $X$ and $Y$ are fibrant.  \begin{equation}\label{diag:pathspace factorization3}
\xymatrix{
X \ar[r]^s \ar[rd]_f & \ar@{.>}@/_1.5pc/[l]_{p_f} P_f \ar[d]^t \\
& Y
}
\end{equation}
Note that the retraction $p_f : P_f \ra X$ is not over $Y$.
\end{enumerate}

The following simple fact concerning just the cofibration weak factorization system will also be needed.

\begin{lemma}\label{lemma:etaTF}
Let $p: E \onto B$ be a trivial fibration and $c : C\mono B$ a cofibration.  Then the unit $\eta:E \ra c_*c^*E$ of the base change $c^*\dashv c_*$ along $c$ is a trivial fibration.
\end{lemma}

\begin{proof}
The unit map $\eta:E \ra c_*c^*E$ is the pullback-hom $c\!\Rightarrow\! p$, as is easily checked.
By lemma \ref{lemma:Leibniz}, for any map $a : A \to Z$ we have the equivalence of diagonal filling conditions,
\[
a \pitchfork c\!\Rightarrow\!p  \quad\text{iff}\quad a\!\otimes\!c \pitchfork p.
\]
But since $c : C\mono B$ is a cofibration, $a\otimes c$ is also a cofibration if $a : A \mono Z$ is one, by axiom (C6), which says that cofibrations are closed under pushout-products.  So $a\otimes c \pitchfork p$ indeed holds, since $p$ is a trivial fibration.
\end{proof}

\begin{proposition}[EEP]\label{prop:EEP}
Weak equivalences extended along cofibrations in the following sense: given a cofibration $c:C' \mono C$ and fibrations $A'\onto C'$ and $B\onto C$, and a weak equivalence $w':A' \simeq c^*B$ over $C'$,
\begin{equation}\label{diag:EEP}
\xymatrix{
A' \ar@{->>}[dd] \ar[rd]_{\sim}^{w'} \ar@{..>}[rr] && A \ar@{..>>}[dd] \ar@{..>}[rd]_{\sim}^{w} \\
& c^*B \ar@{->>}[ld] \ar[rr]  && B \ar@{->>}[ld] \\
C' \ar@{>->}[rr]_c && C
}
\end{equation}
there is a fibration $A\onto C$ and a weak equivalence $w: A \simeq B$ over $C$ that pulls back along $c:C' \mono C$ to $w'$, so $c^*w = w'$.

\end{proposition}
%
\begin{proof}
Call the given fibration $q:B\ra C$ and let $b:=  q^*c : c^*B \ra B$ be the indicated pullback, which is thus also a cofibration. Let $w := b_*w' : A\ra B$ be the pushforward of $w'$ along $b$.  Composing with $q$ gives the map $p:= q\circ w:A\ra C$.  Since $b$ is monic, we indeed have $b^*w = w'$, thus filling in all the dotted arrows in \eqref{diag:EEP}.  Note moreover that $c^*w =  b^*w = w'$, as required. It remains to show that $p:A\ra C$ is a fibration and $w : A\ra B$ is a weak equivalence.   
\begin{equation}\label{diag:EEPfactored}
\xymatrix@=1.5em{
A' \ar@{->>}[dddd] \ar[rrdd]_{\sim}^{w'} \ar@{>->}[rrrr] && && A \ar[dddd]_>>>>>>>>>>>>p \ar[rrdd]^{w} \ar[rr]^s && \ar@{.>}@/_1.5pc/[ll]_{p_w} P_w \ar[dd]^t \\
\\
&& c^*B \ar@{->>}[lldd] \ar@{>->}[rrrr]_<<<<<<<<<<b  &&&& B \ar@{->>}[lldd]^q  \\
\\
C' \ar@{>->}[rrrr]_c &&&& C &&
}
\end{equation}
Let us rename $p':= c^*p : A' \ra C'$ and $B' := c^*B$ and $q':= c^*q$.
Now let $w=t\circ s$ be the pathspace factorization \eqref{diag:pathspace factorization} of $w$, as a map over $C$.  Since $q:B \ra C$ is a fibration, by the foregoing remarks on pathspace factorizations, we know that $s : A\ra P_w$ has a retraction $p_w : P_w \ra A$ which is a trivial fibration.  The retraction $p_w$ is a map over $C$.  

The pathspace factorization $w=t\circ s : A \ra P_w \ra B$ is stable under pullback along $c$, providing a pathspace factorization $w'=t'\circ s' : A' \ra P_{w'} \ra B'$ over $C'$.  Since both $p'$ and $q'$ are fibrations, the retraction $p_{w'}: P_{w'} \ra A'$ is a trivial fibration, and now $t' : P_{w'} \ra B'$ is a fibration.
\begin{equation}\label{diag:EEPfactored2}
\xymatrix@=1.5em{
A' \ar@{->>}[dddd]_{p'} \ar[rrdd]_{\sim}^{w'}  \ar[rr]^{s'} && \ar@{.>>}@/_1.5pc/[ll]_{p_{w'}} P_{w'} 
	\ar@{->>}[dd]^{t'} \\
\\
&& B' \ar@{->>}[lldd]^{q'} \\
\\
C' &&
}
\end{equation}
Thus the composite $q'\circ t' : P_{w'} \ra B' \ra C'$ is a fibration and therefore, by the retraction over $C'$ with the trivial fibration $p_{w'}$, we have that $s' : A' \ra P_{w'}$ is a weak equivalence, by 3-for-2 for weak equivalences between fibrations.  For the same reason, $t'$ is then a weak equivalence, and therefore a trivial fibration.

Since $t' = c^*t = b^*t$ is a trivial fibration, its pushforward $b_*b^*t$ along $b$ is also one by by Corollary \ref{cor:plusalgsection}.  Moreover, $b_*b^*t : b_*b^*P_w \ra B$ admits a unit $\eta : P_w \ra  b_*b^*P_w$ (over~$B$).  
\begin{equation}\label{diag:EEPfactored3}
\xymatrix@=1.5em{
A' \ar@{->>}[dddd] \ar[rrdd]_{\sim}^{w'} \ar@{>->}[rrrr] && && A \ar[dddd]_>>>>>>>>>>>>p \ar[rrdd]^{w} \ar[rr]^s && \ar@{.>}@/_1.5pc/[ll]_{p_w} P_w \ar[dd]^t \ar[rr]^-\eta && b_*b^*P_w \ar[lldd]^{b_*b^*t}\\
\\
&& B' \ar@{->>}[lldd] \ar@{>->}[rrrr]_<<<<<<<<<<b  &&&& B \ar@{->>}[lldd]^q &&&& \\
\\
C' \ar@{>->}[rrrr]_c &&&& C &&&&
}
\end{equation}
We now \emph{claim} that $\eta : P_w \ra  b_*b^*P_w$ is a trivial fibration.  Given that,  the composite $t = b_*b^*t \circ \eta$ is also a trivial fibration, whence $q\circ t : P_w \ra C$ is a fibration, and so its retract $p:A\ra C$ is a fibration.  Moreover, since $s$ is a section of the trivial fibration $p_w: P_w\ra A$ between fibrations, as before it is also a weak equivalence. Thus $w=t\circ s$ is a weak equivalence, and we are finished. 

To prove the remaining claim that $\eta : P_w \ra  b_*b^*P_w$ is a trivial fibration, we shall use lemma \ref{lemma:etaTF}.  It does not apply directly, however, since $t : P_w \ra B$ is not yet known to be a trivial fibration.  Instead, we show that $\eta$ is a pullback of the corresponding unit at the trivial fibration $p_1 : B^\I \ra B$.

Consider the following cube (viewed with $b:B'\ra B$ at the front).
\begin{equation}\label{diag:ppcube}
\xymatrix@=1.5em{
P_{w'} \ar@{->>}[ddd]_{p_{w'}} \ar[rrd]^{(p'_0)^*w'} \ar@{>->}[rrr]^{\overline{a}}
		&&& P_w \ar[ddd]^{p_w} \ar[rrd]^{p_0^*w} &&\\
&& B'^\I \ar@{->>}[ddd]_{p'_0} \ar@{>->}[rrr]^{\overline{b}}  
		&&& B^\I \ar@{->>}[ddd]^{p_0} \\
\\
A' \ar@{>->}[rrr]_>>>>>>>a  \ar[rrd]_{w'}
		&&& A \ar[rrd]^{w} &&\\
&& B'\ar@{>->}[rrr]_b &&& B
}
\end{equation}
The right hand face is a pullback by definition, and the remainder results from pulling the right face back along $b$, by the stability of the pathspace factorization \eqref{diag:pathspace factorization3}. Thus all faces are pullbacks.  The base is also a pushforward, $b_*w'=w$, again by definition.  Thus the top face is also a pushforward, $\overline{b}_*((p'_0)^*w')=p_0^*w$. Indeed, since the front face is a pullback, the Beck-Chevalley condition applies, and so we have $\overline{b}_*(p'_0)^*(w') = p_0^*\,b_*(w') = p_0^*w$.

Now consider the following, in which the top square remains the same as in \eqref{diag:ppcube}, but $p_0$ has been relaced by $p_1 : B^\I \ra B$, so the composite at right is by definition $t = p_1\circ p_0^*w$.
\begin{equation}\label{diag:twounits}
\xymatrix@=1.5em{
P_{w'} \ar@{->>}[ddddrr]_{t'} \ar[rrd]^>>>>>>{(p'_0)^*w'} \ar@{>->}[rrr]^{\overline{a}}
		&&& P_w \ar[ddddrr]_t \ar[rrd]^{p_0^*w} &&\\
&& B'^\I \ar@{->>}[ddd]^{p'_1} \ar@{>->}[rrr]^<<<<<<<<{\overline{b}}  
		&&& B^\I \ar@{->>}[ddd]^{p_1} \\
\\
\\
&& B'\ar@{>->}[rrr]_b &&& B
}
\end{equation}
The horizontal direction is still pullback along $b$; let us rename $p_0^*w=:u$ so that $(p'_0)^*w' = b^*u$ and $t' = b^*t$ and $p'_1 = b^*p_1$ to make this clear. We then add the pushforward along $b$ on the right, in order to obtain the two units $\eta$.
\begin{equation}\label{diag:twounits2}
\xymatrix@=1.5em{
b^*P_{w} \ar@{->>}[ddddrr]_{b^*t} \ar[rrd]^{b^*u} \ar@{>->}[rrr]^{\overline{a}}
		&&& P_w \ar[ddddrr]_t \ar[rrd]^{u} \ar[rr]^{\eta_t}
		&& b_*b^* P_w  \ar[rrd]^{b_*b^* u} \ar[ddddrr]_{b_*b^* t}&&\\
&& b^*B^\I \ar@{->>}[ddd]^{b^*p_1} \ar@{>->}[rrr]^<<<<<<<<<{\overline{b}}  
		&&& B^\I \ar@{->>}[ddd]^{p_1} \ar[rr]^{\eta_{p_1}} 
		&& b_*b^* B^\I \ar[ddd]^{b_*b^*p_1}\\
\\
\\
&& B'\ar@{>->}[rrr]_b &&& B  \ar[rr]_= && B
}
\end{equation}
By the usual calculation of pushforwards in slice categories, $\overline{b}_* \cong \eta_{p_1}^*\circ b_*$, and so for $b^*u$ we have $\overline{b}_*b^* u = \eta_{p_1}^*b_*b^* u$.  But as we just determined in \eqref{diag:ppcube} the top left square is already a pushforward, and therefore $u = \eta_{p_1}^*b_*b^* u$,  so the top right naturality square is a pullback. 

To finish the proof as planned, $p_1 : B^\I \ra B$ is a trivial fibration because $q : B\ra C$ is a fibration, and $b : B' \mono B$ is a cofibration because it is a pullback of $c : C'\mono C$.  Thus by lemma \ref{lemma:etaTF}, we have that $\eta_{p_1}: B^\I \ra  b_*b^*B^\I$ is a trivial fibration, and so its pullback $\eta_t : P_w \ra  b_*b^*P_w$ is a trivial fibration, as claimed.
\end{proof}

\begin{remark}
Note that $p : A \ra C$ is small if $q : B\ra C$ is small.
\end{remark}

%\ednote{
%Expected to use alignment here.  Also expected to need closure of cofibrations under $\Pi_\I$.
%}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The fibration extension property}\label{sec:FEP}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Given a universal fibration $\UU\fib\U$, such as $\FFib\fib\Fib$ of Proposition \ref{prop:UniversalunbiasedFib}, the fibration extension property (Definition \ref{def:fibextreplace}) is closely related to the statement that the base object $\U$ is fibrant.  For Kan simplicial sets, Voevodsky proved the latter directly using minimal fibrations \cite{VVuniverse}.   In a more general setting, Shulman \cite{Shulmanuniverse} gives a proof using univalence (in the form of the equivalence extension property as stated in section \ref{sec:EEP}), but that proof also uses the 3-for-2 property for weak equivalences, which we do not yet have. For cubical sets, Coquand \cite{CCHM} uses the equivalence extension property to prove that $\U$ is fibrant, without assuming 3-for-2 for weak equivalences, via a neat argument reducing box-filling to an operation of \emph{Kan-composition}.   We shall prove that $\U$ is fibrant using the equivalence extension property, also without assuming 3-for-2 for weak equivalences, via a different argument than that in \cite{CCHM}, one not using Kan composition.

%We give a formulation of this argument in an appendix \ref{App:Comp}.
%
%\begin{proposition}
%The universe $\U$ is fibrant.
%\end{proposition}
%By the reduction of filling to composition (Proposition \ref{prop:comptofillobj}), it suffices to show:
%\begin{lemma}
%The universe $\U$ has composition.
%\end{lemma}
%\begin{proof}
%Consider a composition problem
%\[
%\xymatrix{
%C \ar@{>->}[dd]_{c} \ar[rr]  && \U^\I \ar[d] \\
%&& \U\times \U\ar[d] \\
%Z \ar[rr]  \ar@{..>}[rru]^{k} && \U
%}
%\]
%We claim that the canonical map $\U^\I \ra \U\times \U$ factors over $\U\times\U$ through the object $\mathsf{Eq}$ 
%of equivalences, via a map $i$ as indicated below.
%\begin{equation}\label{diag:idtoeq}
%\xymatrix{
%C \ar@{>->}[ddd]_{c} \ar[rr]  && \U^\I \ar[d]^i \\
%&& \mathsf{Eq} \ar[d]  \\
%&& \U\times \U\ar[d] \\
%Z \ar[rr] \ar@{..>}[rruu]^{j}  \ar@{..>}[rru]^{k} && \U
%}
%\end{equation}
%Since the projection $\mathsf{Eq} \ra \U$ is a trivial fibration by the equivalence extension property \ref{fillinthereference}, there is a diagonal filler $j$.  Composing gives the required $k$.
%
%The claimed map $i$ is usually known as $\mathsf{IdtoEq}: \U^\I \ra \mathsf{Eq}$, and is defined in type theory by transport. 
%
%[ fill this in ...]
%
%\end{proof}
%

Returning to the relation between the fibration extension property and the fibrancy of the base object of the universal fibration $\UU\fib\U$, it is easy to see that the latter implies the former.  Indeed, let $t : X\cof X'$ be a trivial cofibration and $Y \fib X$ a fibration.  To extend $Y$ along $t$, take a classifying map $y : X \ra \U$, so that $Y \cong y^*\UU$ over $X$. If $\U$ is fibrant then we can extend $y$ along $t : X\cof X'$ to get $y' : X' \ra \U$ with $y = y'\circ t$.  The pullback $Y' = (y')^*\UU \fib X'$ is then a (small) fibration such that $t^*Y' \cong t^*(y')^*\UU\cong y^*\UU \cong Y$ over $X$.  
\[
\xymatrix{
Y \ar@{->>}[dd] \ar[rd] \ar[rr] && \UU \ar@{->>}[dd] \\
& Y' \ar@{->>}[dd] \ar@{..>}[ru] & \\
X  \ar@{>->}[rd]_t \ar[rr]_<<<<<<<<{y}  && \U  \\
& X' \ar@{..>}[ru]_{y'} &
}
\]
Thus, for the record, we have:

\begin{proposition}\label{prop:UfibtoFEP}
If the base object $\,\U$ of the universal fibration $\UU\fib\U$ is fibrant, then the fibration weak factorization system has the fibration extension property.
\end{proposition}

Conversely, given the Realignment Lemma \ref{lemma:realignmentforfibrations}, the fibration extension property also implies the fibrancy of $\U$:

\begin{corollary}
The fibration extension property implies that the base $\U$ of the universal fibration $\UU\fib\U$ is fibrant: given any $y : X \ra \U$ and trivial cofibration $t : X\cof X'$, there is a map $y' : X' \ra \U$  with $y'\circ t = y$.
\end{corollary}

\begin{proof}
Take the pullback of $\UU\fib\U$ along $y : X \ra \U$ to get a (small) a fibration $Y\fib X$, which extends along the (trivial) cofibration $t : X\cof X'$ by the fibration extension property,  to a (small) fibration $Y'\onto X'$ with $Y \cong t^*Y'$ over $X$.  By realignment there is a classifying map $y' : X' \ra \U$ for $Y'$ with $y'\circ t = y$.
\end{proof}

%
%
%This is routine using Yoneda and assuming that cofibrations $A \mono B$ have \emph{complemented} monos as components $A[n] \mono B[n]$.\footnote{This of course holds if the base category $\Set$ is classical; otherwise, one needs to take this as a further axiom on $\CC$.}  In more detail, since $Y'\onto X'$ is small, there is a classifying map $z : X' \ra \U$,  perhaps not commuting with $t$. Nonetheless, we can use $z$ to define the desired $y' : X' \ra \U$ objectwise as follows: Take any map from a representable $x' : \I^n \ra X'$ and consider whether it factors through $t$, say as $x' = t\circ x$ for some (necessarily unique) $x: \I^n \ra X$.  If $x'$ does factor, set  $y'\circ x' = y\circ x$; if not, set $y'\circ x' = z\circ x'$.  This specification is clearly natural in $I^n$, so it defines $y': X'\ra\U$, and the specification ensures that $y'\circ t = y$, and that the pullback of $\UU$ along $y'$ is the same as that along $z$, namely $Y'\fib X'$.

%We shall next show that the base object $\U$  of the universal unbiased fibration $\UU\fib\U$ in $\cSet$, constructed in Proposition \ref{prop:UniversalunbiasedFib}, is indeed a fibrant object.  
%The proof will proceed in two steps: 
%\begin{enumerate}
%\item We will show that, in the slice category $\cSet/_\I$, the object $\I^*\U$  total space of the classifying type $$\Fib_i(\I^*\VV) \to \I^*\V$$ for $\delta$-biased fibration structures on the universal family $\I^*\VV \to \I^*\V$ from Remark \ref{sliceuniversalfibrations} is a $\delta$-biased fibrant object. This uses the equivalence extension property, Proposition \ref{prop:equivalence extension property}, applied with respect to $\delta$-biased fibrations in the slice category $\cSet/_\I$, \ednote{as justified by ...}  
%
%\item We will show that the total space of the pushforward $q_*\Fib_i(\I^*\VV) \to q_*\I^*\V$ along the projection $q : \I\times\V\to\V$ in \eqref{diagram:fibUuniversal2} is an unbiased fibrant object in $\cSet$.  This is a general argument not depending on the specific objects involved.  By Remark \ref{sliceuniversalfibrations} and Corollary \ref{cor:Fibaspushforwardalongq}, this will suffice to show that  
%\[
%\U\ \cong\ \Sigma_\V q_*\Fib_i(\I^*\VV)\ \cong\ \Sigma_\V \rho^*\I_*\Fib_i(\I^*\VV) 
%\]
%is an unbiased fibrant object in $\cSet$.
%\end{enumerate}
%
%Before beginning with the proof, the reader may find it illuminating to reconsider the (somewhat covoluted) construction of the universal small fibration $\UU \fib \U$ in more type theoretic terms.  It was determined in Remark \ref{sliceuniversalfibrations} to be $\FFib\fib\Fib = \Fib(\VV)$, for the universal family $\VV \to \V$, with $\FFib$ the pullback of $\VV \to \V$ along the canonical projection $\Fib(\VV)\to\V$. Type theoretically, we have $\VV = \Sigma_{A:\V}A$, and then:
%\[
%\UU\ =\ \Sigma_{A:\V}\Fib(A)\times A\ \too\ \Sigma_{A:\V}\Fib(A)\ =\ \U \,.
%\]

%We show that $\I^*\UU\fib\I^*\U$ is a universal fibration in $\cSet/_\I$ in two steps:
%\begin{enumerate}
%\item $\I^*\VV\to\I^*\V$ is a universal small family in $\cSet/_\I$.  This follows immediately from the fact that both of the adjoint functors 
%\[
%\Sigma_\I \dashv \I^* : \cSet \to \cSet/_\I
%\]
%preserve pullbacks.  Indeed, a small family $A\to X \stackrel{\xi}{\to} \I$ indexed over $\I$, is classified by $\langle \xi,a \rangle : X \to \I^*\V = \I\times\V$ over $\I$, where $a : X \to \V$ classifies $A\to X$ in $\cSet$.
%\[
%\xymatrix{
%A \ar[d] \ar[rr] 	\pbcorner && \I\times\VV \ar[d] \ar[rr] \pbcorner 	&& \VV \ar[d] \\
%X  \ar[rrd]_\xi \ar[rr]^{\langle \xi,a \rangle}  && \I\times\V \ar[d] \ar[rr] \pbcorner&& \V \ar[d]  \\
%			&& \I \ar[rr] &&  1
%}
%\]
%\item By definition a map $A\to X$ in $\cSet$ is a fibration just if its base change $\I^*A \to \I^*X$ is one in $\cSet/_\I$  (with respect to $\delta : 1 \to \I^*\I$).  Moreover, the classifying type for fibration structures $\Fib(A) \to X$ is then constructed by pushing the classifying type $\Fib_\I(\I^*A) \to \I^*X$ forward along the projection  $\I^*X = \I\times X\to X$,
%\[
%\Fib(A) = \Pi_\I \Fib_\I(\I^*A)\to X\,.
%\]
%We therefore have 
%\[
%\U = \Fib(\VV) = \Pi_\I \Fib_\I(\I^*\VV).
%\]
%\end{enumerate}
%
%\begin{proposition}
% In the slice category $\cSet/_\I$, the total space of the classifying type $\Fib_i(\I^*\VV) \to \I^*\V$ for $\delta$-biased fibration structures on the universal family $\I^*\VV \to \I^*\V$ from Remark \ref{sliceuniversalfibrations} is a $\delta$-biased fibrant object. 
% \end{proposition}

Now let us show the following.
\begin{proposition}
The base $\U$ of the universal fibration $\UU\fib\U$ in $\cSet$, as constructed in section \ref{sec:universalfibration}, is a fibrant object.
\end{proposition}

%\begin{proof}
%We need to solve the following filling problem for an arbitrary cofibration $c:C \cof Z$, thus showing that $\,\U^{\delta_0} : \U^\I \ra\, \U$ is a trivial fibration (for, say, the point $\delta_0 :1\ra \I $).
%\begin{equation}\label{diag:Ufib1}
%\xymatrix@=3em{
%C \ar@{>->}[d]_c \ar[r]^{\tilde{a}} & \U^\I \ar[d]^{\U^{\delta_0}} \\
%Z  \ar@{..>}[ru] \ar[r]_{b}  & \U  \\
%}
%\end{equation}
%Transposing $\tilde{a}$ to $a : C\times \I \ra \U$ and taking pullbacks of $\UU\fib \U$ along $a$ and $b$ to get  corresponding fibrations $A\fib C\times \I$ and $B\fib Z$, we have the following equivalent condition.  Letting $$C_0 : C\cong C\times1 \ra C\times \I$$ be the evident inclusion of the $0$-end of the cylinder, let $A_0 = (C_0)^*A \fib C$ be the ``slice of $A$ over $C_0$''.  We then have $c^*B \cong A_0$ over $C$ by the outer square of \eqref{diag:Ufib1}.
%\[
%\xymatrix@=1em{
%&& \ar[llddd] A_0 \ar@{->>}[dd] \ar[rr]  &&  A \ar@{->>}[dd] \\
%&& && \\
%&& \ar[llddd]^c C \ar[rr]_{C_0}  &&  \ar[lddd] C\times\I \\
%B \ar@{->>}[dd] &&&& \\
%&&&& \\
%Z \ar[rrr]_{Z_0} &&& Z\times\I &
%}
%\]
%The diagonal filler in \eqref{diag:Ufib1} corresponds, again by transposition and pullback of $\UU\fib\U$, to a fibration $D\fib Z\times \I$ with $(c\times \I)^*D \cong A$ over $C\times \I$
% and $(Z_0)^*D \cong B$ over $Z$, as indicated below.
%\[
%\xymatrix@=1em{
%&& \ar[llddd] A_0 \ar@{->>}[dd] \ar[rr]  &&  \ar@{..>}[lddd] A \ar@{->>}[dd] \\
%&& && \\
%&& \ar[llddd]^c C \ar[rr]_{C_0}  &&  \ar[lddd]^{c\times\I} C\times\I \\
%B \ar@{->>}[dd] \ar@{..>}[rrr] &&& D \ar@{..>>}[dd] & \\
%&&&& \\
%Z \ar[rrr]_{Z_0} &&& Z\times\I &
%}
%\]
%We construct $D\fib Z\times \I$ by the equivalence extension property as follows.  Apply the functor $(-)\times\I$ to the left (pullback) face of the above cube to get the following with a new pullback square on the right, with the indicated fibrations.
%\begin{equation}\label{diag:Ufib2}
%\begin{gathered}
%\xymatrix@=1em{
%&& \ar[llddd] A_0 \ar@{->>}[dd] \ar[rr]  &&  \ar@{..>}[lddd] A \ar@{->>}[dd] &&  \ar@{->>}[lldd] A_0\times\I \ar[lddd]  \\
%&& && &&\\
%&& \ar[llddd]^c C \ar[rr]_{C_0}  &&  \ar[lddd]^{c\times\I} C\times\I && \\
%B \ar@{->>}[dd] \ar@{..>}[rrr] &&& D \ar@{..>>}[dd] && \ar@{->>}[lldd] B\times\I &\\
%&&&& &&\\
%Z \ar[rrr]_{Z_0} &&& Z\times\I &&&
%}
%\end{gathered}
%\end{equation}
%We claim there is a weak equivalence $e:A \simeq A_0\times \I$ over $C\times \I$, from which follow  by the equivalence extension property:
%
%\begin{enumerate}
%\item[(i)] a fibration $D\fib Z\times \I$ with $(c\times\I)^*D \cong A$ over $C\times\I$, and 
%\item[(ii)] a weak equivalence $f:D\simeq B\times\I$ over $Z\times \I$ with $(c\times\I)^*f \cong e$ over $C\times\I$. 
%\end{enumerate}
%It then remains only to show that $B\cong (Z_0)^*D$ over $Z$.
%
%To get $e$, consider the following square, in which the top map is $A_0\times \delta_0$ (after $A_0\cong A_0\times 1$) and the others are those from the previous diagram.
%\begin{equation}\label{diag:Ufibn}
%\xymatrix{
%A_0 \ar@{>->}[d] \ar@{>->}[r] & A_0\times\I \ar@{>>}[d] \\
%A  \ar@{>>}[r] &  C\times\I 
%}
%\end{equation}
%The square is easily seen to commute, and the maps with $A_0$ as domain are trivial cofibrations by Frobenius (proposition \ref{prop:Frobenius}), because each is the pullback of a trivial cofibration along a fibration.
%Applying a simple lemma (given below as \ref{lem:simple}) gives the required weak equivalence $e:A \simeq A_0\times \I$ over $C\times \I$.  
%
%To see that $B\cong (Z_0)^*D$ over $Z$, recall from the proof of the equivalence extension property that the map $f:B\cong (Z_0)^*D$ is the pushforward of  $e:A \simeq A_0\times \I$ along the cofibration $d_0\times\I :A_0\times\I \cof B\times\I$, calling the evident map $d_0:A_0\cof B$ in \eqref{diag:Ufib2}.  That is, by construction $f = (d_0\times\I)_*\,e$.  We can apply the Beck-Chevalley condition for the pushforward using the pullback square on the left below.
%\begin{equation}
%\xymatrix{
%A_0 \ar@{>->}[d] \ar@{>->}[r] \pbcorner & A_0\times\I \ar@{>>}[d] & \ar[l]_-e A\\
%B  \ar@{>->}[r]  &  B\times\I  & \ar[l]^-f D
%}
%\end{equation}
%The pullback of $e$ along the top of the square is the identity on $A_0$, as can be seen by pulling back $e$ as a map over $C\times \I$ along $C_0 :  C\ra C\times\I$.
%Thus the same is true (up to isomorophism) for the pullback of $f$ along the bottom.
%
%An application of the Realignment Lemma \ref{lemma:realignmentforfibrations} along the trivial cofibration $c\otimes \delta_0$ completes the proof.
%\end{proof}


\begin{proof}
By Corollary \ref{cor:unbiasedfibrant}, $\U$ is an unbiased fibrant object if the canonical map $u = \langle \proj_2, \mathsf{eval}\rangle$ in the following diagram in $\cSet$, is a trivial fibration.
\begin{equation}\label{diagram:Uunbiasedfibrant}
\xymatrix{
\U^\I\times \I \ar@/^3ex/ [rrrd]^{\mathsf{eval}} \ar@/_3ex/ [rdd]_{\proj_2} \ar@{..>}[rd]_{u}  && \\
& \I\times \U \pbcorner  \ar[d] \ar[rr] && \U \ar[d] \\
& \I \ar[rr] && 1
}
\end{equation}
%
Thus consider a filling problem of the following form, with an arbitrary cofibration $c:C \cof Z$.
\begin{equation}\label{diag:Ufib1}
\xymatrix@=3em{
C \ar@{>->}[d]_c \ar[r] & \U^\I\times \I \ar[d]^{\langle \proj_2, \mathsf{eval}\rangle} \\
Z  \ar@{..>}[ru] \ar[r]  & \I\times\U  \\
}
\end{equation}
%
The horizontal maps may be written in the form $\langle z, b\rangle : Z \to \I\times \U$ and $\langle \tilde{a} , zc\rangle : C \to \U^\I\times\I$, regarding $z : Z \to \I$ as an $\I$-indexing.

Transposing $\tilde{a}$ to $a : C\times \I \ra \U$ we obtain the new problem
%\begin{equation}\label{diagram:unbiasedpushoutproduct2}
%\xymatrix{
%C \ar@{>->}[d]_{c} \ar[rr]^{\mathsf{Gph}(zc)} && C\times \I \ar[d]\\
%Z  \ar[rr]_{\mathsf{Gph}(z)} &&  Z\times\I\,.
%}
%\end{equation}
%
\begin{equation}\label{diagram:unbiasedpushoutproduct4}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[rr]^{\gph{zc}} && C\times \I \ar[d]^{c\times\I} \ar@/^4ex/ [rdd]^{a} \\
Z \ar@/_4ex/ [rrrd]_{b} \ar[rr]_{\gph{z}} &&  Z\times\I  \ar@{.>}[rd]_{d} \\
&&& \U
}
\end{equation}
in which we recall from \eqref{eq:graphdef} the graph notation $\gph{z} = \gph{1_Z, z} : Z \to Z\times \I$.
Given a map $d$ as shown in \eqref{diagram:unbiasedpushoutproduct4}, we can obtain the indicated diagonal filler in \eqref{diag:Ufib1} as  $\langle \tilde{d} , z\rangle : Z \to \U^\I\times\I$.

 As a sanity check, note that $b\circ c = a\circ \langle zc\rangle$ turns the problem \eqref{diagram:unbiasedpushoutproduct4} into that of extending the copair $[b,a]$ along the unique map $$Z +_C (C\times \I)\too Z\times \I\,,$$ which is exactly the
(trivial cofibration) pushout-product $c\otimes_z\delta$ from \eqref{diagram:unbiasedpushoutproduct}, recalled below for the reader's convenience.%
\begin{equation}\label{diagram:unbiasedpushoutproduct5}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[r]^{\gph{zc}} & C\times \I \ar[d] \ar@/^4ex/ [rdd]^{c\times\I}\\
Z \ar@/_4ex/ [rrd]_{\gph{z}} \ar[r] &  Z +_C (C\times\I) \ar@{.>}[rd]_{c\, \otimes_z \delta} \\
&& Z\times\I
}
\end{equation}
%whereby, recall, we wrote:
%\begin{align*}
%\gph{z} &:= \langle 1_Z, z\rangle : Z\too Z\times\I\,,\\
%\gph{zc}  &:= \langle 1_C, z\circ c\rangle : C\too C\times\I\,.
%\end{align*}
%
%%%%%%%%%%%%%%%%%%
%Now we can run the proof of Proposition \ref{prop:algequivfill} backwards in order to determine a class of generating trivial cofibrations for the unbiased case. Consider pairs of maps $c : C\mono Z$ and $z:Z\ra\I$, where the former is a cofibration and the latter is regarded as an ``$\I$-indexing'', so that
%\[
%\xymatrix{
%C \ar[rd] \ar@{>->}[r]^{c} & Z  \ar[d]^z \\
%& \I
%}
%\]
%is regarded as an $\I$-indexed family of cofibrations.  Let 
%\[
%\mathsf{Gph}(z) = \langle 1_Z, z\rangle : Z\too Z\times\I\,,
%\]
%be the graph of $z : Z\ra \I$, and  define
%\[
%c \otimes_z\!\delta := [\mathsf{Gph}(z), c\times\I] : Z+_C(C\times\I) \ra Z\times \I\,,
%\]
%which is easily seen to be well-defined on the indicated pushout.
%\begin{equation}\label{diagram:unbiasedpushoutproduct3}
%\xymatrix{
%C \ar@{>->}[d]_{c} \ar[r]^{\mathsf{Gph}(zc)} & C\times \I \ar[d] \ar@/^4ex/ [rdd]^{c\times\I}\\
%Z \ar@/_4ex/ [rrd]_{\mathsf{Gph}(z)} \ar[r] &  Z +_C (C\times\I) \ar@{.>}[rd]_{c\, \otimes_z \delta} \\
%&& Z\times\I\,.
%}
%\end{equation}
%
%%%%%%%%%%%%%%%%%

Returning to \eqref{diagram:unbiasedpushoutproduct4}, take pullbacks of $\UU\fib \U$ along $a$ and $b$ to get fibrations $p_a : A\fib C\times \I$ and $p_b : B\fib Z$ respectively, and let 
$$p_c :=  \gph{zc}^*p_a : A_c \too C$$
be the corresponding ``fiber of $A$ over the graph of $zc$''.  We then have $c^*B \cong A_c$ over $C$ by the commutativity of the outer square of \eqref{diag:Ufib1}.
\[
\xymatrix@=1em{
&& \ar[llddd] A_c \ar@{->>}[dd]^{p_c} \ar[rr]  \pbcorner &&  A \ar@{->>}[dd]^{p_a} \\
&& && \\
&& \ar[llddd]^c C \ar[rr]_{\gph{zc}}  &&  \ar[lddd]^{c\times \I} C\times\I \\
B \ar@{->>}[dd]_{p_b} &&&& \\
&&&& \\
Z \ar[rrr]_{\gph{z}} &&& Z\times\I &
}
\]

The diagonal filler sought in \eqref{diag:Ufib1} corresponds, again by transposition and pullback of $\UU\fib\U$, to a fibration $p_d : D\fib Z\times \I$ with $\langle z\rangle^*D \cong B$ over $Z$ and $(c\times \I)^*D \cong A$ over $C\times \I$, as indicated below.
\begin{equation}\label{diag:Ufib1.5}
\xymatrix@=1em{
&& \ar[llddd] A_c \ar@{->>}[dd]^{p_c} \ar[rr]  &&  \ar@{..>}[lddd] A \ar@{->>}[dd]^{p_a} \\
&& && \\
&& \ar[llddd]^c C \ar[rr]_<<<<<<<{\gph{zc}}  &&  \ar[lddd]^{c\times\I} C\times\I \\
B \ar@{->>}[dd]_{p_b} \ar@{..>}[rrr] &&& D \ar@{..>>}[dd]_{p_d} & \\
&&&& \\
Z \ar[rrr]_{\gph{z}} &&& Z\times\I &
}
\end{equation}
We shall construct  $p_d : D\fib Z\times \I$ using the equivalence extension property (Proposition \ref{prop:EEP}) as follows.  First apply the functor $(-)\times\I$ to the left vertical (pullback) face of the cube in \eqref{diag:Ufib1.5} to get the following, with a new pullback square on the right with the indicated fibrations.
\begin{equation}\label{diag:Ufib2}
\begin{gathered}
\xymatrix@=1em{
&& \ar[llddd] A_c \ar@{->>}[dd]^{p_c} \ar[rr]  &&  \ar@{..>}[lddd] A \ar@{->>}[dd]^{p_a} &&  \ar@{->>}[lldd]^{p_c\times \I} A_c\times\I \ar[lddd]  \\
&& && &&\\
&& \ar[llddd]^c C  \ar[rr]_<<<<<<<{\gph{zc}}  &&  \ar[lddd]^{c\times\I} C\times\I && \\
B \ar@{->>}[dd]_{p_b} \ar@{..>}[rrr] &&& D \ar@{..>>}[dd]_{p_d} && \ar@{->>}[lldd]^{p_b\times\I} B\times\I &\\
&&&& &&\\
Z \ar[rrr]_{\gph{z}} &&& Z\times\I &&&
}
\end{gathered}
\end{equation}
We now \emph{claim} that  there is a weak equivalence $e:A \simeq A_c \times \I$ over $C\times \I$. From this it  follows by the equivalence extension property (Proposition \ref{prop:EEP}) that there are:
\begin{enumerate}
\item[(i)] a fibration $p_d : D\fib Z\times \I$ with $(c\times\I)^*D \cong A$ over $C\times\I$, and 
\item[(ii)] a weak equivalence $f:D\simeq B\times\I$ over $Z\times \I$ with $(c\times\I)^*f \cong e$ over $C\times\I$. 
\end{enumerate}
It then remains only to show that $B\cong \gph{z}^*D$ over $Z$ to complete the proof.

To obtain the claimed weak equivalence $e$, consider the following square, 
\begin{equation}\label{diag:Ufibn}
\xymatrix{
A_c \ar[d] \ar[rr]^{\langle zcp_c \rangle} && A_c\times\I \ar@{>>}[d]^{p_c\times \I} \\
A  \ar@{>>}[rr]_{p_a} &&  C\times\I \,,
}
\end{equation}
in which the top horizontal map is the graph of the composite,
\[
\A_c \stackrel{p_c}{\fib} C \stackrel{c}{\mono} Z \stackrel{z}{\to} \I\,,
\]
and the others are the evident ones from \eqref{diag:Ufib2}.
The square is easily seen to commute, and the top map is a trivial cofibration (by Remark \ref{rem:specialtrivcofs}), because it is the graph of a map into $\I$.  The left map is also a trivial cofibration by Frobenius (Proposition \ref{prop:Frobenius}), because by its definition in \eqref{diag:Ufib1.5} it is the pullback of another such graph $\gph{zc}$ along the fibration $p_a$.  A simple lemma (Lemma \ref{lem:simple} below) provides the claimed weak equivalence $e:A \simeq A_c\times \I$ over $C\times \I$.  

To see that $B\cong \langle z \rangle^*D$ over $Z$, recall from the proof of the equivalence extension property that the map $f:D\cong B\times \I$ is the pushforward of  $e:A \simeq A_c\times \I$ along the cofibration $b_c\times\I :A_c\times\I \cof B\times\I$, where we have christened the evident map in \eqref{diag:Ufib2} $b_c : A_c\cof B$.  Thus by construction $f = (b_c\times\I)_*\,e$.  We can then apply the Beck-Chevalley condition for the pushforward using the pullback square on the left below.
\begin{equation}
\xymatrix{
A_c \ar@{>->}[d]_{b_c} \ar@{>->}[rr]^{\gph{zcp_c}} \pbcorner && A_c\times\I \ar@{>->}[d]^{b_c\times \I} & \ar[l]_-e A\\
B  \ar@{>->}[rr]_{\gph{zp_b}}  &&  B\times\I  & \ar[l]^-f D
}
\end{equation}
The pullback of $e$ along the top of the square is the identity on $A_c$, as can be seen by pulling back $e$ as a map over $C\times \I$ along $\gph{zc} :  C\ra C\times\I$.
Thus the same is true up to isomorophism for the pullback of $f$ along the bottom.

An application of the Realignment Lemma \ref{lemma:realignmentforfibrations} along the trivial cofibration $c\otimes_z\delta$ completes the proof.
\end{proof}

\begin{lemma}\label{lem:simple}
Suppose the following square commutes and the indicated cofibrations are trivial.
\begin{equation}\label{diag:standard1}
\xymatrix{
A \ar@{>->}[d] \ar@{>->}[r] & C \ar@{>>}[d] \\
B  \ar@{>>}[r] &  D \\
}
\end{equation}
Then there is a weak equivalence $e : B \simeq C$ over $D$ (and under $A$).
\end{lemma}
\begin{proof}
Use the fact that any two diagonal fillers are homotopic to get a homotopy equivalence $e : B \simeq C$ filling the square.
\end{proof}

\begin{remark}
The foregoing proof also works, \emph{mutatis mutandis}, for the case of \emph{biased} fibrations, as in the setting of \cite{CCHM}.
\end{remark}

Applying proposition \ref{prop:UfibtoFEP} now yields the following.

\begin{corollary}\label{cor:FEP}
The fibration weak factorization system has the fibration extension property (definition \ref{def:fibextreplace}). 
\end{corollary}

By Theorem \ref{theorem:QMSmodFEP}, finally, we have the following.

\begin{theorem}\label{theorem:QMS}
There is a Quillen model structure $(\CC,\WW,\FF)$ on the category $\cSet$ of cubical sets for which:
\begin{enumerate}
\item the cofibrations $\CC$ are any class of maps satisfying (C0)-(C8) (equivalently, the simplified axioms in the Appendix% \ref{appendix:Cofibrations}
),
\item the fibrations $\FF$ are the maps $f : Y\ra X$ for which the canonical map 
\[
(f^\I \times \I, \eval_Y) : Y^\I \times \I\too (X^\I \times \I)\times_X Y
\]
lifts on the right against $\CC$.
\item the weak equivalences $\WW$ are the maps $w : X\ra Y$  for which, for every fibrant object $K$, the internal precomposition $K^w : K^Y \to K^X$ is bijective on connected components.
\end{enumerate}
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{Appendix A: Axioms for cartesian cofibrations}\label{appendix:Cofibrations}
% perhaps add axioms for the interval as well?
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

A system of maps satisfying the axioms (C0)-(C8) in the main text, for the cofibrations in a cartesian cubical model category, will be called \emph{cartesian cofibrations}. The axioms can be restated equivalently as follows.
\begin{enumerate}
\item[(A0)] All cofibrations are monomorphisms.
\item[(A1)] All isomorphisms are cofibrations.
\item[(A2)] The composite of two cofibrations is a cofibration.
\item[(A3)] Any pullback of a cofibration is a cofibration.
\item[(A4)] The category of cofibrations and cartesian squares has a terminal object.
\item[(A5)] The join of two cofibrant subobjects is a cofibration.
\item[(A6)] The diagonal map $\delta : \I\ra\I\times\I$ is a cofibration.
\item[(A7)] If $c:A \to B$ is a cofibration, then so is $c^\I:A^\I \to B^\I$.
\end{enumerate}

%We have the following example.
\begin{proposition}
 In any topos, the locally decidable subobjects satisfy the axioms for cartesian cofibrations.
\end{proposition}
\begin{proof}
\ednote{fill in ...}
\end{proof}
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{Appendix B: Cubical sets as a classifying topos}\label{appendix:classtopos}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection*{Cubical sets as a classifying topos}\label{subsec:classtopos}

The objects of the Cartesian cube category $\Box$ may be taken concretely to be finite sets of the form $$[n] = \{\bot, x_1, ..., x_n, \top\},$$ and the arrows $f : [n] \to [m]$ to be all bipointed maps $[m]\to [n]$ (note the direction).  These maps are evidently just $m$-tuples of elements from the set $[n]$, which are easily shown to be composites of faces, degeneracies, permutations, and diagonals. 

The category of \emph{(Cartesian) cubical sets} is the presheaf topos
\[
\cSet =  \psh{\Box}.
\]
It is of course generated by the representable presheaves $\I^n := \yon[n],$ called the \emph{$n$-cubes}.  The $0$-cube is $\I^0 = \yon[0] =1$; the $1$-cube is $\I = \yon[1]$; and $\I^n \times \I^m \cong \I^{n+m}$ in virtue of preservation of products by the Yoneda embedding $\yon : \op{\Box} \hook\cSet$.  For a cubical set $X: \op{\Box} \to \Set$ we write $X_n = X[n]$ and call this the \emph{set of $n$-cubes in $X$}, for which we have the usual Yoneda correspondence,
\[
\{c \in X_n \} \ \cong\ \{c : \I^n \to X\}.
\]
In particular, $\I^n_m = \cSet([m],[n])$ is the set of $m$-cubes in the $n$-cube.\footnote{Note that the cardinality of $\I^n_m$ is therefore just $(m+2)^n$, in comparison to the \emph{Dedekind} cubes, for which \eg\ $\cSet([1],[n])$ the $n^{th}$ \emph{Dedekind number}, the number of elements in the free distributive lattice on $n$ generators, which in general is  a number so large that it is not known, even for values of $n>7$.} 

\begin{proposition}
The category $\cSet$ of Cartesian cubical sets is the classifying topos for \emph{strictly bipointed objects}: objects $A$ with points $a_0, a_1 : 1\to A$ the equalizer of which is $0\to 1$.
\end{proposition}

\begin{proof}
Consider the covariant presentation $\cSet = \Set^\B$ where $\B$ is the category of finite, strictly bipointed sets and bipointed maps.  We can extend $\B\hook\B_=$ by freely adjoining coequalizers, making $\B_=$ the free finite \emph{colimit} category on a co-bipointed object. An concrete presentation of $\B_=$ is the finite bipointed sets, including those with $\bot=\top$.  Let us write $(n)$ for the bipointed set $\{x_1, ..., x_n, \bot=\top\}$, with $n$ (non-constant) elements and a further element $\bot=\top$.  There is an evident coequalizer $[1]\rightrightarrows [n]\to(n)$, which just identifies the distinguished points, and every coqualizer has either the form $[m]\rightrightarrows [n]\to [k]$ or $[m]\rightrightarrows [n]\to(k)$, for a suitable choice of $k$.  Note that there are no maps of the form $(m)\to [n]$, and that every map $[m]\to (n)$ factors uniquely as $[m]\to (m)\to (n)$ with  $[m]\to(m)$ the canonical coequalizer of $\bot$ and $\top$.  The category $\B_=$ can therefore be decomposed into two ``levels'', the upper one of which is essentially $\B$, the lower one consisting of just the objects $(n)$ and thus essentially the finite \emph{pointed} sets, and for each $n$, there is the canonical coequalizer $[n]\to(n)$ going from the upper level to the lower one.
\[
\xymatrix{
\dots \ar[r] & [m] \ar@{->>}[d] \ar[r] & [n] \ar@{->>}[d] \ar[r] & \dots \\
\dots \ar[r] & (m) \ar[r] & (n) \ar[r] & \dots
}
\]
Write $u : \B\to\B_=$ for the upper inclusion, which is the classifying functor of generic co-bipointed object in $\B_=$ (which is strict).  

Now consider the induced geometric morphism:
\[
\xymatrix{
\Set^\B \ar@<-2ex>[rr]_{u_!} \ar@<2ex>[rr]^{u_*} && \ar[ll]|-{\,u^*} \Set^{\B_=}  & u_! \dashv u^* \dashv u_*
}
\]
Since $u^*$ is the restriction along $u$, the right adjoint $u_*$ must be ``prolongation by $1$'',
\begin{align*}
u_*(P)[n] &= P[n],\\
u_*(P)(n) &= \{*\},
\end{align*}
with the obvious maps,
\[
\xymatrix{
\dots \ar[r] & P[m] \ar@{->>}[d] \ar[r] & P[n] \ar@{->>}[d] \ar[r] & \dots \\
\dots \ar[r] & \{*\} \ar[r] & \{*\} \ar[r] & \dots
}
\]
as is easily seen by considering maps in $\Set^{\B_=}$ of the form
\[
\xymatrix{
 Q[n] \ar[d]_{\cdot} \ar[r] & P[n] \ar@{->>}[d]^{\cdot} \\
 Q(n) \ar[r]^{} & \{*\} .
}
\]
Since $u_* : \Set^{\B} \to \Set^{\B_=}$ is evidently full and faithful, it is the inclusion part of a sheaf subtopos $\mathsf{sh}(\B^\mathsf{op}_=, j) \hook \Set^{\B_=}$ for a suitable Grothendieck topology $j$ on $\B^\mathsf{op}_=$.  We claim that $j$ is the closed complement topology of the subobject $[\bot=\top] \rightarrowtail 1$ represented by the coequalizer $[0]\to (0)$.  Indeed, in $\Set^{\B_=}$ we have the representable functors:
\begin{align*}
\I &= y[1],\\
1 &= y[0],\\
[\bot=\top] &= y(0)
\end{align*}
fitting into an equalizer $[\bot=\top] \to 1 \rightrightarrows \I$, which is the image under Yoneda of the canonical coequalizer $[1] \rightrightarrows [0]\to (0)$ in $\B_=$.  The closed complement topology for $[\bot=\top] \mono 1$ is generated by the single cover $0\to [\bot=\top]$, which can be described logically as 
forcing the sequent $(\bot=\top \vdash \bot)$ to hold.  Recall from \cite{JohnstoneTT}, Proposition 3.53, the following simple characterization of the sheaves for a closed topology generated by an object $U\mono 1$: an object $X$ is a sheaf iff $X\times U \cong U$. In the present case, it therefore suffices to show that for any $P:\B_= \to \Set$ we have:
\[
P\times [\bot=\top] \cong [\bot=\top] \quad\text{iff}\quad P(n) = 1\ \text{for all $n$}.
\]
For any object $b\in \B_=$, consider the map
\[
\hom(yb, P\times [0=1] ) \cong \hom(yb, P) \times \hom(yb, [\bot=\top]) \to \hom(yb, [\bot=\top]) .
\]
If $b = [k]$, then $\hom(yb, [\bot=\top]) \cong \hom_{\B_=}((0), [k]) \cong 0$, and so we always have an iso
\[
\begin{split}
\hom(yb, P\times [\bot=\top] ) \cong \hom(yb, P) \times \hom(yb, [\bot=\top])\\
 \cong \hom(yb, P) \times 0 \cong 0.
 \end{split}
\]
If $b = (k)$, then $\hom(y(k), [\bot=\top]) \cong \hom_{\B_=}((0), (k)) \cong 1$, and we have an iso
\[
\begin{split}
\hom(y(k), P\times [\bot=\top] ) \cong \hom(y(k), P) \times \hom(y(k), [\bot=\top]) \\
\cong \hom(y(k), P) \times 1 \cong \hom(y(k), P) \cong P(k).
\end{split}
\]
Thus we will have an iso $P\times [\bot=\top] \cong [\bot=\top] $ iff $P(k) \cong 1$.

Thus the presheaf topos $\Set^\B$ is the closed complement of the open subtopos $$\Set^{\B_=}/_{[\bot=\top]}\ \hook\ \Set^{\B_=}$$ given by forcing the proposition $\bot \neq \top$.  Since $\Set^{\B_=}$ is clearly the classifying topos for \emph{arbitrary} bipointed objects $\bot, \top : 1\to B$, the subtopos $\Set^\B$ indeed classifies \emph{strictly} bipointed objects, as claimed.
\end{proof}


\begin{corollary}
The geometric realization functor to topological spaces 
$$R: \cSet \to \mathsf{Top}$$
preserves cartesian products, $R(X\times Y) \cong R(X)\times R(Y)$.\footnote{This fact and the next one are to be contrasted with the case of monoidal cubical sets, \eg\ as studied by \cite{Jardine,Dougherty}}
\end{corollary}

\begin{proof}
This can of course be shown directly, but it follows immediately by composing the inverse image of the classifying geometric morphism $\mathsf{sSets} \to \cSet$ of the $1$-simplex $\Delta^1$ with the standard geometric realization $\mathsf{sSets} \to \mathsf{Top}$, each of which preserves finite products.
\end{proof}

\begin{definition}
Let $\Box \to\  \Cat$ be the unique product-preserving functor taking the interval $[1]$ to the one arrow  category $\bbtwo = (0\leq1)$.  This functor then takes $[n]$ to $\bbtwo^n$, the $n$-fold product in $\Cat$, and maps $[m] \to [n]$  to the corresponding monotone functions of the posets $\bbtwo^n$.  The  \emph{cubical nerve} functor $$N : \Cat \to \cSet$$ is then defined by:
\[
N(\bbC)_n = \Cat(\bbtwo^n, \bbC).
\]
Thus $N(\bbC)_0$  is the set of objects of \bbC; $N(\bbC)_1$ is the set of arrows; $N(\bbC)_2$ consists of all commutative squares; $N(\bbC)_3$ all commutative cubes, etc. 
\end{definition}

\begin{proposition}
The nerve functor $N : \Cat \to \cSet$ is full and faithful.
\end{proposition}
\begin{proof}
Given categories $\bbC$ and $\D$ and functors $F, G : \bbC\to\D$, suppose $F(f) \neq G(f)$ for some $f : A\to B$ in $\bbC$.  Take $f^{\sharp} : \bbtwo \to \bbC$ with image~$f$.  Then $N(F)_1(f^\sharp) = F(f) \neq G(f) = N(G)_1(f^\sharp)$, and so $N(F) \neq N(G) : N(\bbC)\to N(\D)$.  So $N$ is faithful.

For fullness, let $\varphi : N(\bbC) \to N(\D)$ be a natural transformation, and define a proposed functor $F : \bbC\to \D$ by  
\begin{align*}
F_0 = \varphi_0 &: \bbC_0 = N(\bbC)_0 \to N(\D)_0 = \D_0\\
F_1 = \varphi_1 &: \bbC_1 = N(\bbC)_1 \to N(\D)_1 = \D_1.
 \end{align*}
We just need to show that $F$ preserves identity arrows and composition.
Consider the following diagram.
\[
\xymatrix{
\Cat(\bbtwo^1, \bbC) = N(\bbC)_1 \ar[r]^{F_1} & N(\D)_1 = \Cat(\bbtwo^1, \D) \\
\Cat(\bbtwo^0, \bbC) = N(\bbC)_0 \ar[u]^{!^*} \ar[r]_{F_0} & N(\D)_0 = \Cat(\bbtwo^0, \D) \ar[u]_{!^*}.
}
\]
Here $!^* : \Cat(\bbtwo^0, \bbC) \to \Cat(\bbtwo, \bbC) $ is precomposition with $! : \bbtwo = \bbtwo^1 \rightarrow \bbtwo^0 = \mathbbm{1}$, so the diagram commutes.  But since $! : \bbtwo \rightarrow \mathbbm{1}$ is a functor, $$\bbC_0 = \Cat(\mathbbm{1}, \bbC)  \stackrel{!^*}{\to}  \Cat(\bbtwo, \bbC) = \bbC_1$$ takes objects in $\bbC$ to their identity arrows.  Thus $F$ preserves identity arrows.  Similarly, for composition, consider 
\[
\xymatrix{
\Cat(\bbtwo^2, \bbC) = N(\bbC)_2 \ar[d]_{d^*} \ar[r]^{\varphi_2} & N(\D)_2 = \Cat(\bbtwo^2, \D) \ar[d]^{d^*} \\
\Cat(\bbtwo, \bbC) = N(\bbC)_1  \ar[r]_{F_1} & N(\D)_1 = \Cat(\bbtwo, \D).
}
\]
where $\varphi_2 : N(\bbC)_2 \to N(\D)_2$ is the action of $\varphi$ on commutative squares of arrows, and $d^* : \Cat(\bbtwo^2, \bbC) \to \Cat(\bbtwo, \bbC)$ is precomposition with the diagonal map $d : \bbtwo \rightarrow \bbtwo^2 = \bbtwo\times\bbtwo$, so the diagram commutes.  For any composable pair of arrows $A \stackrel{f}{\to} B \stackrel{g}{\to} C$ in $\bbC$ there is a commutative square 
\[
\xymatrix{
A \ar[r]^{f} \ar[d]_{f} & B \ar[d]^{g} \\
B  \ar[r]_{g} & C,
}
\]
and the effect of $d^* : \Cat(\bbtwo^2, \bbC) \to \Cat(\bbtwo, \bbC)$ on this square is exactly $g\circ f: A\to C$, and similarly for $d^* : \Cat(\bbtwo^2, \D) \to \Cat(\bbtwo, \D)$.  Thus the commutativity of the above diagram implies that $F$ preserves composition.
Since clearly $N(F) = \varphi$, we indeed have that $N$ is also full.
\end{proof}

\begin{proposition}\label{prop:pathobject}
For any cubical set $X$, the exponential $X^\I$ is calculated as the ``shift by one dimension'', 
\[
X^\I(n) \cong X(n+1)\,.
\]
\end{proposition}

\begin{proof}
\[
\begin{split}
X^\I(n) \cong \hom(y[n], X^\I) \cong \hom(\I^n, X^\I)\ \cong\ \hom(\I^n\times \I, X)\\
\cong\ \hom(\I^{n+1}, X)\cong\ \hom(y[n+1], X)\ \cong\ X(n+1).
\end{split}
\]
\end{proof}

\begin{corollary}\label{cor:rightadjpath}
The functor $X \mapsto X^\I$ has a \emph{right} adjoint.
\end{corollary}
\begin{proof}
The functor $X \mapsto X^\I$ is given by precomposition with the ``successor'' functor $S : \H\to\H$ with $S[n] = [n+1]$.  Thus $X^\I([n]) = X(S[n]) = (S^*(X))([n])$.  Precomposition always has a right adjoint $S^* \dashv S_*$, which can be calculated as:
\[
S_*(X)(n) \cong \hom(y[n], S_*X) \cong \hom(S^*(y[n]), X)\ \cong \hom(\H(S(-), [n]), X).
\]
\end{proof}

We need the following fact in order to calculate the right adjoint further.

\begin{lemma}\label{lemma:binomial}
In $\HH$, we have $\I^\I\ \cong\ \I+1$.
\end{lemma}
\begin{proof}
For any $[n] \in \H$ we have:
\[
(\I^\I)(n) \cong \I(n+1) \cong \Hom(\I^{(n+1)},\I)\cong \H([n+1],[1])\cong \B([1], [n+1])\cong n+3.
\]
On the other hand,
\[
(\I+1)(n) \cong \I(n) + 1(n) \cong \Hom(\I^n, \I) + 1 \cong \B([1],[n]) +1 \cong (n+2) +1.
\]
The isomorphism is natural in $n$.
\end{proof}
%
We mention that a similar fact holds for the generic object in the object classifier topos, and in the Schanuel topos, and is used in the theory of ``abstract higher-order syntax'' \cite{Pitts,Fiore}.


\begin{definition}
Let us write
\[
X_\I = S_*(X)
\]
for the right adjoint of the path object functor $X^\I = S^*X$.
\end{definition}

\begin{corollary}
We have the following calculation for the right adjoint $X_\I$:
\begin{align*}
X_\I(n) &\cong \hom(\I^n, X_\I) \\
&\cong \hom((\I^n)^\I, X) \\
&\cong \hom((\I^\I)^n, X) \\
&\cong \hom((\I+1)^n, X) \\
&\cong \hom(\I^n + C^n_{n-1}\I^{n-1} + \dots + C^n_{1}\I+1, X) \\
&\cong X(n) \times X(n-1)^{C^n_{n-1}} \times \dots \times X(1)^{C^n_{1}}\times X(0),
\end{align*}
where $C^n_{k} = \binom{n}{k}$ is the usual binomial coefficient.
\end{corollary}

\begin{corollary}
There is a natural transformation $X_\I \to X$, given by the first projection from $X_\I(n)\cong X(n) \times X(n-1)^{C^n_{n-1}} \times \dots \times X(1)^{C^n_{1}}\times X(0)$.
\end{corollary}

Finally, we observe that that the path object functor $X^\I$ itself, as a left adjoint, preserves all \emph{co}limits.  This does not hold in general in type theory, but will be a special property of the cubical model.  (Cf. Lawvere \cite{ATOM} on the notion of ``tiny'' objects and the ``amazing right adjoint''.)  

\paragraph{Example.} (P.~Aczel)
The cubical set $P$ of polynomials (over the integers, say), is defined by:
\[
P_n = \{ p(x_1, ...,  x_n)\ |\  \text{polynomials in at most}\  x_1, ..., x_n \}
\]
with the evident maps $P_m \to P_n$ for each function $[m] \to [n]$.

This is a ring object in the category of cubical sets, and the interval $\I\ = y[1]$ embeds into $P$.
The same is true for any algebraic theory $\T$ with two constants, such as boolean algebras: there is a cubical $\T$-algebra $A$ and a monic $\I \mono A$.

Let $\C[\I] = \H$ be the cube category, classifying intervals, and $\C[\T]$ the classifying category for $\T$-algebras.  There is an interval $J$ in $\C_\T$  consisting of the generic $\T$-algebra and its two constants.  This $J$ has a classifying functor $J : \C_\I \to \C_\T$, inducing functors on presheaves
\[
J_! \dashv J^* \dashv J_* : \psh{\C_\I} \to \psh{\C_\T}
\]
as usual, where $J_! \circ \y_{\C_\I} =\ \y_{\C_\T} \circ J$,  with $\y$ the respective Yoneda embeddings.

We can calculate:
\begin{equation}
\begin{split}
J^* J_! ( \I )( [n] ) &= J^* J_! ( Y[1] )( [n] )\\
 &= J^* Y( J[1] )( [n] ) = Y( J[1] )( J[n] ) \\
 &= \C_\T( J[n] , J[1] ) = \T\mathrm{-Alg}( J[1] , J[n] ) \\
 &= \T\mathrm{-Alg}( F(1) , F(n) ) = | F(n) |,
\end{split}
\end{equation}
where $F(n)$ is the free $\T$-algebra on $n$ generators.  So in the case of polynomials we indeed have 
$$P = J^* J_! ( \I ).$$
The unit of the adjunction $\I \to J^* J_! ( \I )$ is faithful, since $J$ itself is faithful and therefore the left adjoint $J_!$ is faithful.
$P$ is a ring in $\psh{\C_\I}$ since $J_!(\I)$ is a ring in $\psh{\C_\T}$ and $J^*$ is left exact.

A closely related example is the cubical set of ``boolean polynomials",
\[
B_n = \{ \varphi(p_1, ...,  p_n)\ |\ \text{propositional formulas in at most $p_1, ...,  p_n$} \}
\]
which is the free boolean algeba $2^{2^n}$.  

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliographystyle{alpha}
\bibliography{../references}
%
%%
\end{document}
%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Appendix 1: Kan Composition}\label{appendix:KanComp}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Composition without connections}\label{sec:composition}

A novelty of the type-theoretic notion of fibration is the method (due to Coquand and first introduced in \cite{CCHM}) of reducing the (type-theoretically specified) notion of \emph{fibration structure} to the apparently weaker notion of a \emph{composition structure}.  Composition structure is more easily shown to be preserved by the type-forming operations like $\Sigma$ and $\Pi$, when these concepts are formulated in type theory, as is done in \cite{CCHM}, or in the internal lanuage of the ambient presheaf topos, as in \cite{OP}.  This is due to the fact that one can then efficiently calculate using the rules of type theory (and even in a proof assistant), making it possible to prove e.g.\  that the fibrations are closed under $\Pi$-types.  The approach taken here is a reformulation into diagrammatic language of those type-theoretic calculations.

\subsubsection*{Composition for an object}

Let $p : 1 \ra \I$ be any point of the interval (e.g.\ $\delta_0$), and $\epsilon_p := X^p : X^\I \ra X$ the corresponding ``evaluation at $p$'' map.  Given another point $q : 1 \ra \I$, there is an evident factorization 
\[
\epsilon_p = \pi_1 \circ \langle \epsilon_p, \epsilon_q\rangle : X^\I \ra X\times X \ra X.
\]
We will say that the object $X$ \emph{has composition (from $p$ to $q$)} if for every object $Z$ and cofibration $c:C\mono Z$ and commutative square 
\begin{equation}\label{diagram:composition1}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[r]  & X^\I \ar[d]^{\epsilon_p} \\
Z \ar[r] & X,
}
\end{equation}
there is an arrow $k : Z \ra X\times X$ as indicated below making both subdiagrams commute.
\begin{equation}\label{diagram:composition2}
\xymatrix{
C \ar@{>->}[dd]_{c} \ar[r]  & X^\I \ar[d]^{\langle \epsilon_p, \epsilon_q\rangle} \\
& X\times X \ar[d]^{\pi_1} \\
Z \ar[r] \ar@{..>}[ru]^{k} & X,
}
\end{equation}

If $X$ is fibrant in the \emph{biased} sense of section \ref{sec:biasedfibration}, then $X$ clearly has composition from $\delta_0$ to $\delta_1$ (and back), since the outer rectangle then has a diagonal filler (as does the corresponding one with $\pi_2$ for $\pi_1$).   In the case where the category of cubes is assumed to have connections, one can also show the converse, that having composition implies diagonal filling for all such squares \eqref{diagram:composition1}; logical proofs of this fact can be found in \cite{CCHM,OP}, and a diagrammatic proof is given in Appendix 1.

If $X$ is fibrant in the \emph{unbiased} sense of section \ref{sec:unbiasedfibration}, with the generic point $\delta : 1\ra \I$ over $\I$, then $X$  will have composition over $\I$ from $\delta$ to either of $\delta_0, \delta_1$, for the same reason as before: the map $(\delta\!\Rightarrow\!X) = X^\delta : X^\I \ra X$ is a trivial fibration over $\I$, by the definition of fibrancy. In order to arrive at a property equivalent to unbiased filling, we shall use a generic form of composition from $\delta$ to a second generic point $\delta'$.  This is obtained by pulling back along the (say, second) projection $\pi : \I\times\I \ra \I$ to work in $\cSet/(\I\times\I)$, where in addition to $\delta, \delta_0, \delta_1$ we now also have a point $\delta' : 1 \ra \I$, given by the additional diagonal map over $\I\times \I$,
\begin{equation}\label{diagram:deltaprime}
\xymatrix{
\I\times\I  \ar[rd]_{\mathsf{id}} \ar[rr]^{\langle \pi_1, \pi_2, \pi_1\rangle}  && \I\times\I\times\I \ar[ld]^{\langle \pi_1, \pi_2\rangle} \\
&  \I\times\I &.
}
\end{equation}
%$$\delta' :=\langle \pi_1, ..., \rangle: \I\times\I \ra \I\times\I\times\I$$ 

Observe that in $\cSet/\I\times\I$ the (binary) diagonal $\Delta : \I\mono \I\times\I$ is a subobject of the terminal object $\Delta\mono 1$, with associated base change 
\begin{equation}\label{diagram:Deltabasechange}
\xymatrix{
\cSet/\I\ \ar@<-1ex>[rr]_{\Delta_*}  && \ar@<-1ex>[ll]_{\Delta^*} \ \cSet/\I\times\I \,.
}
\end{equation}
%
For any object $X$ in $\cSet/\I\times\I$, let $$\eta_X : X\ra X^\Delta$$ be the unit of $\Delta^*\dashv \Delta_*$.  
Given objects and arrows $f, g : X \rightrightarrows Y$ in $\cSet/\I\times\I$, observe that
 $\Delta^*f = \Delta^*g$ in $\cSet/\I$ if and only if the composites with $\eta_Y$ are equal,
\begin{equation}\label{diagram:composeDelta}
\xymatrix{
X \ar@<-1ex>[r]_{g}  \ar@<1ex>[r]^{f} & Y \ar[r]^{\eta_Y} & Y^\Delta.
}
\end{equation}
%
Indeed, consider the double naturality square
\begin{equation}\label{diagram:Deltanatural}
\xymatrix{
X \ar[d]_{\eta_X} \ar@<-.8ex>[r]_{g}  \ar@<.8ex>[r]^{f} & Y \ar[d]^{\eta_Y} \\
X^\Delta \ar@<-.8ex>[r]_{g^\Delta}  \ar@<.8ex>[r]^{f^\Delta} & Y^\Delta.
}
\end{equation}
Then $\eta_Y f = \eta_Y g$ iff $f^\Delta \eta_X= g^\Delta \eta_X : X\ra Y^\Delta$ iff $\Delta^*f = \Delta^*g : \Delta^*X \ra\Delta^*Y$, by transposition, since $Y^\Delta = \Delta_*\Delta^* Y$. 
% (A dual condition involving the counit $X\times \Delta \ra X$ also holds.)

We can now define what it means for an object $X$ to have (unbiased) composition by saying that it has composition, in the sense of \eqref{diagram:composition2}, from $\delta$ to $\delta'$ over $\I\times \I$, and that, moreover, the two resulting maps $k_1, k_2 : Z\rightrightarrows X$ are coequalized by the unit $\eta_X : X\ra X^\Delta$.  We reformulate this condition equivalently as follows (cf.\ \cite{Coquand,ABCetc.}).

\begin{definition}\label{def:unbiasedcomposition}
An object $X$ will be said to have \emph{(unbiased) composition} if it satisfies the following condition: for every cofibration $c : C \mono Z$ in $\cSet/\I$ and every commutative square in $\cSet/\I$ of the form
\begin{equation*}\label{diagram:compdef1}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[r]^y  & X^\I \ar[d]^{\epsilon_\delta} \\
Z \ar[r]_x & X
}
\end{equation*}
with $\epsilon_\delta := X^\delta : X^\I \ra X$ the evaluation at the generic point $\delta : 1 \ra \I$, upon pulling back along $\pi : \I\times\I \ra \I$ to $\cSet/\I\times\I$, there is a map $x' : Z \ra X$ making the following commute, 
\begin{equation}\label{diagram:compdef2}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[r]^y  & X^\I \ar[d]_>>>>>>>{\epsilon_\delta} \ar[r]^{\epsilon_{\delta'}} &  X \ar[d]^{\eta_X}\\
Z  \ar@{..>}[rru]_>>>>>>>>>{x'} \ar[r]_x & X \ar[r]_{\eta_X} & X^\Delta 
}
\end{equation}
where $\epsilon_{\delta'} := X^{\delta'} : X^\I \ra X$ is the evaluation at the second generic point $\delta' : 1 \ra \I$.

\end{definition}

\begin{proposition}\label{prop:comptofillobj}
Composition implies filling; that is, every cubical set $X$ with composition is fibrant.
\end{proposition}

\begin{proof}
Let $X$ be a cubical set with composition, and suppose given a filling problem in $\cSet/\I$  of the form
\begin{equation}\label{diagram:compimpfill}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[r]^y  & X^\I \ar[d]^{\epsilon_\delta} \\
Z \ar[r]_x & X.
}
\end{equation}
Pulling back to $\cSet/(\I\times\I)$ (but omitting the $\pi^*$ everywhere), since $X$ has composition there is a map $x' : Z \ra X$ making the following commute, 
\begin{equation}\label{diagram:compimpfill2}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[r]^y  & X^\I \ar[d]_>>>>>>>{\epsilon_\delta} \ar[r]^{\epsilon_{\delta'}} 
	&  X \ar[d]^{\eta_X}\\
Z  \ar@{..>}[rru]_>>>>>>>>>{x'} \ar[r]_x & X \ar[r]_{\eta_X} & X^\Delta \,.
}
\end{equation}
%where $\epsilon_{\delta'} := X^{\delta'} : X^\I \ra X$ is the evaluation at the second generic point $\delta' : 1 \ra \I$.
%
Transposing by the adjunction $\pi^* \dashv {\pi}_*$ results in a commutative diagram in $\cSet/\I$ of the form
\begin{equation}\label{diagram:compimpfill3}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[r]^y  & X^\I \ar[d]_>>>>>>>{\epsilon_\delta} \ar[r]^{\widetilde{\epsilon_{\delta'}}} 
	&  \pi_*\pi^*X \ar[d]^{\pi_*\eta_X} \\
Z \ar[r]_x \ar@{..>}[rru]_>>>>>>>>>{\widetilde{x'}} & X\ar[r]_-{\widetilde{\eta_X}} & \pi_*X^\Delta,
}
\end{equation}
where $\widetilde{\epsilon_{\delta'}} : X^\I \ra \pi_*\pi^*X$ is the adjoint transpose of $\epsilon_{\delta'}$, and similarly for $\widetilde{x'}$ and $\widetilde{\eta_X}$.  To compute these transpositions, we factor them through the unit maps $\eta^\pi$ of the adjunction $\pi^* \dashv {\pi}_*$,
\begin{equation}\label{diagram:compimpfill4}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[r]^y  & X^\I \ar[d]^{\epsilon_\delta} \ar[r]^{\eta^{\pi}_{X^\I}} 
	&  (X^\I)^\I  \ar[d]^{(\epsilon_\delta)^\I} \ar[r]^{\pi_*{\epsilon_{\delta'}}}  &  \pi_*\pi^*X   \ar[d]^{\pi_*\eta_X} \\
Z \ar[r]_x \ar@{..>}[rrru]^{\widetilde{x'}} & X \ar[r]_{\eta^\pi_X} 
	& X^\I \ar[r]_-{\pi_*\eta_X} & \pi_*X^\Delta.
}
\end{equation}
%
Next, observe that $\pi_*\pi^*X = X^\I$ and, up to the iso $(X^\I)^\I \cong X^{\I\times\I}$, the map $\pi_*{\epsilon_{\delta'}}$ is
\[
\pi_*{\epsilon_{\delta'}} = X^{(\Delta: \I \mono \I\times\I)} : X^{\I\times\I} \ra X^\I\,,
\]
which we write as $\Delta^* : X^{\I\times\I} \ra X^\I$ to avoid confusion with the exponential object $X^\Delta$.
The map $\Delta^* $ is plainly a retraction of 
\[
\eta^{\pi}_{X^\I} = X^{(\pi: \I\times\I\ra \I)}: X^\I \ra (X^\I)^\I \cong X^{\I\times\I}\,.
\]
The last diagram \eqref{diagram:compimpfill4} now becomes
\begin{equation}\label{diagram:compimpfill5}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[r]^y  & X^\I \ar[d]^{\epsilon_\delta} \ar[rr]^{\eta^{\pi}_{X^\I}}  \ar@/^5ex/ [rrr] ^{=}
	&&  X^{\I\times\I}  \ar[d]^{(\epsilon_\delta)^\I} \ar[r]^{\Delta^*}  &  X^\I   \ar[d]^{\pi_*\eta_X} \\
Z \ar[r]_x \ar@{..>}[rrrru]^{\widetilde{x'}} & X \ar[rr]_{\eta^\pi_X} 
	&& X^\I \ar[r]_-{\pi_*\eta_X} & \pi_*X^\Delta.
}
\end{equation}
Finally, we claim that $\pi_*X^\Delta \cong X$, and that, up to this iso,  $$\pi_*\eta_X = \epsilon_\delta : X^\I\ra X,$$ which will finish the proof, since this is a retraction of $\eta^\pi_X : X\ra X^\I$.  Indeed, writing out the object $\pi_*X^\Delta$ explicitly, in terms of the two adjunctions $\pi^* \dashv {\pi}_*$ and $\Delta^* \dashv \Delta_*$, we have
\[
\pi_*X^\Delta = \pi_*\Delta_*\Delta^*\pi^*X \cong (\pi\circ\Delta)_*(\pi\circ\Delta)^*X \cong X,
\]
since $(\pi\circ\Delta) = 1$.  

To see that $\pi_*\eta_X = \epsilon_\delta$, first let us make the base change $$\I^* : \cSet \ra \cSet/\I$$ explicit, so that $\epsilon_\delta$ is the counit of the adjunction $\I^* \dashv \I_*$ at $\I^*X$,
\[
\epsilon_\delta = \epsilon_{(\I^*X)} : X^\I \times \I \ra X\times \I \quad\text{(over $\I$)}.
\]  
By a triangle law, this map has the inverse $\I^*(\eta_{X}^\I) : X\times\I \ra X^\I \times \I$, where $$\eta_X^\I : X \ra X^\I$$ is the unit of $\I^*\dashv \I_*$ at $X$.  It suffices to show that $\I^*(\eta_{X}^\I)$ is also an inverse for $\pi_*\eta_X$ which, more explicitly is:
\[
\pi_*\eta_X = \pi_*(\eta^\Delta_{\pi^*(\I^*X)}),
\]
where $\eta^\Delta$ is the unit of $\Delta^* \dashv \Delta_*$. Since $\I^*$ preserves exponentials, we have
\[
\I^*(\eta_{X}^\I) = \eta_{(\I^*X)}^\pi : \I^*X \ra (\I^*X)^{\I^*\I} \cong \pi_*\pi^*(\I^*X)\quad\text{(over $\I$)}.
\]
Now, for the composition of the $\pi^* \dashv {\pi}_*$ and $\Delta^* \dashv \Delta_*$ adjunctions, 

\begin{equation}\label{diagram:Deltapibasechange}
\xymatrix{
\cSet/\I\ \ar@<-1ex>[rr]_-{\Delta_*}  && \ar@<-1ex>[ll]_-{\Delta^*} \ \cSet/\I\times\I \ \ar@<-1ex>[rr]_-{\pi_*}  
	&& \ar@<-1ex>[ll]_-{\pi^*} \ \cSet/\I 
}
\end{equation}
the units $\eta^\pi$ and $\eta^\Delta$ satisfy the well-known law
\[
\eta^{\pi\circ\Delta} = \pi_*(\eta^{\Delta}_{\pi^*}) \circ (\eta^\pi)\,.
\]
But $\eta^{\pi\circ\Delta} = \mathsf{id}$, since $\pi\circ\Delta =1$.  We therefore have 
\[
\pi_*(\eta^\Delta_{\pi^*(\I^*X)}) \circ \eta_{(\I^*X)}^\pi = \eta^{(\pi\circ\Delta)}_{(\I^*X)} = \mathsf{id}_{(\I^*X)},
\]
as required.
\end{proof}

%the maps $X^\delta : X^\I \ra X$ and $(X^\I)^\delta : (X^{\I})^{\I} \ra X^\I$ make the following commute, and indeed make $\epsilon_\delta$ a retract of $\pi_1\circ\pi_*\langle \epsilon_\delta, \epsilon_{\delta'}\rangle$ in the arrow category of $\cSet/\I$.
%\begin{equation}\label{diagram:compimpfill4}
%\xymatrix{
%X^\I \ar[dd]_{\epsilon_\delta} \ar[r]^{\rho_{X^\I}} 
%	& (X^{\I})^{\I} \ar[d]^{\pi_*\langle \epsilon_\delta, \epsilon_{\delta'}\rangle} \ar[r]^{(X^\I)^\delta} & X^\I \ar[dd]^{\epsilon_\delta}  \\
% & (X\times X)^\I \ar[d]^{\pi_1^\I} & \\
%X\ar[r]_{\rho_X} & X^I \ar[r]_{X^\delta} & X,
%}
%\end{equation}
%To see that this commutes, note that the middle vertical composite is known to be $(\epsilon_\delta)^\I$ by construction.
%
%Finally, we claim that there is a map $\gamma: (X\times X)^\I \ra X^\I$ making the following commute.
%\begin{equation}\label{diagram:compimpfill5}
%\xymatrix{
%X^\I \ar[dd]_{\epsilon_\delta} \ar[r]^{\rho_{X^\I}} 
%	& (X^{\I})^{\I} \ar[d]_{\pi_*\langle \epsilon_\delta, \epsilon_{\delta'}\rangle} \ar[r]^{(X^\I)^\delta} & X^\I \ar[dd]^{\epsilon_\delta}  \\
% & (X\times X)^\I \ar[d]_{\pi_1^\I} \ar@{..>}[ru]_{\gamma} & \\
%X\ar[r]_{\rho_X} & X^I \ar[r]_{X^{\delta}} & X,
%}
%\end{equation}
%Indeed, up to isomorphism, the right hand part of this last diagram is:
%\begin{equation}\label{diagram:compimpfill6}% _{ X^{ (\delta_{\I} ) } } % ^{ X^{ (\I_{\delta}) } } 
%\xymatrix{
%X^{\I\times\I} \ar[rd]^{X^\phi}\ar[dd]_{X^{(\delta_{\I})}}  \ar[rr]^{X^{(\I_{\delta})}} 
% && X^\I \ar[dd]^{X^\delta}  \\
%& X^{\I+\I} \ar[ld]_{X^L} \ar@{..>}[ru]_{\gamma} & \\
%X^\I \ar[rr]_{X^{\delta}} && X,
%}
%\end{equation}
%in which all maps are of the form $X^{(-)}$, and are induced by the following,
%\begin{equation}\label{diagram:compimpfill7}
%\xymatrix{
%\I\times\I  && \I \ar[ll]_{\I_\delta}  \ar@{..>}[ld]^{G} \\
% 	& \ar[lu]_{\phi} \I+\I & \\
%\I \ar[uu]^{\delta_\I}  \ar[ru]_{L} && \ar[ll]^{\delta}  \ar[uu]_{\delta}  1.
%}
%\end{equation}
%in which:
%\begin{align*}
%\I_\delta &:= \langle \delta!, 1_\I\rangle \\
%\delta_\I &:= \langle 1_\I,\delta!\rangle \\
%\phi &:= [\delta_\I, \I_\delta]\\
%L &:= \text{the left coproduct inclusion.}
%\end{align*}
%For $G : \I\ra \I+\I$ we can therefore also take the right coproduct inclusion $R$ to make everything commute .... .  
%
%XXXXX Need to add the side condition on the composition when the two points are the same.
%We then let $\gamma := X^R$ to complete the proof.

\subsubsection*{Composition for a map}
We next generalize the notion of compostion for an object $X$ to composition for a map $f : Y\ra X$.  First consider biased fibrations in the sense of section \ref{sec:biasedfibration}; recall from Corollary \ref{cor:fibstrequivplustr} that a (biased) fibration structure on a map $f :Y\ra X$ is the same thing as a pair of $+$-algebra structures on the maps
\[
(\delta_\epsilon\Rightarrow\!{f}) : Y^\I \ra X^\I \times_{X} Y
\]
for $\epsilon = 0,1$.  The construction of $\delta_0\Rightarrow\!{f}$ is recalled from \eqref{diagram:pullbackhom} in the pullback diagram below, in which $X^{\delta_0}:X^\I \ra X$ is the evaluation map at $\delta_0 : 1\ra \I$.
\begin{equation}\label{diagram:pullbackhomreview}
\xymatrix{
Y^\I \ar@/_4ex/ [rdd]_{f^\I} \ar[rd]^{\delta_0\Rightarrow{f}} \ar@/^4ex/ [rrd]^{Y^{\delta_0}} && \\
& X^\I \times_{X} Y \ar[d] \ar[r] & Y \ar[d]^{f} \\
& X^\I \ar[r]_{X^{\delta_0}} &  X
}
\end{equation}
%
Given another point $\delta_1 : 1\ra \I$, we have an analogous construction
\begin{equation}\label{diagram:pullbackhomreviewprime}
\xymatrix{
Y^\I \ar@/_4ex/ [rdd]_{f^\I} \ar[rd]^{\delta_1\Rightarrow{f}} \ar@/^4ex/ [rrd]^{Y^{\delta_1}}  && \\
& X^\I \times_{X} Y \ar[d] \ar[r] & Y \ar[d]^{f} \\
& X^\I \ar[r]_{X^{\delta_1}} &  X.
}
\end{equation}
But note that now the pullback object $X^\I \times_{X} Y $ is a different one, with fiber over $p : \I \ra X$ being the fiber of $f$ over $p\delta_1$ rather than over $p\delta_0$.  Let us call these two different pulled-back maps $f_0:Y_0\ra X^\I$ and $f_1:Y_1 \ra X^\I$ and write $f^\epsilon := (\delta_\epsilon\Rightarrow{f})$ for $\epsilon = 0,1$.  There is then a commutative diagram,
%
\begin{equation}\label{diagram:composition3}
\xymatrix{
Y^\I \ar[d]_{f^0} \ar[rd]|{f^\I} \ar[r]^{f^1} & Y_1 \ar[d]^{f_1}\\
Y_0 \ar[r]_{f_0} & X^\I\,,
}
\end{equation}
%
We will say that $f:Y\ra X$ \emph{has composition from 0 to 1} if for every cofibration $c : C\mono Z$ and maps $y_0 : Z\ra Y_0$ and $y : C\ra Y^\I$ making the square on the left below commute, there is a map $y_1 : Z\ra Y_1$ making the following commute.
\begin{equation}\label{diagram:composition4}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[r]^{y} & Y^\I \ar[d]_>>>>>>>{f^0} \ar[r]^{f^1} & Y_1 \ar[d]^{f_1}\\
Z \ar@{..>}[rru]_>>>>>>{y_1} \ar[r]_{y_0} & Y_0 \ar[r]_{f_0} & X^\I
}
\end{equation}

To define \emph{unbiased} composition, we begin with $f : Y\ra X$ in $\cSet$ and then move to $\cSet/\I$, where we have the generic point $\delta : 1\ra\I$.  Now we consider an arbitrary cofibration $c : C\mono Z$ and maps $y_\delta : Z\ra Y_\delta$ and $y : C\ra Y^\I$ making the square below commute
\begin{equation}\label{diagram:composition3}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[r]^{y} & Y^\I \ar[d]^{f^\delta} \\
Z \ar[r]_{y_\delta} & Y_\delta 
}
\end{equation}
where $Y_\delta$ and $f^\delta$ are defined in terms of $\delta : 1\ra \I$ just as were $Y_0$ and $f^0$ in terms of $\delta_0 : 1\ra \I$.  Passing to $\cSet/(\I\times \I)$ by a further pullback, as before we have another point $\delta':1\ra\I$, as well as a subobject $\Delta \mono 1$, determined by the further diagonals.

\begin{definition}
The map $f:Y\ra X$ \emph{has (unbiased) composition} if, in $\cSet/\I$, for any cofibration $c : C\mono Z$ and maps $y_\delta : Z\ra Y_\delta$ and $y : C\ra Y^\I$ as on the left below, there is in $\cSet/(\I\times \I)$ a map $y_{\delta'} : Z\ra Y_{\delta'}$ making the following commute
\begin{equation}\label{diagram:composition4}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[r]^{y} & Y^\I \ar[d]_>>>>>>>{f^\delta} \ar[r]^{f^{\delta'}} & Y_{\delta'} \ar[d]^{\eta_{Y_{\delta'}}}\\
Z \ar@{..>}[rru]_>>>>>>{y_{\delta'}} \ar[r]_{y_\delta} & Y_\delta \ar[r]_{\eta_{Y_\delta}} & Y^\Delta\,,
}
\end{equation}
where $Y_{\delta'}$ and $f^{\delta'}$ are defined in terms of $\delta' : 1\ra \I$, and $Y^\Delta$ is $Y_\delta^\Delta = Y_{\delta'}^\Delta$, since $\Delta^*{\delta} = \Delta^*{\delta'}$.
\end{definition}


\begin{proposition}\label{prop:comptofillmap}
Composition implies filling for maps; that is, every $f : Y\ra X$ with composition is a fibration.
\end{proposition}

\begin{proof}
Analogous to the proof of Proposition \ref{prop:comptofillobj}.
\end{proof}

\begin{remark}
One can also promote the \emph{property} of an object or map of ``having composition'' to the notion of a \emph{composition structure}.  This procedes via the notion of a \emph{uniform composition structure}, which is defined with respect to cofibrations $c : C\mono \I^n$ with representable codomains, and a requirement of naturality in $\I^n$, and which can then be internalized as a suitable map representing the uniform structure, in a way that is analogous to the case for trivial fibrations formulated in proposition \ref{prop:uniformstructequivrelative}.
\end{remark}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{Composition with connections}\label{appendix:comptofillconnection}

For two points $p, q: 1 \ra \I$, a cubical set $X$ \emph{has composition from $p$ to $q$} if for every object $Z$ and cofibration $c:C\mono Z$ and commutative square 
\begin{equation}\label{apdiagram:composition3}
\xymatrix{
C \ar@{>->}[d]_{c} \ar[r]  & X^\I \ar[d]^{\epsilon_p} \\
Z \ar[r] & X,
}
\end{equation}
there is a diagonal arrow $k : Z \ra X\times X$ making both subdiagrams below commute,
\begin{equation}\label{apdiagram:composition2}
\xymatrix{
C \ar@{>->}[dd]_{c} \ar[r]  & X^\I \ar[d]^{\langle \epsilon_p, \epsilon_q\rangle} \\
& X\times X \ar[d]^{\pi_1} \\
Z \ar[r] \ar@{..>}[ru]^{k} & X,
}
\end{equation}
where $\epsilon_p : X^\I\ra X$ is the ``evaluation at $p$'' map $X^p$, and similarly for $\epsilon_q : X^\I\ra X$.  

\begin{proposition}
In cubical sets with connections, if an object $X$ has composition from $\delta_0$ to $\delta_1$ and back, then $X$ has filling for all trivial cofibrations $c\otimes \delta : B \mono Z\times \I$, where $c : C\mono Z$ is any cofibraiton and $\delta = \delta_0 , \delta_1 : 1\ra \I$. %Thus $X$ is fibrant.  The same holds for maps $f: Y\ra X$.
\end{proposition}

%\begin{proof}
%First, we require a lemma:
%
%\begin{lemma}
%If $X$ has composition, so does $\delta\Rightarrow X$ for both endpoints $\delta : 1 \ra \I$.
%\end{lemma}
%\begin{proof}
%We need to show that 
%\end{proof}
%
%\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\begin{frame}{Filling and Composition}

An object $X$ has filling for all trivial cofibrations  $c\otimes \delta : B \mono Z\times \I$ iff for all cofibrations $c : C \mono Z$ and squares as below there is a diagonal filler
\[
\xymatrix{
 C \ar@{>->}[d]_{c} \ar[r] & X^\I  \ar[d]^{\delta\Rightarrow X} \\
 Z\ar[r] \ar@{..>}[ru] & X
}
\]
where the Leibniz exponential $\delta\Rightarrow X : X^\I \ra X$ is ``evaluation at the endpoint $\delta: 1 \ra \I$'' (and we require the condition for both endpoints $\delta = \delta_0 , \delta_1$).  Clearly if $X$ has filling then it has composition, since there is then a diagonal filler $k$ making both subdiagrams commute in
\[
\xymatrix{
 C \ar@{>->}[dd]_{c} \ar[r] & X^\I  \ar[d]^{\partial\Rightarrow X} \\
 	& X\times X  \ar[d] \\
 Z\ar[r] \ar@{..>}[ru]^k & X
}
\]
where $(\partial\Rightarrow X) : X^\I \ra X\times X$ is the Leibniz exponential of $X$ by the boundary map $\partial: 1+1 \ra \I$, and we require the condition for both projections $X\times X\ra X$.

Conversely, we can obtain filling from composition as follows: 
to fill the following open 2-box in $X$:
\[
\xymatrix{
A'&& B'  \\
\\
A \ar[uu]^a \ar[rr]_p && B \ar[uu]_b  
}
\]
First make a higher-dimensional composition problem using the connections on the right and left sides: 
\[
\xymatrix{
A' &&& B'  \\
 & A \ar[lu]_a \ar[r]^p & B \ar[ru]^b & \\
 & A \ar[ld]_= \ar[r]_p \ar[u]^=  & B \ar[u]_= \ar[rd]^= & \\
A \ar[uuu]^a \ar[rrr]_p &&&  B  \ar[uuu]_b 
}
\]
Then since $X$ has composition, the (partial) open 3-box has a top face, which is then a filler for the original open 2-box.
\[
\xymatrix{
A' &&& B'  \\
 & A \ar[lu]_a \ar[r]^p & B \ar[ru]^b & \\
 & A \ar[ld]_= \ar[r]_p \ar[u]^=  & B \ar[u]_= \ar[rd]^= & \\
A \ar[uuu]^a \ar[rrr]_p &&&  B  \ar[uuu]_b
}
\]

For a general, algebraic proof, first 
%show that if $X$ has composition, then so does $\delta\Rightarrow X$.
use the connections to get maps in $\mathcal{E}^\mathbbm{2}$ of the form
\[
\xymatrix{
\delta  & \ar[l]_=\delta \ar[d] \\
\delta \otimes \delta \ar[u] & i \otimes \delta  \ar[l] 
}
\]
where $i : 1 \ra 1+1$.

Applying the functor $(-)\Rightarrow X$ gives the top square in:
\[
\xymatrix{
\delta \Rightarrow\!X \ar[d]  \ar[r]^= & \delta\Rightarrow\!X \\
\delta \otimes \delta\Rightarrow\!X  \ar[d]_\cong \ar[r] & i \otimes \delta\Rightarrow\!X   \ar[u] \\
\delta\Rightarrow\!(\delta\Rightarrow\!X)   \ar[r] & \delta\Rightarrow\!(i\Rightarrow\!X)  \ar[u]_\cong \\
}
\]
while the bottom one is by the $\otimes\dashv\,\Rightarrow$ adjunction.

%\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\begin{frame}{Filling and Composition}

So for any cofibration $c : C \mono Z$ and filling problem
\[
\xymatrix{
C \ar@{>->}[d]_c \ar[r] & X^\I \ar[d]^{\delta\Rightarrow\!X} \\
Z \ar[r] & X
}
\]
we can extend on the right as follows.
\[
\xymatrix{
C \ar@{>->}[d]_c \ar[r] & X^\I \ar[d]^{\delta\Rightarrow\!X}  \ar[r] \ar@/^1pc/[rrrrr]^{=} & \cdot \ar[d]^{\delta\Rightarrow\!(\delta\Rightarrow\!X)}  \ar[rr] 
	&& \cdot \ar[d]^{\delta\Rightarrow\!(i\Rightarrow\!X)}  \ar[rr]  && X^\I \ar[d]^{\delta\Rightarrow\!X}  \\
Z \ar[r] & X  \ar[r] \ar@/_1pc/[rrrrr]_{=} & \cdot  \ar[rr] && \cdot  \ar[rr] && X
}
\]

Transposing the left three squares yields
\[
\xymatrix{
\cdot \ar@{>->}[d]_{c\otimes \delta} \ar[rr] &&\cdot \ar@{>->}[d]_{(\delta\Rightarrow\!X)\otimes \delta} \ar[r] & X^\I \ar[d]^{\delta\Rightarrow\!X}  \ar[rr] && X^{1+1} \ar[d]^{i\Rightarrow\!X}   \\
\cdot \ar[rr] && \cdot \ar[r] & X  \ar[rr]_= && X  
}
\]
%\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\begin{frame}{Filling and Composition}
which has a diagonal filler by composition, since $c\otimes \delta$ is also a cofibration.
\[
\xymatrix{
\cdot \ar@{>->}[d]_{c\otimes \delta} \ar[rr] &&\cdot \ar@{>->}[d]_{(\delta\Rightarrow\!X)\otimes \delta} \ar[r] &  X^\I \ar[d]^{\delta\Rightarrow\!X}  \ar[rr] && X^{1+1} \ar[d]^{i\Rightarrow\!X}   \\
\cdot \ar[rr] \ar@{..>}[rrrrru]&& \cdot \ar[r] &  X  \ar[rr]_= && X  
}
\]
%\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\begin{frame}{Filling and Composition}

Transposing back thus gives a diagonal filler
\[
\xymatrix{
C \ar@{>->}[d]_c \ar[r] & X^\I \ar[d]^{\delta\Rightarrow\!X}  \ar[r] \ar@/^1pc/[rrrrr]^{=} & \cdot \ar[d]^{\delta\Rightarrow\!(\delta\Rightarrow\!X)}  \ar[rr] 
	&& \cdot \ar[d]^{\delta\Rightarrow\!(i\Rightarrow\!X)}  \ar[rr]  && X^\I \ar[d]^{\delta\Rightarrow\!X}  \\
Z \ar[r] \ar@{..>}[rrrru] & X  \ar[r] \ar@/_1pc/[rrrrr]_{=} & \cdot  \ar[rr] && \cdot  \ar[rr] && X
}
\] 
which provides a filler for the original problem
\[
\xymatrix{
C \ar@{>->}[d]_c \ar[r] & X^\I \ar[d]^{\delta\Rightarrow\!X} \\
Z \ar[r] \ar@{..>}[ru] & X
}
\]
\qed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{Fibrancy of $\U$}

\begin{proposition}
The universe $\U$ is fibrant.
\end{proposition}
By the reduction of filling to composition (Proposition \ref{prop:comptofillobj}), it suffices to show:
\begin{lemma}
The universe $\U$ has composition.
\end{lemma}
\begin{proof}
Consider a composition problem
\[
\xymatrix{
C \ar@{>->}[dd]_{c} \ar[rr]  && \U^\I \ar[d] \\
&& \U\times \U\ar[d] \\
Z \ar[rr]  \ar@{..>}[rru]^{k} && \U
}
\]
We claim that the canonical map $\U^\I \ra \U\times \U$ factors over $\U\times\U$ through the object $\mathsf{Eq}$ 
of equivalences, via a map $i$ as indicated below.
\begin{equation}\label{diag:idtoeq}
\xymatrix{
C \ar@{>->}[ddd]_{c} \ar[rr]  && \U^\I \ar[d]^i \\
&& \mathsf{Eq} \ar[d]  \\
&& \U\times \U\ar[d] \\
Z \ar[rr] \ar@{..>}[rruu]^{j}  \ar@{..>}[rru]^{k} && \U
}
\end{equation}
Since the projection $\mathsf{Eq} \ra \U$ is a trivial fibration by the equivalence extension property \ref{fillinthereference}, there is a diagonal filler $j$.  Composing gives the required $k$.

The claimed map $i$ is usually known as $\mathsf{IdtoEq}: \U^\I \ra \mathsf{Eq}$, and is defined in type theory by transport. 

[ fill this in ...]

\end{proof}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{Appendix 2:  A left-induced model structure on the Cartesian cubical sets}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

We make use of the Sattler model structure \cite{sattler} on the \emph{Dedekind cubical sets} $\widehat\D = \psh{\D}$, where $\D$ is the category of \emph{Dedekind cubes}, defined as the Lawvere theory of distributive lattices.  The unique product-preserving functor 
\[
i : \C \ra \D
\]
classifying the Dedekind interval $\I_\D \in \D$ induces an adjunction,
\[
i_! \dashv i^* \dashv i_*\ :\ \widehat\C \ \ra \widehat\D \,,
\]
where $i^* (Q) = Q\circ i$, for $Q \in \D$.  

\begin{lemma}
Observe that $i_!$ is left exact since the Dedekind interval $\I_\D$ is \emph{strict}, $0 \neq 1 : 1\rightrightarrows\I_\D$.  Thus we have geometric morphisms:
\[
(i_! \dashv i^*) :\ \widehat\D \ \ra \widehat\C \,,
\]
classifying the bipointed object $i_!(\I_\C) = \I_\D$,
\[
(i^* \dashv i_*) :\ \widehat\C \ \ra \widehat\D \,,
\]
classifying the dLat $i^*(\I_\D) := \I$, where $\eta : \I_\C\ra \I$ can be described pointwise as the distributive lattice completion of the corresponding bipointed set.

Also, since $i$ is faithful so is $i_!$,  and since $i$ is surjective on objects $i^*$ is also faithful.

It follows that:
\begin{itemize}
\item $\widehat\C$ is $(i_!\circ i^*)$-coalgebras on $\widehat\D$, 
\item $\widehat\D$ is $(i^*\circ i_*)$-coalgebras on $\widehat\C$, 
\item $\widehat\D$ is $(i^*\circ i_!)$-algebras on $\widehat\C$. 
\end{itemize}
\end{lemma}

We will use the following transfer theorem for QMSs from \cite{Hess,Garner}:

\begin{theorem*}[\cite{Hess,Garner}]
Suppose $\widehat\D$ has a (cofibrantly generated) model structure $(\mathcal{C}_\D, \mathcal{W}_\D, \mathcal{F}_\D)$.  Given an adjunction 
\[
i_! \dashv i^* \ :\ \widehat\D \ra \widehat\C\,,
\]
there is a \emph{left-induced model structure} on $\widehat\C$ if the following \emph{acyclicity condition} holds:
\[
(i_!^{-1}\mathcal{C}_\D)^{\pitchfork}\  \subset \  i_!^{-1}\mathcal{W}_\D\,.
\]
For the left-induced model structure $(\mathcal{C}_\C, \mathcal{W}_\C, \mathcal{F}_\C)$ on $\widehat\C$ we then have:
\begin{align*}
\mathcal{C}_\C\ &=\ i_!^{-1}\mathcal{C}_\D\,,\\
\mathcal{W}_\C\ &=\ i_!^{-1}\mathcal{W}_\D\,.
\end{align*}
\end{theorem*}

The Sattler model structure on $\widehat\D$ is given as follows (for a constructive treatment a smaller class of ``pointwise decidable cofibrations'' is used, but we consider the classical case first):
\begin{align*}
\mathcal{C}\ &=\ \text{monomorphisms}\,,\\
\mathcal{W}\  &=\ \{ f \ |\ f = p\circ i ,\ p\in \mathcal{F}\cap\mathcal{W} ,\ i\in \mathcal{C}\cap\mathcal{W}\,\}\,,\\
\mathcal{F}\  &=\ (\mathcal{C}\otimes\delta)^\pitchfork\,.
\end{align*}
where $\delta : 1\ra\I$ is either endpoint inclusion.

For the left-induced model structure on $\widehat\C$ we therefore have the following specification:
\begin{align*}
\mathcal{C}\ &=\ \text{monomorphisms},\\
\mathcal{W}\  &=\ \{ f \ |\ i_!f = p\circ i ,\ p\in \mathcal{F}_\D\cap\mathcal{W}_\D ,\ i\in \mathcal{C}_\D\cap\mathcal{W}_\D\,\}\,,\\
\mathcal{F}\  &=\ (\mathcal{C}\cap\mathcal{W})^\pitchfork\,.
\end{align*}
The determination  of $\mathcal{C}$ follows from the fact that $i_! :\widehat\C\ra \widehat\D$ is conservative.

To check the acyclicity condition, 
\[
(i_!^{-1}\mathcal{C}_\D)^{\pitchfork}\  \subset \  i_!^{-1}\mathcal{W}_\D\,,
\]
we know that $i_!^{-1}\mathcal{C}_\D$ consists of the monos in $\C$, so take $f : Y\ra X$ in $(i_!^{-1}\mathcal{C}_\D)^{\pitchfork}$, apply $i_!$,  and factor the result as $i_!f = p\circ m : i_!Y\ra Z\ra i_!X$ with $p\in \mathcal{F}_\D\cap\mathcal{W}_\D$ and $m : i_!Y\ra Z$ monic. We then need to show that $m$ is in~$\mathcal{W}_\D$.

We can apply Theorem 2.2.1 of \cite{Hess}, with $\mathsf{K} = \widehat\C$, $\mathsf{M} = \widehat\D$, $V = i_!$, $k=i^*$, and:
\begin{enumerate}
\item $QX = X$ and $\epsilon = 1_X : X\ra X$, so that $i_!1_X = 1_{i_!X}$ and therefore in $\mathcal{W}_\D$, while all objects are cofibrant,
\item $Qf = f$ for any $f:X\ra Y$ in $\widehat\C$, so that the naturality condition is similarly trivial,
\item factor the codiagonal $X + X \ra X$ as $\pi_2\circ j : X + X \ra \I\times X \ra X$ with $j = (\partial\I\times X) : X + X \ra \I\times X$.
 \end{enumerate}
 It remains only to show that $i_!p : \i_!(\I\times X) \ra i_!X$ is in $\mathcal{W}_\D$ and  $i_!j : i_!(X + X) \ra i_!(\I\times X)$ is in $\mathcal{C}_\D$.  The latter  is clear, since $j$ is monic. To show the former, observe that for any $D\in \widehat\D$, the projection $\pi_2 : \I_\D\times D \ra D$ is in $\mathcal{W}_\D$ by 3-for-2, since the ``cylinder end'' inclusion $D\ra\I_\D\times D$, as a pullback of an endpoint inclusion, is a cofibration, and a strong deformation retract (using the connection on $\I$), and hence is in $\mathcal{W}_\D$ by \cite{GS}.

Thus we have shown:

\begin{theorem}
There is a Quillen model structure $(\mathcal{C}, \mathcal{W}, \mathcal{F})$ on the category $\widehat\C$ of cartesian cubical sets, in which
\begin{align*}
\mathcal{C}\ &=\ \text{monomorphisms},\\
\mathcal{W}\  &=\ \{ f \ |\ i_!f = p\circ i ,\ p\in \mathcal{F}_\D\cap\mathcal{W}_\D\,,\ i\in \mathcal{C}_\D\cap\mathcal{W}_\D\,\}\,,\\
\mathcal{F}\  &=\ (\mathcal{C}\cap\mathcal{W})^\pitchfork\,.
\end{align*}
where $i_! : \widehat\C \ra\widehat\D$ is the left adjoint of precomposition along the canonical map $i : \C \ra \D$ from Cartesian cubes to Dedekind cubes, and $(\mathcal{C}_\D, \mathcal{W}_\D, \mathcal{F}_\D)$ is the Sattler model structure on $\widehat\D$.
\end{theorem}


\bibliographystyle{alpha}
\bibliography{references}


%%%
\end{document}
%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Appendix 3: Logical specification of filling}\label{appendix:logicalspec}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


In order to simplify the exposition in this section we will first consider biased fibration structures in the sense of section \ref{sec:biasedfibration}.  Recall that a (biased) fibration structure on a map $f :Y\ra X$ is essentially the same thing as a pair of $+$-algebra structures on the maps
\[
(\delta_\epsilon\Rightarrow\!{f}) : Y^\I \ra X^\I \times_{X} Y 
\]
Let us drop the index $\epsilon$ and consider only the case of $\epsilon = 0$, since later on we shall use the generic $\delta$ anyway. The construction of $\delta\!\Rightarrow\!{f}$ is recalled from \eqref{diagram:pullbackhom} in the pullback diagram below.

\begin{equation}\label{diagram:pullbackhom2}
\xymatrix{
Y^\I \ar@/_4ex/ [rdd] \ar[rd]^{\delta\Rightarrow{f}} \ar@/^4ex/ [rrd] && \\
& X^\I \times_{X} Y \ar[d] \ar[r] & Y \ar[d] \\
& X^\I \ar[r] &  X
}
\end{equation}

In order to compare with \cite{OP}, let us switch to informal type-theoretic notation and write $Y=\sum_{x:X}A(x)$ for a type-valued map $A : X\ra \U$.  Let $\mathsf{eval}_0 = X^\delta : X^\I\ra X$, so that the above pullback becomes
\begin{equation*}\label{diagram:pullbackhom3}
\xymatrix{
 {\sum_{p:X^\I}}A(p0) \ar[d] \ar[r] \pbcorner & {\sum_{x:X}}A(x) \ar[d] \\
 X^\I \ar[r]_{\mathsf{eval}_0} &  X
}
\end{equation*}
The map $f^\I:Y^\I\ra X^\I$ may be rewritten as a family over $X^\I$ in the form:
\[
(\sum_{x:X}A(x))^\I \cong \prod_{i:\I}\sum_{x:X}A(x) \cong \sum_{p:X^\I}\prod_{i:\I}A(pi)
\]
so that up to isomorphism our previous diagram \eqref{diagram:pullbackhom2} becomes:
\begin{equation*}\label{diagram:pullbackhom3}
\xymatrix{
{\sum_{p:X^\I}}\prod_{i:\I}A(pi) \ar@/_4ex/ [rdd] \ar[rd]^{\delta\Rightarrow{f}} \ar@/^4ex/ [rrd] && \\
& {\sum_{p:X^\I}}A(p0) \ar[d] \ar[r] \pbcorner & {\sum_{x:X}}A(x) \ar[d] \\
& X^\I \ar[r]_{\mathsf{eval}_0} &  X
}
\end{equation*}
Finally, pulling back along an arbitrary point $p : 1\ra X^\I$ we obtain the left-most map in the diagram below:
\begin{equation*}\label{diagram:pullbackhom3}
\xymatrix{
{\prod_{i:\I}}A(pi) \ar@/_4ex/ [rdd] \ar[rd] \ar[r] 
	& {\sum_{p:X^\I}}\prod_{i:\I}A(pi)  \ar[rd]^{\delta\Rightarrow{f}} \ar@/^4ex/ [rrd] && \\
& A(p0) \ar[d] \ar[r] \pbcorner & {\sum_{p:X^\I}}A(p0) \ar[d] \ar[r] \pbcorner & {\sum_{x:X}}A(x) \ar[d] \\
& 1 \ar[r]_{p} & X^\I \ar[r]_{\mathsf{eval}_0} &  X.
}
\end{equation*}

Since being a $+$-algebra (a trivial fibration) is a fiberwise property, we have shown:
\begin{proposition}
The map $f : Y\ra X$ is a fibration iff for all $p: X^\I$, the map ${\prod_{i:\I}}A(pi) \ra A(p0)$ just constructed (and its counterpart for $\epsilon = 1$) is a $+$-algebra.
\end{proposition}

The (internal) condition that ${\prod_{i:\I}}A(pi) \ra A(p0)$ is a $+$-algebra for all $p: X^\I$ is shown in Appendix 1 to be equivalent to the type-theoretic definition of \emph{fibration structure} on a type family $A: X\ra \U$ given in \cite{OP}.  That this notion of fibration structure is closed under the formation of $\Pi$-types can be shown directly, much as in \cite{OP}, and was formally verified (in the setting without connections, but with unbiased fibrations) by \cite{Zesen}.

%%%%%%%%
XXXXXXXXXXX stitch together this gap XXXXXXXXXXXX
%%%%%%%%

To make the connection to the logical style of presentation used in \cite{CCHM,OP}, suppose we want to describe a (uniform) filling structure on an arbitrary $f : X\ra Y$ with respect to all generating trivial cofibrations $m \otimes \delta_\epsilon : \I^n +_M (M\times\I) \ra \I^{n+1}$,
\begin{equation}\label{diagram:llpforf}
\xymatrix{
\I^n +_M (M\times\I) \ar[d]_{m \otimes \delta_\epsilon} \ar[r] & X \ar[d]^f \\
\I^{n}\times \I \ar@{.>}[ru] \ar[r]_c & Y.
}
\end{equation}
By pulling back along $c$, it suffices to consider  the case $Y=\I^{n}\times \I$ and $c$ the identity map. Moreover, since we shall internalize the quantification over all cofibrations $m : M\mono \I^n$ using the classifier $\Phi$, it suffices to consider just the following case internally,
\begin{equation}\label{diagram:llpforf2}
\xymatrix{
1 +_{[\varphi]} ([\varphi]\times\I) \ar[d]_{\varphi \otimes \delta_\epsilon} \ar[rr]^-{[a_0,s]} && X \ar[d] \\\
1\times\I \ar@{.>}[rru]_-a \ar[rr]_-{\cong} && \I
}
\end{equation}
where the cofibration $[\varphi] \mono 1$ is classified by $\varphi : 1\rightarrow \Phi$.

Using a universe $\Set$ in the internal language of $\widehat\C$, we can regard the family $X\ra \I$ internally as a map $P : \I\rightarrow\Set$ (switching notation from $X$ to $P$ to agree with \cite{OP}).  Thus we arrive at the following local specification, expressed logically in the internal language of $\widehat\C$, of the object of ``($0$-directed) lifting structures'' $L^0(P)$ on a family $P: \I\rightarrow\Set$\,:
%
\begin{equation}\label{eqn:pplift}
L^0(P)\ =\ \prod_{\varphi:\Phi}\, \prod_{s: \prod_{i:I}(Pi)^\varphi}\, \prod_{a_0:P0}\ a_0 |_\varphi = s0\ 
 \ra\sum_{a:\prod_{i:I}Pi} (a0 = a_0) \times (a |_\varphi = s)\,.
\end{equation}
%
Here the variables $s : \prod_{i:I}(Pi)^\varphi$ and $a_0:P0$, and the condition $a_0 |_\varphi = s0$, give the domain $1 +_{[\varphi]} ([\varphi]\times\I)$ of the arrow $[a_0,s]$ in \eqref{diagram:llpforf2}, and $a:\prod_{i:I}Pi$ is the diagonal filler, with $(a0 = a_0) \times (a |_\varphi = s)$ expressing the commutitivity of the top triangle.

There is an analogous condition $L^1(P)$ in which $1$ replaces $0$ everywhere, describing (``directed'')  filling from the other end of the interval.  Note that \cite{CCHM, OP} derive the ``filling'' conclusion $$\sum_{a:\prod_{i:I}Pi} (a0 = a_0) \times (a |_\varphi = s)$$ from (connections on $\I$ and) a weaker ``composition operation'' $$\sum_{a_1:P1} a_1 |_\varphi = s_1\,,$$ but we will not take this approach.

The specification of the type $L^0(P)$ of \eqref{eqn:pplift} can also be represented diagrammatically as follows:
%\begin{equation}\label{diagram:ppl}
%\xymatrix{
%& P0 \ar[rr] \ar[dd] |\hole  & & P \ar[dd] \\
%[\varphi] \ar[ru] ^{s0} \ar[rr] \ar@{ >->}[dd] & & [\varphi]\!\times\!\I \ar[ru]^s \ar@{ >->}[dd] & \\
%& 1 \ar[rr]_<<<<<<<<<{\delta_0} |>>>>>>>>>>>>>>>\hole & & \I \\
%\I^n \ar[ru] \ar[rr] \ar[ruuu]|>>>>>>>>>>>>>\hole _{a_0} & & \I^n\!\times\!\I \ar@{.>}[ruuu] _a \ar[ru]_{\pi_2} & }
%\end{equation}
\begin{equation}\label{diagram:ppl}
\xymatrix{
& P0 \ar[rr] \ar[dd] |\hole  & & P \ar[dd] \\
[\varphi] \ar[ru] ^{s0} \ar[rr] \ar@{ >->}[dd] & & [\varphi]\!\times\!\I \ar[ru]^s \ar@{ >->}[dd] & \\
& 1 \ar[rr]_<<<<<<<<<{\delta_0} |>>>>>>>>>>>>>>>\hole & & \I \\
1 \ar[ru] \ar[rr] \ar[ruuu]|>>>>>>>>>>>>>\hole _{a_0} & & 1\!\times\!\I \ar@{.>}[ruuu] _a \ar[ru]_{\pi_2} & }
\end{equation}
Here the left-hand vertical square is determined as a pullback of the right-hand one along the endpoint $\delta_0 : 1 \ra \I$.

Now write 
\[
\widetilde{P}\ =\ \prod_{i:I}Pi
\]
for the type of sections of the projection $P = \sum_{i:I}Pi \ra \I$, and write
\[
\pi_0 : \widetilde{P} \ra P0
\]
for the $0^{th}$-projection (i.e.\ the evaluation of $P : \I\ra\Set$ at $0:\I$).

Then the (0-directed) lifting structures on $P$ correspond to $+$-algebra structures on the projection $\pi_0 : \widetilde{P} \ra P0$, as follows.

\begin{proposition}
For any $ P : \Set^\I$, there is an isomorphism
\[
L^0(P)\ \cong\ \plusalg{\pi_0 : \widetilde{P} \ra P0}\,.
\]
\end{proposition}
%\begin{proof}
%Consider the following diagram,
%\begin{equation}\label{diagram:pplext}
%\xymatrix{
%&  {\widetilde{P}} \ar[rr] \ar[dd] ^{\pi_0} & &  {\widetilde{P}}\times\I \ar[dd]^{\varepsilon} \\
%&&& \\
%& P0 \ar[rr] |>>>>>>>>>>\hole \ar[dd] |\hole & & P \ar[dd] \\
%[\phi] \ar[ruuu]^>>>>>>>>>>>>{\overline{s}_0} \ar[ru]^>>>>{s0} \ar[rr] \ar@{ >->}[dd] & & [\phi]\!\times\!\I \ar[ruuu]^>>>>>>>>>>>>>{\overline{s}} \ar[ru]^>>>>>>>s \ar@{ >->}[dd] & \\
%& 1 \ar[rr]_<<<<<<<<<{\delta_0} |>>>>>>>>>>>>>>>>>>\hole & & \I \\
%\I^n \ar[ru] \ar[rr] \ar[ruuu]|>>>>>>>>>>>>>\hole _{a_0} & & \I^n\!\times\!\I \ar@{.>}[ruuu] _a \ar[ru]_{\pi_2} & }
%\end{equation}
%which is \eqref{diagram:ppl}, extended by the counit (evaluation) $\varepsilon : \widetilde{P}\times \I \ra P$ over $\I$ on the right, and with $\I^n$ replacing $1$ in order to reason externally.  The pullback of $\varepsilon$ over $\I$ along $\delta_0$ is just $\pi_0 : \widetilde{P} \ra P0$.  
%
%Given an $L^0(P)$-structure we construct a $\plusalgx$-structure on $\pi_0 : \widetilde{P} \ra P0$ as follows: for any $\I^n$ and cofibration $i_\phi : [\phi]\mono \I^n$ and any commutative square,
%\[
%\xymatrix{
%[\phi] \ar@{>->}[d]_{i_\phi} \ar[rr]^{s} & & {\widetilde{P}}  \ar[d]^{\pi_0} \\
%\I^n \ar[rr]_{a_0} && P0\,,
%}
%\]
%we require a diagonal filler,
%\[
%\xymatrix{
%[\phi] \ar@{>->}[d]_{i_\phi} \ar[rr]^{s} & & {\widetilde{P}}  \ar[d]^{\pi_0} \\
%\I^n \ar[rr]_{a_0} \ar@{ .>}[rru]_j && P0\,,
%}
%\]
%uniformly in $\I^n$ and $\phi$\,.  Transposing the span formed by $i_\phi$ and $s$ along the adjunction $\I^* \dashv \prod_{\I}$ gives the right-hand square in \eqref{diagram:pplext}, and the commutative square formed by $a_0$ and $\pi_0$ gives the rest of the data in that diagram. Thus the $L^0(P)$-structure gives an $a : \I^n\times\I\ra P$ as indicated.  Looking at \eqref{diagram:pplext}, we see that $a$ lifts across $\varepsilon$ to a unique map $\overline{a} : \I^n\times\I\ra \widetilde{P}\times\I$ over \I, by the universal property of $\varepsilon : \widetilde{P}\times\I \ra P$.  We can therefore set $$j = \delta_0^*( \overline{a}) : \I^n \ra \widetilde{P}\,.$$
%
%Suppose conversely that we have a $\plusalgx$-structure on $\pi_0 : \widetilde{P} \ra P0$, and we want to build a (0-directed) partial path-lifting structure on $P$.  Take any $\I^n, \phi, s, a_0$ as indicated and we require an $a : \I^n\times\I\ra P$ over $\I$.    From $s$ we get $\overline{s}$ by the universal property of $\varepsilon$, and therefore we get $\overline{s}_0$ by pullback.   From $\overline{s}_0$ and $a_0$ and the $\plusalgx$ structure on $\pi_0$ we get a map $j : \I^n \ra \widetilde{P}$ over $P0$ which is a diagonal filler of the indicated square formed by $i_\phi, \overline{s}_0, a_0$ and $\pi_0$.  We then get the required map $a : \I^n\times\I\ra P$ over $\I$ as the ($\I^* \dashv \prod_{\I}$)-transpose of $j$,
%\[
%a = \varepsilon \circ(j\times\I)\,.
%\]
%
%We leave to the reader the verification that these assignments are mutually inverse.
%\end{proof}
\begin{proof}
Consider the following diagram,
\begin{equation}\label{diagram:pplext}
\xymatrix{
&  {\widetilde{P}} \ar[rr] \ar[dd] ^{\pi_0} & &  {\widetilde{P}}\times\I \ar[dd]^{\varepsilon} \\
&&& \\
& P0 \ar[rr] |>>>>>>>>>>\hole \ar[dd] |\hole & & P \ar[dd] \\
[\varphi] \ar[ruuu]^>>>>>>>>>>>>{\overline{s}_0} \ar[ru]^>>>>{s0} \ar[rr] \ar@{ >->}[dd] & & [\varphi]\!\times\!\I \ar[ruuu]^>>>>>>>>>>>>>{\overline{s}} \ar[ru]^>>>>>>>s \ar@{ >->}[dd] & \\
& 1 \ar[rr]_<<<<<<<<<{\delta_0} |>>>>>>>>>>>>>>>>>>\hole & & \I \\
1 \ar[ru] \ar[rr] \ar[ruuu]|>>>>>>>>>>>>>\hole _{a_0} & & 1\!\times\!\I \ar@{.>}[ruuu] _a \ar[ru]_{\pi_2} & }
\end{equation}
which is \eqref{diagram:ppl}, extended by the counit (evaluation) $\varepsilon : \widetilde{P}\times \I \ra P$ over $\I$ on the right, and with $1$ still representing the domain of a variable to reason internally.  The pullback of $\varepsilon$ over $\I$ along $\delta_0$ is then the map $\pi_0 : \widetilde{P} \ra P0$ that we are interested in.  

Given an $L^0(P)$-structure, reasoning internally we construct a $\plusalgx$-structure on $\pi_0 : \widetilde{P} \ra P0$ as follows: for any cofibration $i_\varphi : [\varphi]\mono 1$ and any commutative square,
\begin{equation}\label{diagram:plusfiller}
\xymatrix{
[\varphi] \ar@{>->}[d]_{i_\varphi} \ar[rr]^{s} & & {\widetilde{P}}  \ar[d]^{\pi_0} \\
1 \ar[rr]_{a_0} && P0\,,
}
\end{equation}
we require a diagonal filler,
\[
\xymatrix{
[\varphi] \ar@{>->}[d]_{i_\varphi} \ar[rr]^{s} & & {\widetilde{P}}  \ar[d]^{\pi_0} \\
1 \ar[rr]_{a_0} \ar@{ .>}[rru]_j && P0\,.
}
\]
Transposing the top left span in \eqref{diagram:plusfiller} formed by $i_\varphi$ and $s$ along the adjunction $\I^* \dashv \prod_{\I}$ gives the right-hand square in \eqref{diagram:pplext}, and the commutative square in \eqref{diagram:plusfiller} formed by $a_0$ and $\pi_0$ gives the rest of the data in \eqref{diagram:pplext}. Thus the assumed $L^0(P)$-structure gives an $a : 1\times\I\ra P$ as indicated in \eqref{diagram:pplext}.  But then $a$ lifts uniquely across $\varepsilon$ to a map $\overline{a} : 1\times\I\ra \widetilde{P}\times\I$ over \I, by the universal property of $\varepsilon : \widetilde{P}\times\I \ra P$.  We can therefore set $$j = \delta_0^*( \overline{a}) : 1 \ra \widetilde{P}\,.$$

Suppose conversely that we have a $\plusalgx$-structure on $\pi_0 : \widetilde{P} \ra P0$, and we want to build a (0-directed) lifting structure on $P$.  Take any $\varphi, s, a_0$ as indicated in \eqref{diagram:pplext}, and we require an $a : 1\times\I\ra P$ over $\I$.    From $s$ we get $\overline{s}$ by the universal property of $\varepsilon$, and we therefore have $\overline{s}_0$ by pullback.   From $\overline{s}_0$ and $a_0$ and the $\plusalgx$ structure on $\pi_0$ we obtain a map $j : 1 \ra \widetilde{P}$ over $P0$ which is a diagonal filler of the indicated square formed by $i_\varphi, \overline{s}_0, a_0$ and $\pi_0$.  Finally, we obtain the required map $a : 1\times\I\ra P$ over $\I$ as the ($\I^* \dashv \prod_{\I}$)-transpose of $j$,
\[
a = \varepsilon \circ(j\times\I)\,.
\]

We leave to the reader the verification that these assignments are mutually inverse.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%
\end{document}
%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%

\[
\xymatrix@=3em{
& B_1 \ar[dd] |\hole ^>>>>>>>{q} & &\\
\cdot \ar[ru] \ar[dd]_{q_X} \ar[rr] && \ar[lu] G \ar[dd]^{q'} & \\
& B_0 & &\\
X\times_{A_0} A_1\ar[ru]^{b} \ar[d]_{p_X}  \ar[rr]_{\overline{b}\times_{A_0}A_1} && \ar[lu]_{\mathrm{ev}} B_{0}^{A_1} \times_{A_0} A_1 \ar[d]^{p'} \ar[r] & A_1 \ar[d]^{p}\\
X \ar@/^8ex /[uuu]^{(a',b')} \ar[rr]^{\overline{b}} \ar@/_5ex /[rrr]_{a} && B_0^{A_1} \ar[r]  & A_0}
\]


\[
\xymatrix{
B_1 \ar[d] ^{q} & &\\
B_0 &  \ar[lu]  \ar@/_8ex/ [dd] G \ar[d]^{q'} & \\
& \ar[lu] |<<<<<<\hole B_{0}^{A_1} \times_{A_0} A_1 \ar[d]^{p'} \ar[r] & A_1 \ar[d]^{p}\\
& B_0^{A_1} \ar[r]  & A_0.}
\]


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\section*{Appendix 3:  A left-induced model structure on the Cartesian cubical sets}
%
%We make use of the Sattler model structure \cite{sattler} on the \emph{Dedekind cubical sets} $\widehat\D = \psh{\D}$, where $\D$ is the category of \emph{Dedekind cubes}, defined as the Lawvere theory of distributive lattices.  The unique product-preserving functor 
%\[
%i : \C \ra \D
%\]
%classifying the Dedekind interval $\I_\D \in \D$ induces an adjunction,
%\[
%i_! \dashv i^* \dashv i_*\ :\ \widehat\C \ \ra \widehat\D \,,
%\]
%where $i^* (Q) = Q\circ i$, for $Q \in \D$.  
%
%\begin{lemma}
%Observe that $i_!$ is left exact since the Dedekind interval $\I_\D$ is \emph{strict}, $0 \neq 1 : 1\rightrightarrows\I_\D$.  Thus we have geometric morphisms:
%\[
%(i_! \dashv i^*) :\ \widehat\D \ \ra \widehat\C \,,
%\]
%classifying the bipointed object $i_!(\I_\C) = \I_\D$,
%\[
%(i^* \dashv i_*) :\ \widehat\C \ \ra \widehat\D \,,
%\]
%classifying the dLat $i^*(\I_\D) := \I$, where $\eta : \I_\C\ra \I$ can be described pointwise as the distributive lattice completion of the corresponding bipointed set.
%
%Also, since $i$ is faithful so is $i_!$,  and since $i$ is surjective on objects $i^*$ is also faithful.
%
%It follows that:
%\begin{itemize}
%\item $\widehat\C$ is $(i_!\circ i^*)$-coalgebras on $\widehat\D$, 
%\item $\widehat\D$ is $(i^*\circ i_*)$-coalgebras on $\widehat\C$, 
%\item $\widehat\D$ is $(i^*\circ i_!)$-algebras on $\widehat\C$. 
%\end{itemize}
%\end{lemma}
%
%We will use the following transfer theorem for QMSs from \cite{Hess,Garner}:
%
%\begin{theorem*}[\cite{Hess,Garner}]
%Suppose $\widehat\D$ has a (cofibrantly generated) model structure $(\mathcal{C}_\D, \mathcal{W}_\D, \mathcal{F}_\D)$.  Given an adjunction 
%\[
%i_! \dashv i^* \ :\ \widehat\D \ra \widehat\C\,,
%\]
%there is a \emph{left-induced model structure} on $\widehat\C$ if the following \emph{acyclicity condition} holds:
%\[
%(i_!^{-1}\mathcal{C}_\D)^{\pitchfork}\  \subset \  i_!^{-1}\mathcal{W}_\D\,.
%\]
%For the left-induced model structure $(\mathcal{C}_\C, \mathcal{W}_\C, \mathcal{F}_\C)$ on $\widehat\C$ we then have:
%\begin{align*}
%\mathcal{C}_\C\ &=\ i_!^{-1}\mathcal{C}_\D\,,\\
%\mathcal{W}_\C\ &=\ i_!^{-1}\mathcal{W}_\D\,.
%\end{align*}
%\end{theorem*}
%
%The Sattler model structure on $\widehat\D$ is given as follows (for a constructive treatment a smaller class of ``pointwise decidable cofibrations'' is used, but we consider the classical case first):
%\begin{align*}
%\mathcal{C}\ &=\ \text{monomorphisms}\,,\\
%\mathcal{W}\  &=\ \{ f \ |\ f = p\circ i ,\ p\in \mathcal{F}\cap\mathcal{W} ,\ i\in \mathcal{C}\cap\mathcal{W}\,\}\,,\\
%\mathcal{F}\  &=\ (\mathcal{C}\otimes\delta)^\pitchfork\,.
%\end{align*}
%where $\delta : 1\ra\I$ is either endpoint inclusion.
%
%For the left-induced model structure on $\widehat\C$ we therefore have the following specification:
%\begin{align*}
%\mathcal{C}\ &=\ \text{monomorphisms},\\
%\mathcal{W}\  &=\ \{ f \ |\ i_!f = p\circ i ,\ p\in \mathcal{F}_\D\cap\mathcal{W}_\D ,\ i\in \mathcal{C}_\D\cap\mathcal{W}_\D\,\}\,,\\
%\mathcal{F}\  &=\ (\mathcal{C}\cap\mathcal{W})^\pitchfork\,.
%\end{align*}
%The determination  of $\mathcal{C}$ follows from the fact that $i_! :\widehat\C\ra \widehat\D$ is conservative.
%
%To check the acyclicity condition, 
%\[
%(i_!^{-1}\mathcal{C}_\D)^{\pitchfork}\  \subset \  i_!^{-1}\mathcal{W}_\D\,,
%\]
%we know that $i_!^{-1}\mathcal{C}_\D$ consists of the monos in $\C$, so take $f : Y\ra X$ in $(i_!^{-1}\mathcal{C}_\D)^{\pitchfork}$, apply $i_!$,  and factor the result as $i_!f = p\circ m : i_!Y\ra Z\ra i_!X$ with $p\in \mathcal{F}_\D\cap\mathcal{W}_\D$ and $m : i_!Y\ra Z$ monic. We then need to show that $m$ is in~$\mathcal{W}_\D$.
%
%We can apply Theorem 2.2.1 of \cite{Hess}, with $\mathsf{K} = \widehat\C$, $\mathsf{M} = \widehat\D$, $V = i_!$, $k=i^*$, and:
%\begin{enumerate}
%\item $QX = X$ and $\epsilon = 1_X : X\ra X$, so that $i_!1_X = 1_{i_!X}$ and therefore in $\mathcal{W}_\D$, while all objects are cofibrant,
%\item $Qf = f$ for any $f:X\ra Y$ in $\widehat\C$, so that the naturality condition is similarly trivial,
%\item factor the codiagonal $X + X \ra X$ as $\pi_2\circ j : X + X \ra \I\times X \ra X$ with $j = (\partial\I\times X) : X + X \ra \I\times X$.
% \end{enumerate}
% It remains only to show that $i_!p : \i_!(\I\times X) \ra i_!X$ is in $\mathcal{W}_\D$ and  $i_!j : i_!(X + X) \ra i_!(\I\times X)$ is in $\mathcal{C}_\D$.  The latter  is clear, since $j$ is monic. To show the former, observe that for any $D\in \widehat\D$, the projection $\pi_2 : \I_\D\times D \ra D$ is in $\mathcal{W}_\D$ by 3-for-2, since the ``cylinder end'' inclusion $D\ra\I_\D\times D$, as a pullback of an endpoint inclusion, is a cofibration, and a strong deformation retract (using the connection on $\I$), and hence is in $\mathcal{W}_\D$ by \cite{GS}.
%
%Thus we have shown:
%
%\begin{theorem}
%There is a Quillen model structure $(\mathcal{C}, \mathcal{W}, \mathcal{F})$ on the category $\widehat\C$ of cartesian cubical sets, in which
%\begin{align*}
%\mathcal{C}\ &=\ \text{monomorphisms},\\
%\mathcal{W}\  &=\ \{ f \ |\ i_!f = p\circ i ,\ p\in \mathcal{F}_\D\cap\mathcal{W}_\D\,,\ i\in \mathcal{C}_\D\cap\mathcal{W}_\D\,\}\,,\\
%\mathcal{F}\  &=\ (\mathcal{C}\cap\mathcal{W})^\pitchfork\,.
%\end{align*}
%where $i_! : \widehat\C \ra\widehat\D$ is the left adjoint of precomposition along the canonical map $i : \C \ra \D$ from Cartesian cubes to Dedekind cubes, and $(\mathcal{C}_\D, \mathcal{W}_\D, \mathcal{F}_\D)$ is the Sattler model structure on $\widehat\D$.
%\end{theorem}
%
%
%\bibliographystyle{alpha}
%\bibliography{references}
%

\end{document}

%Some notes from dictation:
%Intro: constructive, soa, frobenius, sattler, coquand, CAS, Lawvere, tiny cubes, hott, univalence, axiomatics, joyal
%
%Foundations 
%Least test category, but not the test qms, cite accrs, classifies intervals and therefore universal 
%Rather: initial among cubical qmcÕs
%Universe
%Tiny interval implies certain combinatorial and algebraic constructions can be given strictly for example the type of vibration structures is strictly from Torio which allows us to construct the five ration in all universe this permits strict interpretation of the syntax of type theory.
%Another novelty is the use of so-called classifying types. Which are exploited in the Kripke Joyal forcing semantics of a GH.
%The construction of the universe using the nerve a junction replaces previous accounts by one which is entirely find a Terry algebraic. This can be used to avoid certain arguments involving present ability and infinite call limits such as the vibrancy of the universe in the proof of the vibration extension property. Compare hear the use of the fibrant universe or rather universe of vibrations in order to demonstrate the fiber and see if the universe with the treatment in Sattler involving consideration of infinite call limits.
%Play. Homotopytypetheory presented possible interpretation of take her into home to be Siri this work culminates that development with the construction home it will be out of take theory centered on univalent
%Refer to the conjecture about intentional type theory and infinity topazes and show that this construction cements that conception or something
%Refer to the paper on the cubicle model of how much op tape theory from way back when I was one of the earliest treatments using Cartesian cubes to get intentional identity types with definitional interpretations of the Ja Rule and the computational
%Saint Carlo for the use of the generic point but also theory and the paper with the alphabet of authors.
%ItÕs hardly surprising that there should be a strong connection between the construction of models of homotopytypetheory with univalence and ship: categories especially given Shermans paper what is perhaps surprising is that the construction of such models apparently exhausts the resources of the current model structure in the sense that a model four model oh univalent how much of the tech theory suffices to construct a call model structure this idea goes back to Gambino in Garner who showed Fontana construct a certain kind of weak factorization system in the syntax of intentional type Siri this later send it by Lumsdaine using iron higher injunctive type in order to add a second week factorization system and finally in a somewhat different vein Christian Sattler who showed how to use univalentÔs in the form of what we now call the equivalence extension property in order to verify the axioms for a full call model structure. This can probably be understood as a sort of completeness theorem for homotopytypetheory with respect to Covid model categories, in the style of the usual categorical logic approach to such theorems building
%Building generic models out of the theory directly. Such a construction would require a more formal development then that pursuit here.
%Use the universe to replace the small object argument in order to give the vibration we factorization system that should do it
